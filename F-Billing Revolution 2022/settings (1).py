#from ast import pattern
from calendar import c
from cgitb import enable, text
from distutils import command
from itertools import count
from pydoc import describe
from secrets import choice
from sqlite3 import enable_callback_tracebacks
import string
from tkinter import *
from tkinter import messagebox
from tkinter import ttk
from tkinter.font import BOLD
from urllib.parse import parse_qs
from xml.dom.minidom import Entity
from PIL import ImageTk, Image, ImageFile
from matplotlib.font_manager import json_dump
from numpy import choose, empty, place
import pandas as pd
from tkinter.messagebox import showinfo
import tkinter.scrolledtext as scrolledtext
from tkinter.filedialog import askopenfilename
import os
import webbrowser
from pip import main
from tkcalendar import Calendar
from tkcalendar import DateEntry
from datetime import date,datetime, timedelta
from tkinter import filedialog
import subprocess
import mysql.connector
import io
from openpyxl.workbook import Workbook
from openpyxl import load_workbook
import shutil
import csv
import json

#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
import matplotlib.pyplot as plt
from pylab import plot, show, xlabel, ylabel
from matplotlib.widgets import Cursor
from dateutil.relativedelta import relativedelta
import pendulum

from pathlib import Path
import pandas as pd
from tkinter import messagebox
from tkinter import *
from docx import Document
from fpdf import FPDF
import os
import sys
from PyPDF2 import PdfFileWriter, PdfFileReader
import pdfkit
from email.mime.base import MIMEBase
from email.mime.image import MIMEImage
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib
from email import encoders

import win32api
import win32print
from tkinter import filedialog
from pyautogui import alert
import os
import tempfile

from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg

from tkinter import font as tkFont
from tkinter import TclError
from textwrap import wrap




fbilldb = mysql.connector.connect(
    host="localhost", user="root", password="", database="fbd", port="3306"
)
fbcursor = fbilldb.cursor(buffered=True)

ImageFile.LOAD_TRUNCATED_IMAGES = True

def reset():
  global root
  root.destroy()


# root.title("F-Billing Revolution 2022(FREE version) | Company database:fbillingdb | User:Administrator")
def log():
    global user_name1
    user_name1=username1.get()
    passwd1=password1.get()
    if user_name1=="" or passwd1=="":
        Label(text='Plz enter both username and password',fg='red').place(x=85,y=260)
    else:
        sql='SELECT * FROM users WHERE username=%s AND password=%s'
        val=(user_name1,passwd1,)
        fbcursor.execute(sql,val)
        if fbcursor.fetchone()is not None:
            mainpage()
            if user_name1 != "adminstator":
              tab06.destroy()
            else:
              pass
            root.iconify()
        else:
            messagebox.showinfo('Acess denied','Username Or Password Wrong')

  
sql = "select * from users"
fbcursor.execute(sql)
user_log = fbcursor.fetchall()
if not user_log:
  def lo():
    mainpage()
  root=Tk()
  root.geometry("500x250")
  root.resizable(False, False)
  root.eval('tk::PlaceWindow . center')
  Label(text='Wellocome to F-Billing Revolution 2022',font='arial 13 bold').place(x=100,y=40)
  submitbtn1=Button(text='OPEN NOW', width=20,height=2,command=lo,activeforeground="white",activebackground="black",font='arial 8 bold').place(x=165,y=100)             
else:
    root=Tk()
    root.geometry("500x200")
    root.resizable(False, False)
    root.eval('tk::PlaceWindow . center')
    root.title("F-Billing Revolution 2022")
    p1 = PhotoImage(file = 'images/fbicon.png')
    root.iconphoto(False,p1)
    username1=StringVar()
    password1=StringVar()

    Label(text='Login F-Billing Revolution 2022',font='arial 13 bold').place(x=120,y=15)
    
  
    sql = "select username from users"
    fbcursor.execute(sql)
    user_log_name = fbcursor.fetchall()
    uss1=Label(text='Username').place(x=120,y=65)
    ee1 = ttk.Combobox(textvariable=username1)
    ee1.place(x=220,y=65)
    ee1["values"] = user_log_name

    pss1=Label(text='Password').place(x=120,y=105)
    ee2=Entry(textvariable=password1,show='*',width=23).place(x=220,y=105)
    
    submitbtn1=Button(text='Login', width=15,command=log,activeforeground="white",
                   activebackground="black").place(x=250,y=150)
    
  
invoices= PhotoImage(file="images/invoice.png")
orders = PhotoImage(file="images/order.png")
estimates = PhotoImage(file="images/estimate.png")
recurring = PhotoImage(file="images/recurring.png")
purchase = PhotoImage(file="images/purchase.png")
expenses = PhotoImage(file="images/expense.png")
customer = PhotoImage(file="images/customer.png")
product = PhotoImage(file="images/package.png")
reports = PhotoImage(file="images/report.png")
setting = PhotoImage(file="images/setting.png")
tick = PhotoImage(file="images/check.png")
warnin = PhotoImage(file="images/sign_warning.png")
cancel = PhotoImage(file="images/close.png")
saves = PhotoImage(file="images/save.png")
folder = PhotoImage(file="images/folder-black.png")
photo11 = PhotoImage(file = "images/invoice-pvt.png")
customer = PhotoImage(file="images/customer.png")
smslog = PhotoImage(file = "images/smslog.png")
video = PhotoImage(file = "images/video.png")
mark1 = PhotoImage(file="images/mark.png")
mark2 = PhotoImage(file="images/mark2.png")
photo10 = PhotoImage(file = "images/text-message.png")
addnew = PhotoImage(file="images/plus.png")
delete = PhotoImage(file="images/delete_E.png")

selectall = PhotoImage(file="images/table_select_all.png")
cut = PhotoImage(file="images/cut.png")
copy = PhotoImage(file="images/copy.png")
paste = PhotoImage(file="images/paste.png")

undo = PhotoImage(file="images/undo.png")
redo = PhotoImage(file="images/redo.png")
bold = PhotoImage(file="images/bold.png")

italics = PhotoImage(file="images/italics.png")
underline = PhotoImage(file="images/underline.png")
left = PhotoImage(file="images/left.png")
  
right = PhotoImage(file="images/right.png")
center = PhotoImage(file="images/center.png")
hyperlink = PhotoImage(file="images/hyperlink.png")
remove = PhotoImage(file="images/eraser.png")
  
  
photo = PhotoImage(file = "images/plus.png")
photo1 = PhotoImage(file = "images/edit.png")
photo2 = PhotoImage(file = "images/delete_E.png")
photo3 = PhotoImage(file = "images/export-file.png")
photo4 = PhotoImage(file = "images/seo.png")
photo5 = PhotoImage(file = "images/printer.png")
photo6 = PhotoImage(file = "images/gmail.png")
photo7 = PhotoImage(file = "images/priewok.png")
photo8 = PhotoImage(file = "images/refresh_E.png")
photo9 = PhotoImage(file = "images/sum.png")
photo10 = PhotoImage(file = "images/text-message.png")
color = PhotoImage(file="images/font_color.png")

est_logo = PhotoImage(file = "images/companylogo.png")



def mainpage():
  root.iconify()
  main = Toplevel()
  main.geometry("1360x730")
  p1 = PhotoImage(file = 'images/fbicon.png')
  main.iconphoto(False, p1)
  main.title("F-Billing Revolution 2022(FREE version) | Company database:fbillingdb | User:Administrator")
  s = ttk.Style()
  s.theme_use('default')
  s.configure('TNotebook.Tab', background="#999999", width=20, padding=10)
  tabControl = ttk.Notebook(main)
  tab1 = ttk.Frame(tabControl)
  tab2 = ttk.Frame(tabControl)
  tab3=  ttk.Frame(tabControl)
  tab4 = ttk.Frame(tabControl)
  tab5 = ttk.Frame(tabControl)
  tab6=  ttk.Frame(tabControl)
  tab7 = ttk.Frame(tabControl)
  tab8 = ttk.Frame(tabControl)
  tab9 =  ttk.Frame(tabControl)
  tab10=  ttk.Frame(tabControl)
  tabControl.add(tab1,image=invoices,compound = LEFT, text ='Invoices',)
  tabControl.add(tab2,image=orders,compound = LEFT, text ='Orders')
  tabControl.add(tab3,image=estimates,compound = LEFT, text ='Estimates')
  tabControl.add(tab4,image=recurring,compound = LEFT, text ='Recurring')
  tabControl.add(tab5,image=purchase,compound = LEFT, text ='Purchase Orders') 
  tabControl.add(tab6,image=expenses,compound = LEFT, text ='Expenses')
  tabControl.add(tab7,image=customer,compound = LEFT, text ='Customers')
  tabControl.add(tab8,image=product,compound = LEFT, text ='Product/Services')
  tabControl.add(tab9,image=reports,compound = LEFT, text ='Report')
  tabControl.add(tab10,image=setting,compound = LEFT, text ='Settings')
  tabControl.pack(expand = 1, fill ="both")
  


  #____________________________________________Saiju_______________________________________________________________________
  reportframe=Frame(tab9, relief=GROOVE, bg="#f5f3f2")
  reportframe.pack(side="top", fill=BOTH)

  midFrame=Frame(reportframe, bg="#f5f3f2", height=60)
  midFrame.pack(side="top", fill=X)

  # midFrame2=Frame(reportframe, bg="red", height=60)
  # midFrame2.pack(side="top", fill=X)

  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(5, 2))
  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(0, 5))

  refreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55, command=lambda:screen_flt())
  refreshlebel.pack(side="left")
  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(5, 2))

  printlabel = Button(midFrame,compound="top", text="Print Chart",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:image_print())
  printlabel.pack(side="left")
  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(5, 2))


  saveLabel = Button(midFrame,compound="top", text="Save Chart\nimage",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:image())
  saveLabel.pack(side="left",)
  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(0, 5))

  copyLabel = Button(midFrame,compound="top", text="Copy Chart\n to Clipboard",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command="convert")
  copyLabel.pack(side="left")
  w = Canvas(midFrame, width=1, height=65, bg="#b3b3b3", bd=0)
  w.pack(side="left", padx=(0, 5))
  #***********************************************************************************************
  #right side of menu bar

  lbframe = LabelFrame(midFrame, height=60, width=1500, bg="#f8f8f2")
  lbframe.pack(side="left", padx=10, pady=0)

  ############################################(print function)####################################################



  

  
  def exportcanvas():

      var_1=rp_exir.get_date()
      var_2=rp_exir1.get_date()
      if rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and 	invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid="0" or balance="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid != "0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid="0" or invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid is not null or invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s and totpaid="0" or balance!="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

          cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      else:
          pass
 
  def exportcanvas2():
      var_1=irwcfrm1.get_date()
      var_2=irwcto1.get_date()
      if rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and 	invoicetot="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid="0" or balance="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid != "0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid="0" or invoicetot="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
      
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid is not null or invoicetot="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,businessname,status,invoicetot from invoice where invodate between %s and %s and totpaid="0" or balance!="0"'
              
              irv=(var_1,var_2)
              print(var_1)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      else:
          pass

  def exportcanvas3():
      var_1=orfrm1.get_date()
      var_2=orto1.get_date()

      cols = ["No","Date","Due Date","Customer","Status","Invoice Total"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select orderid,	order_date,due_date,businessname,status,Order_total from orders where order_date between %s and %s'
          
          irv=(var_1,var_2)
          fbcursor.execute(sql,irv)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)
  #rir
  def exportcanvas4():
      

      cols = ["Invoice No","Customer","Next Invoice","Recurring Interval","Stop After","Invoice Total"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select invoice_number,	businessname,next_invoice,recurring_period,stop_recurring,invoicetot from invoice'
          
          fbcursor.execute(sql)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)
  #pdi
  def exportcanvas5():

      cols = ["No","Date","Due Date","Terms","Status","Invoice Total","Invoice Paid","Balance"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select invoice_number,	invodate,duedate,terms,status,invoicetot,totpaid,balance from invoice where invodate<duedate'
          
          fbcursor.execute(sql)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)

  #cl
  def exportcanvas6():
      
      rth=clfilter.get()
      if rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==0:
          if rth=="All Customers ":
          
              cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  the=fbcursor.fetchall()
                  for i in the:
                      sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer where businessname=%s'
                      
                      vs=(str(i[18]),)
                      fbcursor.execute(sql,vs)
                      pandsdata = fbcursor.fetchall()
                      for row_id in pandsdata:
                          row = row_id
                          lst.append(row)
                      lst = list(map(list,lst))
                      lst.insert(0,cols)
                      for row in lst:
                          csvwriter.writerow(row)
          elif rth=="Default":
          
              cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  the=fbcursor.fetchall()
                  for i in the:
                      sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer where category="Default" and businessname=%s'
                      
                      vs=(str(i[18]),)
                      fbcursor.execute(sql,vs)
                      pandsdata = fbcursor.fetchall()
                      for row_id in pandsdata:
                          row = row_id
                          lst.append(row)
                      lst = list(map(list,lst))
                      lst.insert(0,cols)
                      for row in lst:
                          csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==1:
          if rth=="All Customers ":
          
              cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer'
                  
                  
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="Default":
          
              cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer where category="Default"'
                  
                  
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==1:
          if rth=="All Customers ":
          
                  cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
                  path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
                  
                  lst = []
                  with open(path, "w", newline='') as myfile:
                      csvwriter = csv.writer(myfile, delimiter=',')
                      sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
                  
                      fbcursor.execute(sql_inv_dt)
                      tre=fbcursor.fetchall()
                      for i in tre:
                          sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer where businessname=%s'
                          vs=(str(i[18]),)
                          
                          
                          fbcursor.execute(sql,vs)
                          pandsdata = fbcursor.fetchall()
                          for row_id in pandsdata:
                              row = row_id
                              lst.append(row)
                          lst = list(map(list,lst))
                          lst.insert(0,cols)
                          for row in lst:
                              csvwriter.writerow(row)
          elif rth=="Default":
          
              cols = ["Customer Id","Category","Customer Businnes Name","Customer Person","Tel","Fax"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  if i in tre:

                      sql = 'select customerid ,		category,businessname,contactperson,cptelno,cpfax from customer where category="Default" and  businessname=%s'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(sql,vs)
                      pandsdata = fbcursor.fetchall()
                      for row_id in pandsdata:
                          row = row_id
                          lst.append(row)
                      lst = list(map(list,lst))
                      lst.insert(0,cols)
                      for row in lst:
                          csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==0:
          pass
      else:
          pass
      
  #cld
  def exportcanvas7():
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle) 

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              story=[]

              if rth=="All Customers ":
                  
                  count=0
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      
                      
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1
                  pdf.save()
                      
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  count=0
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==0:
          pass
      elif rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * FROM customer'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  
                  for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              elif rth=="Default":
                  count=0
                  sql_inv_dt='SELECT * FROM customer where category="Default"'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:

                  
                          for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              else:
                  pass
  #psl
  def exportcanvas8():
      rth=pslfilter.get()
      if rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==0:
          if rth=="All product and Services ":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Products" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Service" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Default" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where stock<stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Products and stock<stocklimit"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Service"and stock<stocklimi '
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Default" and stock<stocklimi'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Products"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Service"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Category","Product/ Service Name","Description","Warehouse","Stock", "Cost","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid  ,	category,name,description,warehouse,stock,cost,unitprice from productservice where category="Default" '
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      else:
          pass
      
  #--------------------------------Price list--------------------------

  def exportcanvas9():
      rth=prlfilter.get()
      if rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice '
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Products"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Service"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Default"'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass

      elif rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==0:
          if rth=="All product and Services ":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Products" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Service" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Default" and stock>stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass

      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where stock<stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="All products":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Products" and stock<stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="All Service":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Service" and stock<stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)

          elif rth=="Default":
              cols = ["Product ID","Product/ Service Name","Description","Price"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select Productserviceid,name,description,unitprice from productservice where category="Default" and stock<stocklimit'
                  
              
                  fbcursor.execute(sql)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      else:
          pass


          

  #-----------------product low stock
  def exportcanvas10():
      if rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==1:
          cols = ["Product ID","Category","Product Name","Warehouse","Low Stock Limit","Stock"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select Productserviceid,category,name,warehouse,stocklimit,stock from productservice where stock < stocklimit'
              
          
              fbcursor.execute(sql)
              pandsdata = fbcursor.fetchall()
              
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      elif rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==0:
          cols = ["Product ID","Category","Product Name","Warehouse","Low Stock Limit","Stock"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select Productserviceid,category,name,warehouse,stocklimit,stock from productservice WHERE stock > stocklimit'
              
          
              fbcursor.execute(sql)
              pandsdata = fbcursor.fetchall()
              
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      elif rpcheckvar1_plr.get()==0 and rpcheckvar2_plr.get()==1:
          cols = ["Product ID","Category","Product Name","Warehouse","Low Stock Limit","Stock"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select Productserviceid,category,name,warehouse,stocklimit,stock from productservice WHERE stock < stocklimit'
              
          
              fbcursor.execute(sql)
              pandsdata = fbcursor.fetchall()
              
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      else:
          pass

  #=====tax Invoice========
  def exportcanvas11():
      var_1=trifrm1.get_date()
      var_2=trito1.get_date()

      if rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
          pass
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and 	invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid="0" or balance="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid != "0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid="0" or invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid is not null or invoicetot="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          cols = ["Invoice No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Invoice Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select invoice_number,	invodate,duedate,totalbeforetax,tax1,tax2,invoicetot from invoice where invodate between %s and %s and totpaid="0" or balance!="0"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      else:
          pass
      
  #tax order
  def exportcanvas12():
      var_1=trofrm1.get_date()
      var_2=troto1.get_date()
      
      cols = ["Order No","Issue Date","Due Date","Total Before TAX","TAX1","TAX2","Order Total"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select orderid,	order_date,due_date,totalbeforetax,tax1,	tax2,Order_total from orders where order_date between %s and %s'
          
          irv=(var_1,var_2)
          fbcursor.execute(sql,irv)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)
  # srgd
  def exportcanvas13():
      var_1=srgd_frm.get_date()
      var_2=srgd_to.get_date()
      rth=srgdfilter.get()
    
      if rth==rth:

          cols = ["Date","Quantity","Cost","Income","Profit"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sqr= 'select * from productservice where name=%s'
              ty=(rth,)
              fbcursor.execute(sqr,ty)
              pd=fbcursor.fetchone()
              

              sql = 'select x.invodate, x.quantity, y.cost,(x.quantity*y.cost),x.invoicetot,(x.invoicetot-(x.quantity*y.cost)) total from invoice x, productservice y where invodate BETWEEN %s and %s and x.Productserviceid=y.Productserviceid and x.Productserviceid=%s '
              
              irv=(var_1,var_2, pd[0],)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

  # ird
  def exportcanvas14():
      var_1=irdfrm1.get_date()
      var_2=irdfrm2.get_date()

      cols = ["Invoice No","Date","Customer","Invoice Total","Paid","Balance"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select invoice_number,	invodate,businessname,invoicetot,totpaid,balance from invoice where invodate between %s and %s'
          
          irv=(var_1,var_2)
          fbcursor.execute(sql,irv)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)

  # dir
  def exportcanvas15():
      var_1=dir_frm.get_date()
      

      cols = ["Invoice No","Date","Customer","Invoice Total","Paid","Balance"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select invoice_number,	invodate,businessname,invoicetot,totpaid,balance from invoice where invodate= %s'
          
          irv=(var_1,)
          fbcursor.execute(sql,irv)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)
  #por
  def exportcanvas16():
      var_1=porfrm1.get_date()
      var_2=porto1.get_date()
      

      if rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==0:
          cols = ["No","Date","Due Date","Vendor","Status","P.Order Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select porderid,	porderdate,duedate,vendor,status,ordertot from  porder where porderdate between %s and %s and status="Complete"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==1:
          cols = ["No","Date","Due Date","Vendor","Status","P.Order Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select porderid,	porderdate,duedate,vendor,status,ordertot from  porder where porderdate between %s and %s and status="Draft"'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)

      elif rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==1:
          cols = ["No","Date","Due Date","Vendor","Status","P.Order Total"] # Your column headings here
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
          
          lst = []
          with open(path, "w", newline='') as myfile:
              csvwriter = csv.writer(myfile, delimiter=',')
              sql = 'select porderid,	porderdate,duedate,vendor,status,ordertot from  porder where porderdate between %s and %s'
              
              irv=(var_1,var_2)
              fbcursor.execute(sql,irv)
              pandsdata = fbcursor.fetchall()
              for row_id in pandsdata:
                  row = row_id
                  lst.append(row)
              lst = list(map(list,lst))
              lst.insert(0,cols)
              for row in lst:
                  csvwriter.writerow(row)
      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==0:
              pass
      else:
                      pass


  #exp
  def exportcanvas17():
      var_1=exp_frm.get_date()
      var_2=exp_to.get_date()

      rth=expfilter.get()
      if rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="Internal":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s and customer="Internal"'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==0:
          if rth=="All":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s and invoiced="Yes"'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="Internal":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s and customer="Internal" and invoiced="Yes"'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s and rebillable="Yes"'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          elif rth=="Internal":
              cols = ["Date","Customer","Vendor","Invoice","Rebill.Amount","Amount"] # Your column headings here
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
              
              lst = []
              with open(path, "w", newline='') as myfile:
                  csvwriter = csv.writer(myfile, delimiter=',')
                  sql = 'select date,	customer,vendor,invoiced,	rebill_amount,expense_amount from expenses where date between %s and %s and customer="Internal" and rebillable="Yes"'
                  
                  irv=(var_1,var_2)
                  fbcursor.execute(sql,irv)
                  pandsdata = fbcursor.fetchall()
                  for row_id in pandsdata:
                      row = row_id
                      lst.append(row)
                  lst = list(map(list,lst))
                  lst.insert(0,cols)
                  for row in lst:
                      csvwriter.writerow(row)
          else:
              pass
      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==0:
          pass

      else:
          pass


  #pyr
  def exportcanvas18():


      var_1=pyrfrm1.get_date()
      var_2=pyrto1.get_date()

      cols = ["Invoice No","Invoice Issue Date","Customer","Payment ID","Payment Date","Paid By","Amount Paid"] # Your column headings here
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('CSV File', '*.csv',)],defaultextension=".csv")
      
      lst = []
      with open(path, "w", newline='') as myfile:
          csvwriter = csv.writer(myfile, delimiter=',')
          sql = 'select invoice_number,	invodate,businessname,paymentid,invodate,businessname,totpaid from invoice where invodate between %s and %s'
          
          irv=(var_1,var_2)
          fbcursor.execute(sql,irv)
          pandsdata = fbcursor.fetchall()
          for row_id in pandsdata:
              row = row_id
              lst.append(row)
          lst = list(map(list,lst))
          lst.insert(0,cols)
          for row in lst:
              csvwriter.writerow(row)


  #++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++PDF++++++++++++++++++++++++

  def pdf_exp():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          pass
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
      else:
          pass
      
      

  #==========irwc
  def pdf_exp_irwc():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      if rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          pass
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15

          pdf.save()
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()

      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
            
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
      else:
          pass
      
      
  def pdf_exp_or():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
            
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              
              if vg>1:
                pdf.drawString(30,738,htg[1])
                
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                   
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(495,760, "Order Report")
      
    

      pdf.drawString(335,740, "Date From:"+orfrm.get()+"  Date To:"+orto.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
      
      in_dat=orfrm1.get_date()
      cr=orto1.get_date()
      var_1=in_dat
      var_2=cr
    
    
      count=0
      sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
                  if x==44 or x==50 :
                      pdf.showPage()
                      x=750
                      
                  else:
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[1]))
                      pdf.drawString(158,x,str(i[2]))
                      pdf.drawString(235,x,str(i[3]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[26]))
                
                  count += 1
                  x-=15


      pdf.save()

  def pdf_exp_rir():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
            
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              
              if vg>1:
                pdf.drawString(30,738,htg[1])
                
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                   
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(445,760, "Recurring Invoice Report")
      "Invoice No","Customer","Next Invoice","Recurring Interval","Stop After","Invoice Total"
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Customer                   Next Invoice    Recurring Interval     Stop After       Invoice Total    ")
      
      count=0
      sql_inv_dt='SELECT * FROM invoice'
  
      fbcursor.execute(sql_inv_dt)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(115,x,str(i[18]))
                  pdf.drawString(250,x,str(i[26]))
                  pdf.drawString(335,x,str(i[24]))
                  pdf.drawString(430,x,str(i[27])) 
                  pdf.drawString(505,x,str(i[8]))
                
              count += 1
              x-=15


      pdf.save()

  def pdf_exp_pdi():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
            
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              
              if vg>1:
                pdf.drawString(30,738,htg[1])
                
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                   
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(450,760, "Past Due Invoice Report")

      pdf.drawString(460,720,"Invoice Category: All")
      
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
      
      

      count=0
      sql_inv_dt='SELECT * FROM invoice where invodate<duedate'
      
      fbcursor.execute(sql_inv_dt)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50 :
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(88,x,str(i[2]))
                  pdf.drawString(158,x,str(i[3]))
                  pdf.drawString(234,x,str(i[35]))
                  pdf.drawString(300,x,str(i[4])) 
                  pdf.drawString(365,x,str(i[8]))
                  pdf.drawString(455,x,str(i[9]))
                  pdf.drawString(530,x,str(i[10]))
              count += 1
              x-=15


      pdf.save()


  def pdf_exp_pym():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',10)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
            
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              
              if vg>1:
                pdf.drawString(30,738,htg[1])
                
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                   
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(500,760, "Pyment Report")
      pdf.drawString(370,740, "Date From:"+pyrfrm.get()+"  Date To:"+pyrto.get())
      pdf.drawString(470,720,"Invoice Category: All")
      pdf.drawString(28,695,"_________________________________________________________________________________________________")
      pdf.drawString(28,675,"_________________________________________________________________________________________________")
      pdf.drawString(28,678,"Invoice No          Invoice Issue Date  Customer                      Payment ID   Payment Date     Paid By               Amount Paid       ")
      
      in_dat=pyrfrm1.get_date()
      cr=pyrto1.get_date()
      var_1=in_dat
      var_2=cr
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(110,x,str(i[2]))
                  pdf.drawString(190,x,str(i[18]))
                  pdf.drawString(298,x,str(i[34]))
                  pdf.drawString(358,x,str(i[2])) 
                  pdf.drawString(425,x,str(i[18]))
                  pdf.drawString(515,x,str(i[9]))
                  
              count += 1
              x-=15


      pdf.save()


  def pdf_exp_cl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
          

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

          
          
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          rth=clfilter.get()
          
          if rth=="All Customers ":
          
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15


              pdf.save()
          elif rth=="Default":
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1 '
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s and category="Default"'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
          

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

          
          
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          rth=clfilter.get()
          
          if rth=="All Customers ":
          
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15


                  pdf.save()
          elif rth=="Default":
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1 '
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s and category="Default"'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
                  pdf.save()
      elif rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
          

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

          
          
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          rth=clfilter.get()
          
          if rth=="All Customers ":
          
              count=0
              
              x=705
            
              trf='select * from customer '
                  
                      
              fbcursor.execute(trf)
              thg=fbcursor.fetchall()
              for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
          elif rth=="Default":
              count=0
              trf='select * from customer where category="Default" '
                  
              fbcursor.execute(trf)
              thg=fbcursor.fetchall()
              for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==0:
          pass
      else:
          pass
      
  #pakkaaaaa
  def pdf_exp_cld():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle) 

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              story=[]

              if rth=="All Customers ":
                  
                  count=0
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      
                      
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1
                  pdf.save()
                      
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  count=0
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==0:
          pass
      elif rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * FROM customer'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  
                  for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              elif rth=="Default":
                  count=0
                  sql_inv_dt='SELECT * FROM customer where category="Default"'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:

                  
                          for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
              else:
                  pass
      

  def pdf_exp_psl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=pslfilter.get()
      if rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==0:
          if rth=="All product and Services ":
                  path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
                  defaultextension=".pdf")

                  fileName = path
                  documentTitle = 'Document title!'
                  title = 'Invoices List'
                  pdf = canvas.Canvas(fileName, pagesize=letter)
                  pdf.setTitle(documentTitle)

                  sql_company = "SELECT * from company"
                  fbcursor.execute(sql_company)
                  company= fbcursor.fetchone()
                  
                  pdf.setFont('Helvetica',12)
                  pdf.drawString(30,760, company[1])
                  pdf.drawString(415,760, "Product And Services Report")
                  

                  pdf.drawString(28,750,"__________________________________________________________________________________")
                  pdf.drawString(28,730,"__________________________________________________________________________________")


                  pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

                  count=0
                  sql_inv_dt='SELECT * FROM productservice where stock>stocklimit'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


                  pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15

              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15

              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==0:
          pass
      

  def pdf_exp_prl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=prlfilter.get()
      if rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(492,760, "Price List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==0:
          if rth=="All product and Services ":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15

              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15

              pdf.save()
          else:
              pass
      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All products":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="All Service":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          elif rth=="Default":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==0:
          pass
      else:
          pass
      
      


  def pdf_exp_plsr():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch


      if rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice where stock < stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(128,x,str(i[3]))
                              pdf.drawString(215,x,str(i[4]))
                              pdf.drawString(315,x,str(i[15]))
                              pdf.drawString(405,x,str(i[14])) 
                              pdf.drawString(515,x,str(i[13]))
                          
                          count += 1
                          x-=15


              pdf.save()
      elif rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice WHERE stock > stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          pdf.drawString(28,x,str(i[0]))
                          
                          pdf.drawString(128,x,str(i[3]))
                          pdf.drawString(215,x,str(i[4]))
                          pdf.drawString(315,x,str(i[15]))
                          pdf.drawString(405,x,str(i[14])) 
                          pdf.drawString(515,x,str(i[13]))
                      
                          count += 1
                          x-=15


              pdf.save()
      elif rpcheckvar1_plr.get()==0 and rpcheckvar2_plr.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice WHERE stock < stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          pdf.drawString(28,x,str(i[0]))
                          
                          pdf.drawString(128,x,str(i[3]))
                          pdf.drawString(215,x,str(i[4]))
                          pdf.drawString(315,x,str(i[15]))
                          pdf.drawString(405,x,str(i[14])) 
                          pdf.drawString(515,x,str(i[13]))
                      
                          count += 1
                          x-=15


              pdf.save()
      else:
              pass

  ######## 

  def pdf_exp_tri():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
          pass
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                    
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
      else:
          pass
      

  def pdf_exp_tro():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',10)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
                    
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(488,760, "Tax report(Orders)")
      pdf.drawString(370,740, "Date From:"+trofrm.get()+"  Date To:"+troto.get())
      pdf.drawString(470,720,"Invoice Category: All")
      pdf.drawString(28,695,"_________________________________________________________________________________________________")
      pdf.drawString(28,675,"_________________________________________________________________________________________________")
      pdf.drawString(28,678,"Order No         Issue Date     Due Date                      Total Before TAX   TAX1         TAX2                Order Total       ")
      

      in_dat=trofrm1.get_date()
      cr=troto1.get_date()
      var_1=in_dat
      var_2=cr
    
      count=0
      sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
              else:
                          
                  pdf.drawString(28,x,str(i[0]))
                  
                  pdf.drawString(95,x,str(i[1]))
                  pdf.drawString(150,x,str(i[2]))
                  pdf.drawString(268,x,str(i[28]))
                  pdf.drawString(348,x,str(i[14])) 
                  pdf.drawString(400,x,str(i[29]))
                  pdf.drawString(465,x,str(i[8]))
                  
              count += 1
              x-=15


      pdf.save()


  def pdf_exp_srgd():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=srgdfilter.get()
    
      if rth==rth:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',10)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
                        
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(442,760, "Sales Report(Group By Date)")
          pdf.drawString(365,740, "Date From:"+srgdfrm.get()+"  Date To:"+srgdto.get())
          pdf.drawString(470,720,"Invoice Category: All")
          pdf.drawString(28,695,"_________________________________________________________________________________________________")
          pdf.drawString(28,675,"_________________________________________________________________________________________________")
          pdf.drawString(28,678,"Date                              Quantity                          Cost                                            Income                         profit                ")
      
          lkts=srgdfilter.get()
      
          in_dat=srgd_frm.get_date()
          cr=srgd_to.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv='SELECT * FROM productservice Where name=%s'
                  # inv_valuz=(var1,var2)
                  
          inv=(lkts,)
          fbcursor.execute(sql_inv, inv)
          tre=fbcursor.fetchall()
          
          lkt=srgdfilter.get()
          sel_inv_dt1='SELECT * FROM invoice Where invodate between %s and %s and Productserviceid=(SELECT Productserviceid from productservice Where name=%s)'
          inv_valuz=(var_1, var_2,lkt,)
          fbcursor.execute(sel_inv_dt1, inv_valuz)
          tre1=fbcursor.fetchall()

          
          x=660
          for i in tre1:
              for j in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      k=int(j[9]*int(i[38]))
                      rt=int(i[8])
                      l=rt-k
                      pdf.drawString(28,x,str(i[2]))
                      
                      pdf.drawString(138,x,str(i[38]))
                      pdf.drawString(245,x,str(k))
                      pdf.drawString(385,x,str(i[8]))
                      pdf.drawString(485,x,str(l)) 
                  
                  count += 1
                  x-=15

        
          pdf.save()
      else:
          pass

  def pdf_exp_ird():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
                    
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(450,760, "Invoice Report(Detailed)")
      
      pdf.drawString(335,740, "Date From:"+irdfrm.get()+"  Date To:"+irdto.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Date           Customer                  Invoice Total                       Paid                 Balance      ")
      
      
      in_dat=irdfrm1.get_date()
      cr=irdfrm2.get_date()
      var_1=in_dat
      var_2=cr
    
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                  pdf.showPage()
                  x=750
                      
              else:
                          
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(108,x,str(i[2]))
                  pdf.drawString(180,x,str(i[29]))
                  pdf.drawString(300,x,str(i[8]))
                  pdf.drawString(435,x,str(i[9])) 
                  pdf.drawString(520,x,str(i[10]))
                
              count += 1
              x-=15


      pdf.save()


  def pdf_exp_dir():


      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
      defaultextension=".pdf")

      fileName = path
      documentTitle = 'Document title!'
      title = 'Invoices List'
      pdf = canvas.Canvas(fileName, pagesize=letter)
      pdf.setTitle(documentTitle)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
                    
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(460,760, "Daily Invoice Report")
      
      pdf.drawString(445,740, "Date From:"+dirdate.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Date           Customer                  Invoice Total                       Paid                 Balance      ")
      
      
      in_dat=dir_frm.get_date()
    
      var_1=in_dat
    
    
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate=%s'
      inv_valuz=(str(var_1),)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=655
      for i in tre:
              if x==44 or x==50:
                  pdf.showPage()
                  x=750
                      
              else:
                      
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(100,x,str(i[2]))
                  pdf.drawString(178,x,str(i[29]))
                  pdf.drawString(295,x,str(i[8]))
                  pdf.drawString(428,x,str(i[9])) 
                  pdf.drawString(515,x,str(i[10]))
                
              count += 1
              x-=15
      


      pdf.save()


  def pdf_exp_por():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==0:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
                        
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s and status="Complete"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==1:
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
                        
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s and status="Draft"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=655
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()
      elif rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==1:
      
          path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
          defaultextension=".pdf")

          fileName = path
          documentTitle = 'Document title!'
          title = 'Invoices List'
          pdf = canvas.Canvas(fileName, pagesize=letter)
          pdf.setTitle(documentTitle)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
                        
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=655
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()

  def pdf_exp_exp():
      rth=expfilter.get()
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      if rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and rebillable="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()

          elif rth=="Internal":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal" and rebillable="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==0:
          if rth=="All":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and invoiced="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()

          elif rth=="Internal":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal" and invoiced="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
          else:
              pass
      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==0:
          pass
      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==1:
      

          if rth=="All":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15

              pdf.save()

          elif rth=="Internal":
              path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('Pdf File', '*.pdf',)],
              defaultextension=".pdf")

              fileName = path
              documentTitle = 'Document title!'
              title = 'Invoices List'
              pdf = canvas.Canvas(fileName, pagesize=letter)
              pdf.setTitle(documentTitle)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
          else:
              pass


  #print********************************************


  def pr_exp():
    #   from reportlab.pdfgen.canvas import Canvas

      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      from textwrap import wrap
      import split
      if rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          pass
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)
          

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr

          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          
              
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
          
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660

          for i in tre:
                    if x==44 or x==50:
                        pdf.showPage()
                        x=750
                    else:
                        if ps_cr=="before amount":
                            pdf.drawString(28,x,str(i[1]))
                      
                            pdf.drawString(88,x,str(i[2]))
                            pdf.drawString(158,x,str(i[3]))
                            pdf.drawString(231,x,str(i[35]))
                            pdf.drawString(300,x,str(i[4])) 
                            pdf.drawString(360,x,str(crc)+str(i[8]))
                            pdf.drawString(450,x,str(crc)+str(i[9]))
                            pdf.drawString(525,x,str(crc)+str(i[10]))
                            
                        elif ps_cr=="after amount":
                            pdf.drawString(28,x,str(i[1]))
                            pdf.drawString(88,x,str(i[2]))
                            pdf.drawString(158,x,str(i[3]))
                            pdf.drawString(231,x,str(i[35]))
                            pdf.drawString(300,x,str(i[4])) 
                            pdf.drawString(360,x,str(i[8])+str(crc))
                            pdf.drawString(450,x,str(i[9])+str(crc))
                            pdf.drawString(525,x,str(i[10])+str(crc))
                            
                        elif ps_cr=="before amount with space":
                            pdf.drawString(28,x,str(i[1]))
                      
                            pdf.drawString(88,x,str(i[2]))
                            pdf.drawString(158,x,str(i[3]))
                            pdf.drawString(231,x,str(i[35]))
                            pdf.drawString(300,x,str(i[4])) 
                            pdf.drawString(360,x,str(crc)+" "+str(i[8]))
                            pdf.drawString(450,x,str(crc)+" "+str(i[9]))
                            pdf.drawString(525,x,str(crc)+" "+str(i[10]))
                            
                            
                        elif ps_cr=="after amount with space":
                            pdf.drawString(28,x,str(i[1]))
                            pdf.drawString(88,x,str(i[2]))
                            pdf.drawString(158,x,str(i[3]))
                            pdf.drawString(231,x,str(i[35]))
                            pdf.drawString(300,x,str(i[4])) 
                            pdf.drawString(360,x,str(i[8])+" "+str(crc))
                            pdf.drawString(450,x,str(i[9])+" "+str(crc))
                            pdf.drawString(525,x,str(i[10])+" "+str(crc))
                        
                        else:
                            pass
                        # pdf.drawString(28,x,str(i[1]))
                      
                        # pdf.drawString(88,x,str(i[2]))
                        # pdf.drawString(158,x,str(i[3]))
                        # pdf.drawString(231,x,str(i[35]))
                        # pdf.drawString(300,x,str(i[4])) 
                        # pdf.drawString(360,x,str(i[8]))
                        # pdf.drawString(450,x,str(i[9]))
                        # pdf.drawString(525,x,str(i[10]))
                    count += 1
                    x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          pdf.drawString(335,740, "Date From:"+invfrm.get()+"  Date To:"+invto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
          
          
          in_dat=rp_exir.get_date()
          cr=rp_exir1.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                  else:
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(231,x,str(i[35]))
                      pdf.drawString(300,x,str(i[4])) 
                      pdf.drawString(360,x,str(i[8]))
                      pdf.drawString(450,x,str(i[9]))
                      pdf.drawString(525,x,str(i[10]))
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report.pdf",None,".",0) 
      else:
          pass
      
      

  #==========irwc
  def pr_exp_irwc():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      if rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          pass
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15

          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get()
          cr=irwcto1.get()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)

      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)
      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          pdf = canvas.Canvas("reports/Invoice_Report_With Customer.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(490,760, "Invoice Report")
          
          pdf.drawString(335,740, "Date From:"+irwcfrm.get()+"  Date To:"+irwcto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
          
          in_dat=irwcfrm1.get_date()
          cr=irwcto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
              
                      pdf.drawString(28,x,str(i[1]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(158,x,str(i[3]))
                      pdf.drawString(235,x,str(i[18]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[8]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Invoice_Report_With Customer.pdf",None,".",0)  
      else:
          pass
      
      
  def pr_exp_or():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Order_Report.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
          
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(495,760, "Order Report")
      
    

      pdf.drawString(335,740, "Date From:"+orfrm.get()+"  Date To:"+orto.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"No                 Date           Due Date        Customer                                 Status                 Invoice Total    ")
      
      in_dat=orfrm1.get_date()
      cr=orto1.get_date()
      var_1=in_dat
      var_2=cr
    
    
      count=0
      sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
                  if x==44 or x==50 :
                      pdf.showPage()
                      x=750
                      
                  else:
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[1]))
                      pdf.drawString(158,x,str(i[2]))
                      pdf.drawString(235,x,str(i[3]))
                      pdf.drawString(405,x,str(i[4])) 
                      pdf.drawString(490,x,str(i[26]))
                
                  count += 1
                  x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Order_Report.pdf",None,".",0)

  def pr_exp_rir():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Recurring_Invoice_Report.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
          
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(445,760, "Recurring Invoice Report")
      "Invoice No","Customer","Next Invoice","Recurring Interval","Stop After","Invoice Total"
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Customer                   Next Invoice    Recurring Interval     Stop After       Invoice Total    ")
      
      count=0
      sql_inv_dt='SELECT * FROM invoice'
  
      fbcursor.execute(sql_inv_dt)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(115,x,str(i[18]))
                  pdf.drawString(250,x,str(i[26]))
                  pdf.drawString(335,x,str(i[24]))
                  pdf.drawString(430,x,str(i[27])) 
                  pdf.drawString(505,x,str(i[8]))
                
              count += 1
              x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Recurring_Invoice_Report.pdf",None,".",0)

  def pr_exp_pdi():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Past_Due_Invoice_Report.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
          
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(450,760, "Past Due Invoice Report")

      pdf.drawString(460,720,"Invoice Category: All")
      
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      pdf.drawString(28,678,"No                 Date           Due Date        Terms        Status        Invoice Total      Invoice Paid     Balance      ")
      
      

      count=0
      sql_inv_dt='SELECT * FROM invoice where invodate<duedate'
      
      fbcursor.execute(sql_inv_dt)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50 :
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(88,x,str(i[2]))
                  pdf.drawString(158,x,str(i[3]))
                  pdf.drawString(234,x,str(i[35]))
                  pdf.drawString(300,x,str(i[4])) 
                  pdf.drawString(365,x,str(i[8]))
                  pdf.drawString(455,x,str(i[9]))
                  pdf.drawString(530,x,str(i[10]))
              count += 1
              x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Past_Due_Invoice_Report.pdf",None,".",0)


  def pr_exp_pym():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Pyment_Report.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',10)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
          
      vg=len(htg)
      if vg>0:
              pdf.drawString(30,752,htg[0])
              
              if vg>1:
                pdf.drawString(30,738,htg[1])
                
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                   
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(500,760, "Pyment Report")
      pdf.drawString(370,740, "Date From:"+pyrfrm.get()+"  Date To:"+pyrto.get())
      pdf.drawString(470,720,"Invoice Category: All")
      pdf.drawString(28,695,"_________________________________________________________________________________________________")
      pdf.drawString(28,675,"_________________________________________________________________________________________________")
      pdf.drawString(28,678,"Invoice No          Invoice Issue Date  Customer                      Payment ID   Payment Date     Paid By               Amount Paid       ")
      
      in_dat=pyrfrm1.get_date()
      cr=pyrto1.get_date()
      var_1=in_dat
      var_2=cr
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
              else:
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(110,x,str(i[2]))
                  pdf.drawString(190,x,str(i[18]))
                  pdf.drawString(298,x,str(i[34]))
                  pdf.drawString(358,x,str(i[2])) 
                  pdf.drawString(425,x,str(i[18]))
                  pdf.drawString(515,x,str(i[9]))
                  
              count += 1
              x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Pyment_Report.pdf",None,".",0)


  def pr_exp_cl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==0:
          
          rth=clfilter.get()
          pdf = canvas.Canvas("reports/Customer_List.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
              
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
              

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          
          if rth=="All Customers ":
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
          elif rth=="Default":
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1 '
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s and category="Default"'
                  vs=(str(i[18]),)
                  
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
              win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==1:
          pdf = canvas.Canvas("reports/Customer_List.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
          

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

          
          
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          rth=clfilter.get()
          
          if rth=="All Customers ":
          
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s'
                  vs=(str(i[18]),)
                      
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
          elif rth=="Default":
              count=0
              sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1 '
              
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                  trf='select * from customer where businessname=%s and category="Default"'
                  vs=(str(i[18]),)
                  x=705
                  fbcursor.execute(trf, vs)
                  thg=fbcursor.fetchall()
                  for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
      elif rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==1:
          pdf = canvas.Canvas("reports/Customer_List.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,760, company[1])
          pdf.drawString(495,760, "Customer List")
          

          pdf.drawString(28,750,"__________________________________________________________________________________")
          pdf.drawString(28,730,"__________________________________________________________________________________")

          
          
          pdf.drawString(28,733,"Customer Id  Category     Customer Businnes Name        Customer Person         Tel              Fax    ")
          rth=clfilter.get()
          
          if rth=="All Customers ":
          
              count=0
              
              x=705
            
              trf='select * from customer '
                  
                      
              fbcursor.execute(trf)
              thg=fbcursor.fetchall()
              for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
              win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
          elif rth=="Default":
              count=0
              trf='select * from customer where category="Default" '
                  
              fbcursor.execute(trf)
              thg=fbcursor.fetchall()
              x=705
              for i in thg:
                              if x==47 or i==57:
                                  pdf.showPage()
                                  x=855
                                  pdf.drawString(28,x-100,"__________________________________________________________________________________")
                              else:
                                  pdf.drawString(28,x,str(i[0]))
                                  
                                  pdf.drawString(110,x,str(i[2]))
                                  pdf.drawString(168,x,str(i[4]))
                                  pdf.drawString(335,x,str(i[8]))
                                  pdf.drawString(440,x,str(i[10])) 
                                  pdf.drawString(512,x,str(i[11]))
                          
                              count += 1
                              x-=15
              pdf.save()
              win32api.ShellExecute(0,"","reports\Customer_List.pdf",None,".",0)
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==0:
          pass
      else:
          pass
      

  def pr_exp_cld():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==0:
              pdf = canvas.Canvas("reports/Customer_List_Detailed.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              

              if rth=="All Customers ":
                  
                  
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  count=0
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==1:
              pdf = canvas.Canvas("reports/Customer_List_Detailed.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
                      win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              elif rth=="Default":
                  sql_inv_dt='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                              
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()
                      for i in thg:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                      pdf.save()
                      win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              else:
                  pass
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==0:
          pass
      elif rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==1:
              pdf = canvas.Canvas("reports/Customer_List_Detailed.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(495,760, "Customer List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")

              
              
              pdf.drawString(28,733,"Billing Information:                                                    Shipping Information:                      ")
              rth=cldfilter.get()
              
              if rth=="All Customers ":
              
                  count=0
                  sql_inv_dt='SELECT * FROM customer'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  
                  for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              elif rth=="Default":
                  count=0
                  sql_inv_dt='SELECT * FROM customer where category="Default"'
                  
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:

                  
                          for i in tre:
                                      if x==-30 or x==57:
                                          pdf.showPage()
                                          x=855
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      else:
                                          
                                          pdf.drawString(28,x-10,'Name: '+str(i[4]))
                                      
                                          pdf.drawString(300,x-10,'Name:'+str(i[6]))
                                          pdf.drawString(28,x-25,"Customer Id:"+str(i[0]))
                                          pdf.drawString(300,x-25,"Tax exempt No.:"+str(i[17]))
                                          pdf.drawString(28,x-40,'Address: '+str(i[5]))
                                          pdf.drawString(300,x-40,'Address:'+str(i[7]))
                                          pdf.drawString(28,x-55,'Contact Person: '+str(i[8])) 
                                          pdf.drawString(300,x-55,'Contact Person:'+str(i[13]))
                                          pdf.drawString(28,x-70,'Tel:'+str(i[10]))
                                          pdf.drawString(300,x-70,'Tel:'+str(i[15]))
                                          pdf.drawString(150,x-70,'Fax: '+str(i[11])) 
                                          pdf.drawString(430,x-70,'Fax: '+str(i[16]))
                                          pdf.drawString(28,x-85,'Email: '+str(i[9]))
                                          pdf.drawString(300,x-85,'Email: '+str(i[14]))
                                          pdf.drawString(28,x-100,"__________________________________________________________________________________")
                                      
                              
                                      x-=105
                                      count += 1


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Customer_List_Detailed.pdf",None,".",0)
              else:
                  pass
      

  def pr_exp_psl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=pslfilter.get()
      if rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==0:
          if rth=="All product and Services ":
                  pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

                  sql_company = "SELECT * from company"
                  fbcursor.execute(sql_company)
                  company= fbcursor.fetchone()
                  
                  pdf.setFont('Helvetica',12)
                  pdf.drawString(30,760, company[1])
                  pdf.drawString(415,760, "Product And Services Report")
                  

                  pdf.drawString(28,750,"__________________________________________________________________________________")
                  pdf.drawString(28,730,"__________________________________________________________________________________")


                  pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

                  count=0
                  sql_inv_dt='SELECT * FROM productservice where stock>stocklimit'
              
                  fbcursor.execute(sql_inv_dt)
                  tre=fbcursor.fetchall()
                  x=705
                  for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


                  pdf.save()
                  win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15

              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)
              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15

              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Product_And_Services_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID    Category     Product/ Service Name  Description        Warehouse        Stock  Cost    Price      ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(95,x,str(i[3]))
                              pdf.drawString(165,x,str(i[4]))
                              pdf.drawString(295,x,str(i[5]))
                              pdf.drawString(380,x,str(i[15])) 
                              pdf.drawString(475,x,str(i[13]))
                              pdf.drawString(510,x,str(i[9]))
                              pdf.drawString(545,x,str(i[11]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_And_Services_Report.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==0:
          pass
      

  def pr_exp_prl():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=prlfilter.get()
      if rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(492,760, "Price List")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default"'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==0:
          if rth=="All product and Services ":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15

              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock>stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15

              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All products":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Products" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="All Service":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Service" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          elif rth=="Default":
              pdf = canvas.Canvas("reports/Price_List.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product And Services Report")
              

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")


              pdf.drawString(28,733,"Product ID               Product/ Service Name                                  Description                        Unit Price          ")

              count=0
              sql_inv_dt='SELECT * FROM productservice where category="Default" and stock<stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                  
                              pdf.drawString(28,x,str(i[0]))
                              
                              
                              pdf.drawString(145,x,str(i[4]))
                              pdf.drawString(373,x,str(i[5]))
                              
                              pdf.drawString(515,x,str(i[7]))
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Price_List.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==0:
          pass
      else:
          pass
      
      


  def pr_exp_plsr():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch


      if rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==1:
              pdf = canvas.Canvas("reports/Product_Low_Stock_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice WHERE stock < stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          if x==47 or x==50:
                              pdf.showPage()
                              x=750
                          else:
                              pdf.drawString(28,x,str(i[0]))
                              
                              pdf.drawString(128,x,str(i[3]))
                              pdf.drawString(215,x,str(i[4]))
                              pdf.drawString(315,x,str(i[15]))
                              pdf.drawString(405,x,str(i[14])) 
                              pdf.drawString(515,x,str(i[13]))
                          
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_Low_Stock_Report.pdf",None,".",0)
      elif rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==0:
              pdf = canvas.Canvas("reports/Product_Low_Stock_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice WHERE stock > stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          pdf.drawString(28,x,str(i[0]))
                          
                          pdf.drawString(128,x,str(i[3]))
                          pdf.drawString(215,x,str(i[4]))
                          pdf.drawString(315,x,str(i[15]))
                          pdf.drawString(405,x,str(i[14])) 
                          pdf.drawString(515,x,str(i[13]))
                      
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_Low_Stock_Report.pdf",None,".",0)
      elif rpcheckvar1_plr.get()==0 and rpcheckvar2_plr.get()==1:
              pdf = canvas.Canvas("reports/Product_Low_Stock_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              pdf.drawString(415,760, "Product Low Stock Report")
                  

              pdf.drawString(28,750,"__________________________________________________________________________________")
              pdf.drawString(28,730,"__________________________________________________________________________________")
              
              pdf.drawString(28,733,"Product ID            Category           Product Name       Warehouse        Low Stock Limit        Stock    ")
              
          
          
              count=0
              sql_inv_dt='SELECT * FROM productservice WHERE stock < stocklimit'
          
              fbcursor.execute(sql_inv_dt)
              tre=fbcursor.fetchall()
              x=705
              for i in tre:
                          pdf.drawString(28,x,str(i[0]))
                          
                          pdf.drawString(128,x,str(i[3]))
                          pdf.drawString(215,x,str(i[4]))
                          pdf.drawString(315,x,str(i[15]))
                          pdf.drawString(405,x,str(i[14])) 
                          pdf.drawString(515,x,str(i[13]))
                      
                          count += 1
                          x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Product_Low_Stock_Report.pdf",None,".",0)
      else:
              pass

  ######## 

  def pr_exp_tri():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
          pass
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              
          
              vg=len(htg)
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and 	invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid != "0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
              pdf = canvas.Canvas("reports/Tax_report_Invoice.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',10)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
          
              if vg>0:
                        pdf.drawString(30,752,htg[0])
                        
                        if vg>1:
                            pdf.drawString(30,738,htg[1])
                            
                            if vg>2:
                                pdf.drawString(30,725,htg[2])
                            
                                if vg>3:
                                    pdf.drawString(30,712,htg[3])
                                    
                                else:
                                    pass
                            else:
                                pass
                        else:
                            pass
                        
              else:
                        pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(485,760, "Tax report(Invoice)")
              pdf.drawString(370,740, "Date From:"+trifrm.get()+"  Date To:"+trito.get())
              pdf.drawString(470,720,"Invoice Category: All")
              pdf.drawString(28,695,"_________________________________________________________________________________________________")
              pdf.drawString(28,675,"_________________________________________________________________________________________________")
              pdf.drawString(28,678,"Invoice No       Issue Date     Due Date                      Total Before TAX   TAX1         TAX2               Invoice Total       ")
              

              in_dat=trifrm1.get_date()
              cr=trito1.get_date()
              var_1=in_dat
              var_2=cr
          
              count=0
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s and totpaid="0" or balance!="0"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          pdf.drawString(28,x,str(i[1]))
                          
                          pdf.drawString(95,x,str(i[2]))
                          pdf.drawString(150,x,str(i[3]))
                          pdf.drawString(268,x,str(i[37]))
                          pdf.drawString(348,x,str(i[16])) 
                          pdf.drawString(400,x,str(i[36]))
                          pdf.drawString(465,x,str(i[8]))
                          
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Tax_report_Invoice.pdf",None,".",0)
      else:
          pass
      

  def pr_exp_tro():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Tax_report_Orders.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',10)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
      vg=len(htg)
          
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(488,760, "Tax report(Orders)")
      pdf.drawString(370,740, "Date From:"+trofrm.get()+"  Date To:"+troto.get())
      pdf.drawString(470,720,"Invoice Category: All")
      pdf.drawString(28,695,"_________________________________________________________________________________________________")
      pdf.drawString(28,675,"_________________________________________________________________________________________________")
      pdf.drawString(28,678,"Order No         Issue Date     Due Date                      Total Before TAX   TAX1         TAX2                Order Total       ")
      

      in_dat=trofrm1.get_date()
      cr=troto1.get_date()
      var_1=in_dat
      var_2=cr
    
      count=0
      sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
              else:
                          
                  pdf.drawString(28,x,str(i[0]))
                  
                  pdf.drawString(95,x,str(i[1]))
                  pdf.drawString(150,x,str(i[2]))
                  pdf.drawString(268,x,str(i[28]))
                  pdf.drawString(348,x,str(i[14])) 
                  pdf.drawString(400,x,str(i[29]))
                  pdf.drawString(465,x,str(i[8]))
                  
              count += 1
              x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Tax_report_Orders.pdf",None,".",0)


  def pr_exp_srgd():   
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      rth=srgdfilter.get()
    
      if rth==rth:
          pdf = canvas.Canvas("reports/Sales_Report_Group_By_Date.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',10)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          vg=len(htg)
                
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(442,760, "Sales Report(Group By Date)")
          pdf.drawString(365,740, "Date From:"+srgdfrm.get()+"  Date To:"+srgdto.get())
          pdf.drawString(470,720,"Invoice Category: All")
          pdf.drawString(28,695,"_________________________________________________________________________________________________")
          pdf.drawString(28,675,"_________________________________________________________________________________________________")
          pdf.drawString(28,678,"Date                              Quantity                          Cost                                            Income                         profit                ")
      
          lkts=srgdfilter.get()
      
          in_dat=srgd_frm.get_date()
          cr=srgd_to.get_date()
          var_1=in_dat
          var_2=cr
      
          count=0
          sql_inv='SELECT * FROM productservice Where name=%s'
                  # inv_valuz=(var1,var2)
                  
          inv=(lkts,)
          fbcursor.execute(sql_inv, inv)
          tre=fbcursor.fetchall()
          
          lkt=srgdfilter.get()
          sel_inv_dt1='SELECT * FROM invoice Where invodate between %s and %s and Productserviceid=(SELECT Productserviceid from productservice Where name=%s)'
          inv_valuz=(var_1, var_2,lkt,)
          fbcursor.execute(sel_inv_dt1, inv_valuz)
          tre1=fbcursor.fetchall()

          
          x=660
          for i in tre1:
              for j in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      k=int(j[9]*int(i[38]))
                      rt=int(i[8])
                      l=rt-k
                      

                      pdf.drawString(28,x,str(i[2]))
                      
                      pdf.drawString(138,x,str(i[38]))
                      pdf.drawString(245,x,str(k))
                      pdf.drawString(385,x,str(i[8]))
                      pdf.drawString(485,x,str(l)) 
                  
                  count += 1
                  x-=15

        
          pdf.save()
          win32api.ShellExecute(0,"","reports\Sales_Report_Group_By_Date.pdf",None,".",0)
      else:
          pass

  def pr_exp_ird():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Invoice_Report_Detailed.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
      vg=len(htg)
                
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(450,760, "Invoice Report(Detailed)")
      
      pdf.drawString(335,740, "Date From:"+irdfrm.get()+"  Date To:"+irdto.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Date           Customer                  Invoice Total                       Paid                 Balance      ")
      
      
      in_dat=irdfrm1.get_date()
      cr=irdfrm2.get_date()
      var_1=in_dat
      var_2=cr
    
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
      inv_valuz=(var_1,var_2)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=660
      for i in tre:
              if x==44 or x==50:
                  pdf.showPage()
                  x=750
                      
              else:
                          
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(108,x,str(i[2]))
                  pdf.drawString(180,x,str(i[29]))
                  pdf.drawString(300,x,str(i[8]))
                  pdf.drawString(435,x,str(i[9])) 
                  pdf.drawString(520,x,str(i[10]))
                
              count += 1
              x-=15


      pdf.save()
      win32api.ShellExecute(0,"","reports\Invoice_Report_Detailed.pdf",None,".",0)


  def pr_exp_dir():


      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      pdf = canvas.Canvas("reports/Daily_Invoice_Report.pdf", pagesize=letter)

      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      pdf.setFont('Helvetica',12)
      pdf.drawString(30,768, company[1])
      text=company[2]
      wraped_text="\n".join(wrap(text,30))
      htg=wraped_text.split('\n')
      vg=len(htg)
                
      if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
      else:
              pass
      pdf.drawString(30,700, "Sales tax reg No:"+company[4])
      pdf.drawString(460,760, "Daily Invoice Report")
      
      pdf.drawString(445,740, "Date From:"+dirdate.get())
      pdf.drawString(460,720,"Invoice Category: All")
      pdf.drawString(28,695,"__________________________________________________________________________________")
      pdf.drawString(28,675,"__________________________________________________________________________________")
      
      pdf.drawString(28,678,"Invoice No          Date           Customer                  Invoice Total                       Paid                 Balance      ")
      
      
      in_dat=dir_frm.get_date()
    
      var_1=in_dat
    
    
    
      count=0
      sql_inv_dt='SELECT * FROM invoice WHERE invodate=%s'
      inv_valuz=(str(var_1),)
      fbcursor.execute(sql_inv_dt,inv_valuz)
      tre=fbcursor.fetchall()
      x=655
      for i in tre:
              if x==44 or x==50:
                  pdf.showPage()
                  x=750
                      
              else:
                      
                  pdf.drawString(28,x,str(i[1]))
                  
                  pdf.drawString(100,x,str(i[2]))
                  pdf.drawString(178,x,str(i[29]))
                  pdf.drawString(295,x,str(i[8]))
                  pdf.drawString(428,x,str(i[9])) 
                  pdf.drawString(515,x,str(i[10]))
                
              count += 1
              x-=15
      


      pdf.save()
      win32api.ShellExecute(0,"","reports\Daily_Invoice_Report.pdf",None,".",0)


  def pr_exp_por():
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch
      if rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==0:
          pdf = canvas.Canvas("reports/Parchase_Order_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          vg=len(htg)
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s and status="Complete"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=660
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Parchase_Order_Report.pdf",None,".",0)
      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==1:
          pdf = canvas.Canvas("reports/Parchase_Order_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          vg=len(htg)
                
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s and status="Draft"'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=655
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Parchase_Order_Report.pdf",None,".",0)
      elif rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==1:
      
          pdf = canvas.Canvas("reports/Parchase_Order_Report.pdf", pagesize=letter)

          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()
          
          pdf.setFont('Helvetica',12)
          pdf.drawString(30,768, company[1])
          text=company[2]
          wraped_text="\n".join(wrap(text,30))
          htg=wraped_text.split('\n')
          vg=len(htg)
                
          if vg>0:
              pdf.drawString(30,752,htg[0])
              print("1")
              if vg>1:
                pdf.drawString(30,738,htg[1])
                print("2")
                if vg>2:
                    pdf.drawString(30,725,htg[2])
                    print("3")
                    if vg>3:
                        pdf.drawString(30,712,htg[3])
                        print("4")
                    else:
                        pass
                else:
                    pass
              else:
                  pass
              
          else:
              pass
          pdf.drawString(30,700, "Sales tax reg No:"+company[4])
          pdf.drawString(450,760, "Parchase Order Report")
          
          pdf.drawString(345,740, "Date From:"+porfrm.get()+"  Date To:"+porto.get())
          pdf.drawString(460,720,"Invoice Category: All")
          pdf.drawString(28,695,"__________________________________________________________________________________")
          pdf.drawString(28,675,"__________________________________________________________________________________")
          
          pdf.drawString(28,678,"No                  Date           Due Date                  Vendor                       Status                    P.Order Total        ")
          

          
          in_dat=porfrm1.get_date()
          cr=porto1.get_date()
          var_1=in_dat
          var_2=cr
      
      
          count=0
          sql_inv_dt='SELECT * FROM porder where porderdate between %s and %s'
          inv_valuz=(var_1,var_2)
          fbcursor.execute(sql_inv_dt,inv_valuz)
          tre=fbcursor.fetchall()
          x=655
          for i in tre:
                  if x==44 or x==50:
                      pdf.showPage()
                      x=750
                      
                  else:
                          
                      pdf.drawString(28,x,str(i[0]))
                      
                      pdf.drawString(88,x,str(i[2]))
                      pdf.drawString(160,x,str(i[3]))
                      pdf.drawString(280,x,str(i[26]))
                      pdf.drawString(395,x,str(i[5])) 
                      pdf.drawString(495,x,str(i[10]))
                  
                  count += 1
                  x-=15


          pdf.save()
          win32api.ShellExecute(0,"","reports\Parchase_Order_Report.pdf",None,".",0)

  def pr_exp_exp():
      rth=expfilter.get()
      
      from reportlab.pdfgen import canvas
      # from tkdocviewer import *
      from reportlab.lib import colors
      from reportlab.pdfbase.ttfonts import TTFont
      from reportlab.pdfbase import pdfmetrics
      from reportlab.platypus import SimpleDocTemplate, Table, TableStyle
      from reportlab.lib.pagesizes import letter, inch

      if rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and rebillable="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)

          elif rth=="Internal":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal" and rebillable="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==0:
          if rth=="All":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and invoiced="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)

          elif rth=="Internal":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                
              
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal" and invoiced="Yes"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)
          else:
              pass
      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==0:
          pass
      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==1: 
      

          if rth=="All":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,768, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                
              vg=len(htg)
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15

              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)

          elif rth=="Internal":
              pdf = canvas.Canvas("reports/Expenses_Report.pdf", pagesize=letter)

              sql_company = "SELECT * from company"
              fbcursor.execute(sql_company)
              company= fbcursor.fetchone()
              
              pdf.setFont('Helvetica',12)
              pdf.drawString(30,760, company[1])
              text=company[2]
              wraped_text="\n".join(wrap(text,30))
              htg=wraped_text.split('\n')
                
              if vg>0:
                    pdf.drawString(30,752,htg[0])
                    print("1")
                    if vg>1:
                        pdf.drawString(30,738,htg[1])
                        print("2")
                        if vg>2:
                            pdf.drawString(30,725,htg[2])
                            print("3")
                            if vg>3:
                                pdf.drawString(30,712,htg[3])
                                print("4")
                            else:
                                pass
                        else:
                            pass
                    else:
                        pass
                    
              else:
                    pass
              pdf.drawString(30,700, "Sales tax reg No:"+company[4])
              pdf.drawString(475,760, "Expenses Report")
              
              pdf.drawString(335,740, "Date From:"+expfrm.get()+"  Date To:"+expto.get())
              pdf.drawString(460,720,"Invoice Category: All")
              pdf.drawString(28,695,"__________________________________________________________________________________")
              pdf.drawString(28,675,"__________________________________________________________________________________")
              
              pdf.drawString(28,678,"Date            Customer                        Vendor                  Invoice           Rebill.Amount              Amount        ")
              

              
              in_dat=exp_frm.get_date()
              cr=exp_to.get_date()
              var_1=in_dat
              var_2=cr
          
          
              count=0
              sql_inv_dt='SELECT * FROM expenses where date between %s and %s and customer="Internal"'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              x=660
              for i in tre:
                      if x==44 or x==50:
                          pdf.showPage()
                          x=750
                      
                      else:
                          
                    
                          pdf.drawString(28,x,str(i[4]))
                          
                          pdf.drawString(105,x,str(i[10]))
                          pdf.drawString(220,x,str(i[5]))
                          pdf.drawString(330,x,str(i[14]))
                          pdf.drawString(405,x,str(i[16])) 
                          pdf.drawString(520,x,str(i[3]))
                      
                      count += 1
                      x-=15


              pdf.save()
              win32api.ShellExecute(0,"","reports\Expenses_Report.pdf",None,".",0)
          else:
              pass

  #############print image

  def image_print():
      
      from PIL import ImageGrab
    #   x=root.winfo_rootx()+event.winfo_x()
    #   y=root.winfo_rooty()+event.winfo_y()
    #   x1=x+event.winfo_width()
    #   y1=y+event.winfo_height()
    #   thr=ImageGrab.grab().crop((x,182,x1,760)).save("reports/Screen_Chart.png")
      thr=ImageGrab.grab().crop((20,182,1360,760)).save("reports/Screen_Chart.png")
      win32api.ShellExecute(0,"","reports\Screen_Chart.png",None,".",0)    

  def image():
      from PIL import ImageGrab
      path = filedialog.asksaveasfilename(initialdir=os.getcwd,title="Save File",filetypes=[('PNG File', '*.png',)],
      defaultextension=".png")
    #   x=root.winfo_rootx()+widget.winfo_x()
    #   y=root.winfo_rooty()+widget.winfo_y()
    #   x1=x+widget.winfo_width()
    #   y1=y+widget.winfo_height()
      thr=ImageGrab.grab().crop((20,182,1360,760)).save(path)
    

  ##################################### (Report Preview)############################################################# 


  # emails ---------------------

  def rp_send_mails():

      rp_sender_email = "saijuinfox@gmail.com"    
      rp_sender_password = "8848937577" 

      rp_server = smtplib.SMTP('smtp.gmail.com', 587)
    
      rp_server.starttls()

      rp_server.login(rp_sender_email, rp_sender_password)

    
      rp_carbcopy_info = rp_carcopyem_address.get()
      

    
      rp_msg = MIMEMultipart()
      rp_msg['Subject'] = rp_email_subject.get() 
    
      rp_mail_content  = rp_mframe.get('1.0','end-1c') 
      rp_msg['From'] = rp_email_from.get()
      rp_msg['To'] = rp_email_address.get()
    
        
      rp_gettingimg=rp_lstfrm.get()
      rp_lst_data = rp_gettingimg[1:-1].split(',')


      rp_msg.attach(MIMEText(rp_mail_content, 'plain'))

      for i in rp_lst_data:
          if len(i.strip()[1:-1])>1:

              with open('images/'+ i.strip()[1:-1], "rb") as attachment:
    
                  rp_part = MIMEBase("application", "octet-stream")
                  rp_part.set_payload(attachment.read())

                  encoders.encode_base64(rp_part)
                  rp_part.add_header('Content-Disposition', "attachment; filename= %s" % 'images/'+ i.strip()[1:-1]) 

      
                  rp_msg.attach(rp_part)
        

      rp_server.sendmail(rp_email_from.get(),rp_email_address.get(),rp_msg.as_string())
      rp_server.sendmail(rp_email_from.get(), rp_carbcopy_info,rp_msg.as_string()) 

  def rp_empsfile_image(event):
            global rp_yawn
            for i in rp_htcodeframe.curselection():
              print("hloo",rp_htcodeframe.get(i))
              rp_yawn=rp_htcodeframe.get(i)        
              edit_window_img = Toplevel()
              edit_window_img.title("View Image")
              edit_window_img.geometry("700x500")
              image = Image.open("images/"+rp_yawn)
              resize_image = image.resize((700, 500))
              image = ImageTk.PhotoImage(resize_image)
              rp_psimage = Label(edit_window_img,image=image)
              rp_psimage.photo = image
              rp_psimage.pack()


  def op_file(event):
      win32api.ShellExecute(0,"",rp_filenamez,None,".",0)
      

  def rp_UploadAction(event=None):
        global rp_filenamez
        rp_filenamez = askopenfilename(filetypes=(('PDF', '*.pdf',),("png file ",'.png'),("jpg file", ".jpg"),  ("All files", "*.*"),))
        shutil.copyfile(rp_filenamez, os.getcwd()+'/images/'+rp_filenamez.split('/')[-1])
        rp_htcodeframe.insert(0, rp_filenamez.split('/')[-1])
        
      
  def rp_addemail_order():

          rp_emailnow = fbcursor.fetchone()
          rp_mailDetail=Toplevel()
          rp_mailDetail.title("Send E-mail")
          rp_mailDetail.geometry("1080x550")
          rp_mailDetail.resizable(False, False)

          style = ttk.Style()
          style.theme_use('default')
          style.configure('TNotebook.Tab', background="#999999", padding=5)
          rp_email_Notebook = ttk.Notebook(rp_mailDetail)
          rp_email_Frame = Frame(rp_email_Notebook, height=500, width=1080)
          rp_account_Frame = Frame(rp_email_Notebook, height=550, width=1080)
          rp_email_Notebook.add(rp_email_Frame, text="E-mail")
          rp_email_Notebook.add(rp_account_Frame, text="Account")
          rp_email_Notebook.place(x=0, y=0)

          rp_messagelbframe=LabelFrame(rp_email_Frame,text="Message", height=500, width=730)
          rp_messagelbframe.place(x=5, y=5)
          global rp_email_address, rp_email_subject, rp_email_from,rp_email_pswrd,rp_carcopyem_address,rp_mframe,rp_htcodeframe,rp_lstfrm,rp_langs
          rp_email_address = StringVar() 
          rp_email_subject = StringVar()

          rp_email_from = StringVar()
          rp_email_pswrd = StringVar()
          rp_carcopyem_address = StringVar()

          rp_lbl_emailtoaddr=Label(rp_messagelbframe, text="Email to address").place(x=5, y=5)
          rp_emailtoent=Entry(rp_messagelbframe, width=50,textvariable=rp_email_address)
          rp_emailtoent.place(x=120, y=5)
        
          rp_sendemail_btn=Button(rp_messagelbframe, text="Send Email", width=10, height=1, command=rp_send_mails).place(x=600, y=10)

          rp_lbl_carcopyto=Label(rp_messagelbframe, text="Carbon copy to").place(x=5, y=32)
          rp_carcopyent=Entry(rp_messagelbframe, width=50,textvariable=rp_carcopyem_address)
          rp_carcopyent.place(x=120, y=32)

          rp_lbl_subject=Label(rp_messagelbframe, text="Subject").place(x=5, y=59)
          rp_subent=Entry(rp_messagelbframe, width=50, textvariable=rp_email_subject)
          rp_subent.place(x=120, y=59)
          rp_subjectinsrt='ORD_'+str("")
          rp_subent.delete(0,'end')
          rp_subent.insert(0, rp_subjectinsrt)

          
          style = ttk.Style()
          style.theme_use('default')
          style.configure('TNotebook.Tab', background="#999999", width=20, padding=5)
          rp_mess_Notebook = ttk.Notebook(rp_messagelbframe)
          rp_emailmessage_Frame =Frame(rp_mess_Notebook, height=350, width=710)
          rp_htmlsourse_Frame = Frame(rp_mess_Notebook, height=350, width=710)
          rp_mess_Notebook.add(rp_emailmessage_Frame, text="E-mail message")

          rp_mess_Notebook.add(rp_htmlsourse_Frame, )
          rp_mess_Notebook.place(x=5, y=90)
          

          

          from tkinter import font,colorchooser
          fontSize=12
          fontStyle='Arial'
          
          def rp_font_style(event):
              global fontStyle
              fontStyle=font_family_variable.get()
              rp_mframe.config(font=(fontStyle,fontSize))

          def rp_font_size(event):
              global fontSize
              fontSize=size_variable.get()
              rp_mframe.config(font=(fontStyle,fontSize))

          def rp_bold_text():
              bold_font = font.Font(rp_mframe, rp_mframe.cget("font"))
              bold_font.configure(weight="bold")

              rp_mframe.tag_configure("bold", font=bold_font)

              current_tags = rp_mframe.tag_names("sel.first")

              if "bold" in current_tags:
                rp_mframe.tag_remove("bold", "sel.first", "sel.last")
              else:
                rp_mframe.tag_add("bold", "sel.first", "sel.last")    
          
          def rp_italic_text():
              italic_font = font.Font(rp_mframe, rp_mframe.cget("font"))
              italic_font.configure(slant="italic")

              rp_mframe.tag_configure("italic", font=italic_font)

              current_tags = rp_mframe.tag_names("sel.first")

              if "italic" in current_tags:
                rp_mframe.tag_remove("italic", "sel.first", "sel.last")
              else:
                rp_mframe.tag_add("italic", "sel.first", "sel.last")

          def rp_underline_text():
            try:
                if rp_mframe.tag_nextrange('underline_selection', 'sel.first', 'sel.last') != ():
                    rp_mframe.tag_remove('underline_selection', 'sel.first', 'sel.last')
                else:
                    rp_mframe.tag_add('underline_selection', 'sel.first', 'sel.last')
                    rp_mframe.tag_configure('underline_selection', underline=True)
            except TclError:
                pass

          def rp_color_select():
              color=colorchooser.askcolor()[1]
              if color:
            # if color:

                color_font = font.Font(rp_mframe, rp_mframe.cget("font"))

                rp_mframe.tag_configure("colored", font=color_font, foreground=color)

                current_tags = rp_mframe.tag_names("sel.first")

              if "colored" in current_tags:
                rp_mframe.tag_remove("colored", "sel.first", "sel.last")
              else:
                rp_mframe.tag_add("colored", "sel.first", "sel.last")

          def rp_align_right():
              data=rp_mframe.get(0.0,END)
              rp_mframe.tag_config('right',justify=RIGHT)
              rp_mframe.delete(0.0,END)
              rp_mframe.insert(INSERT,data,'right')

          def rp_align_left():
              data=rp_mframe.get(0.0,END)
              rp_mframe.tag_config('left',justify=LEFT)
              rp_mframe.delete(0.0,END)
              rp_mframe.insert(INSERT,data,'left')

          def rp_align_center():
              data=rp_mframe.get(0.0,END)
              rp_mframe.tag_config('center',justify=CENTER)
              rp_mframe.delete(0.0,END)
              rp_mframe.insert(INSERT,data,'center')

          def add_link():
              # from tkHyperLinkManager import HyperlinkManager
              # import webbrowser
              # from functools import partial
              
              hghf=rp_mframe.selection_get()
              content=hghf
              
              
            #   content.configure(foreground="red")
              rp_mframe.insert(END, " "+content)
              
              # rp_mframe.delete(1.0,END)
              
              
              
          def callback(url):
              webbrowser.open_new_tab_url(url)

          def addlinkbox():
              global top
              top = Toplevel()
              top.title('Hyperlink')
              top.geometry("400x100")
              hyp_lbl = LabelFrame(top,text="Hyperlink Information", height=80, width=300)
              hyp_lbl.place(x=10, y=5)

              hyp_lbl1 = Label(top,text="Type:")
              hyp_lbl1.place(x=18, y=24)
              
              def comb_select(event):
                  hyper = cb_comb.get()
                  if hyper == "(other)":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "(other)")
                  elif hyper == "file://":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "file://")
                  elif hyper == "ftp://":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "ftp://") 
                  elif hyper == "http://":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "http://") 
                  elif hyper == "https://":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "https://") 
                  elif hyper == "mailto:":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "mailto:") 
                  elif hyper == "telnet:":
                      hyp= Entry(top,width=35)
                      hyp.place(x=90,y=55)
                      hyp.insert(END,  "telnet:")


              cb_comb = StringVar()
              cb1=ttk.Combobox(top,textvariable=cb_comb,width=15)
              cb1.grid(row=1,column=1,padx=90,pady=30)
              cb1['values']=('(other)','file://','ftp://','http://','https://','mailto:','news:','telnet:')
              cb1.current(0)
              cb1.bind('<<ComboboxSelected>>',comb_select)


              hyp_lbl2 = Label(top,text="URL:")
              hyp_lbl2.place(x=18, y=55)
              global rp_hyper
              rp_hyper = StringVar()
              
              hyp= Entry(top,textvariable=rp_hyper,width=35)
              hyp.place(x=90,y=55)

              

              hypbtn1 = Button(top,text="OK",width=10, command=add_link)
              hypbtn1.place(x=315,y=8)

              hypbtn2 = Button(top,text="Cancel",width=10)
              hypbtn2.place(x=315,y=35)

          rp_mframe=scrolledtext.Text(rp_emailmessage_Frame,  undo=True,width=88, bg="white", height=22)
          
          rp_mframe.place(x=0, y=30)
          
          # link.bind("<Button-1>",lambda e:callback("http://www.tutorialspoint.com"))
          
          
          

          rp_btn1=Button(rp_emailmessage_Frame,width=20,height=20,compound = LEFT,image=selectall,command=lambda :rp_mframe.event_generate('<Control a>'))
          rp_btn1.place(x=0, y=1)

                  
          rp_btn2=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=cut,command=lambda :rp_mframe.event_generate('<Control x>'))
          rp_btn2.place(x=36, y=1)

          rp_btn3=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=copy,command=lambda :rp_mframe.event_generate('<Control c>'))
          rp_btn3.place(x=73, y=1)

          rp_btn4=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=paste,command=lambda :rp_mframe.event_generate('<Control v>'))
          rp_btn4.place(x=105, y=1)
          rp_btn5=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=undo, command=lambda:rp_mframe.event_generate("<<Undo>>")).place(x=140, y=1)

          rp_btn6=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=redo, command=lambda:rp_mframe.event_generate("<<Redo>>")).place(x=175, y=1)

          rp_btn7=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=bold,command=rp_bold_text)
          rp_btn7.place(x=210, y=1)

          rp_btn8=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=italics,command=rp_italic_text)
          rp_btn8.place(x=245, y=1)

          rp_btn9=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=underline,command=rp_underline_text)
          rp_btn9.place(x=280, y=1)

          rp_btn10=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=left,command=rp_align_left)
          rp_btn10.place(x=315, y=1)

          rp_btn11=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=right,command=rp_align_right)
          rp_btn11.place(x=350, y=1)

          rp_btn12=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=center,command=rp_align_center)
          rp_btn12.place(x=385, y=1)

          rp_btn14=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=remove,command=lambda :rp_mframe.delete(0.0,END))
          rp_btn14.place(x=455, y=1)
          
          rp_btn15=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=color,command=rp_color_select)
          rp_btn15.place(x=420, y=1)
          rp_btn16=Button(rp_emailmessage_Frame,width=31,height=23,compound = LEFT,image=hyperlink, command=addlinkbox)
          rp_btn16.place(x=491, y=1)

          size_variable=IntVar()
          dropcomp11 = ttk.Combobox(rp_emailmessage_Frame, width=6, textvariable=size_variable, values=tuple(range(8,100)))
          dropcomp11.place(x=530, y=5)
          
          font_family_variable=StringVar()
          font_familyes=font.families()
          # dropcompo147 = ttk.Combobox(rp_emailmessage_Frame, width=10, textvariable=font_family_variable, values=font_familyes)
          # dropcompo147.place(x=600, y=5)
          # dropcompo147.current(font_familyes.index('Arial'))
          # dropcompo147.bind('<<ComboboxSelected>>', rp_font_style)
          dropcomp11.bind('<<ComboboxSelected>>', rp_font_size)
          
          rp_attachlbframe=LabelFrame(rp_email_Frame,text="Attachment(s)", height=350, width=280)
          rp_attachlbframe.place(x=740, y=5)

          rp_lstfrm=StringVar()  
          rp_htcodeframe=Listbox(rp_attachlbframe, height=13, width=43,listvariable=rp_lstfrm, bg="white")
          rp_htcodeframe.place(x=5, y=5)
          rp_htcodeframe.bind('<Double-Button-1>' , op_file)

          def rp_deslist():
              rp_laa=rp_htcodeframe.curselection()
              print("hloo",rp_htcodeframe.get(rp_laa))
              rp_yawn=rp_htcodeframe.get(rp_laa)        
              rp_htcodeframe.delete(ACTIVE)

          rp_lbl_btn_info=Label(rp_attachlbframe, text="Double click on attachment to view").place(x=30, y=230)
          rp_btn17=Button(rp_attachlbframe, width=20, text="Add attachment file...", command=rp_UploadAction).place(x=60, y=260)
          rp_btn18=Button(rp_attachlbframe, width=20, text="Remove attachment",command=rp_deslist).place(x=60, y=295)
          rp_lbl_tt_info=Label(rp_email_Frame, text="You can create predefined invoice, order, estimate\nand payment receipt email templates under Main\nmenu/Settings/E-Mail templates tab")
          rp_lbl_tt_info.place(x=740, y=370)

          rp_ready_frame=Frame(rp_mailDetail, height=20, width=1080, bg="#b3b3b3").place(x=0,y=530)
          
          rp_sendatalbframe=LabelFrame(rp_account_Frame,text="E-Mail(Sender data)",height=140, width=600)
          rp_sendatalbframe.place(x=240, y=165 )
          rp_lbl_sendermail=Label(rp_sendatalbframe, text="Company email address").place(x=5, y=10)
          rp_sentent=Entry(rp_sendatalbframe, width=40, textvariable=rp_email_from)
          rp_sentent.place(x=195, y=10)

          rp_lbl_senderpswrd=Label(rp_sendatalbframe, text="Email Password").place(x=5, y=40)
          rp_pswrdent=Entry(rp_sendatalbframe, width=40, textvariable=rp_email_pswrd,show="*")
          rp_pswrdent.place(x=195, y=40)

          

  #Filter by category----------------------------------------------------------------------------
  #-----------------------------------------------ScreenChart-------------------------------
  def screen_flt(): 
      rth=scrfilter.get()

      
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()

      if rth=="Last 3 Month":
          if company is not None:
              
              in_dat = (datetime.now()-relativedelta(months=3)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=in_dat
              
              lscr1=cr
              
              var_1=in_dat
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Salesss", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

          lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
          lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
          

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          
          
          if company is not None:
              test_date=pendulum.today().date()
              start = test_date.start_of('year')
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, start)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)
              
              lscr=start
              lscr1=cr

              var_1=start
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()


              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

            
          #===============================================================================================
      elif rth=="Current year":
          

          
          if company is not None:
              test_date=pendulum.today().date()
              start = test_date.start_of('year')
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, start)

              test_date_end=pendulum.today().date()
              end = test_date_end.end_of('year')
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, end)

              lscr=start
              lscr1=end

              var_1=start
              var_2=end
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Total")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
      #==============================================================================================================
      elif rth=="Last 6 Month":
              
          
          if company is not None:
              in_dat = (datetime.now()-relativedelta(months=6)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=in_dat
              
              lscr1=cr

              var_1=in_dat
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Total")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
          #=====================================================================================================
      elif rth=="Last 12 Month":
          

          
          if company is not None:
              in_dat = (datetime.now()-relativedelta(months=12)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)
              

              lscr=in_dat
              
              lscr1=cr

              var_1=in_dat
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("TOtal Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
          #=================================================================================================
      elif rth=="Last 18 Month":
          
      
          if company is not None:
              in_dat = (datetime.now()-relativedelta(months=18)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=in_dat
              
              lscr1=cr

              var_1=in_dat
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
      
      #=====================================================================================================
      elif rth=="Last 24 Month":
        
          
          if company is not None:
              in_dat = (datetime.now()-relativedelta(months=6)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=in_dat
              
              lscr1=cr

              var_1=in_dat
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
      #========================================================================================================
      #================================================================================================================
      
          #====================================================================================================
      elif rth=="Before Previous Year":
          
          if company is not None:
              in_dat = (datetime.now()-relativedelta(years=2)).strftime("%Y-%m-%d")
              # given_date = datetime.today().month()
              # in_dat = given_date.replace(months=3)
              
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, in_dat)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=in_dat
              
              lscr1=cr

              var_1=in_dat
              var_2=cr

              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("x-axis")
              plt.ylabel("y-label")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("x-axis")
              plt.ylabel("y-label")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

          
          #===========================================================================================================
      elif rth=="Previous year":
          
          if company is not None:
              last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
              rp_scr_frm.delete(0,'end')
              rp_scr_frm.insert(0, last_year)

              cr=date.today()
              rp_sc_to.delete(0,'end')
              rp_sc_to.insert(0, cr)

              lscr=last_year
              lscr1=cr

              var_1=last_year
              var_2=cr
              
              sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_paid,inv_valuz)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(x_axis, inv_valuz)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_company,inv_valuz)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_outstanding,inv_valuz)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=lscr1
            
              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sec_paid,inv_valuz)
              paid_sec_x= fbcursor.fetchone()

              


              sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
              inv_valuz=(var_1,var_2)

              fbcursor.execute(sec_paid_y,inv_valuz)

              paid_sec_y= fbcursor.fetchone()

              


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_sec_y
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid,inv_valuz)
              paid_thrd_x= fbcursor.fetchone()
              


              thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
              inv_valuz=(var_1,var_2)
              fbcursor.execute(thrd_paid_y,inv_valuz)

              paid_thrd_y= fbcursor.fetchone()


              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=paid_thrd_y
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
              # def my_popup(event):
              #     my_menu.tk_popup(event.x_root, event.y_root)
                  
              # my_menu= Menu(canvasbar, tearoff=False)
              # my_menu.add_command(label="Refresh Chart", command="run")
              # my_menu.add_separator()
              # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
              # my_menu.add_separator()
              # my_menu.add_command(label="Save Chart As Image", command='emailrp')
              # my_menu.add_separator()
              # my_menu.add_command(label="Print Chart", command="excel")
              # canvasbar.bind("<Button-3>", my_popup)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

              
      # ------------------------------
      elif rth=="Custom Range":
          

          
          if company is not None:
              ltr=rp_scr_frm.get_date()
              ltr1=rp_sc_to.get_date()
              # var_12=ltr
              # var_21=ltr1

              # sqlr_paid ="SELECT * from invoice WHERE invodate BETWEEN %s and %s"
              # invs_valuz=(var_12,var_21)
              # fbcursor.execute(sqlr_paid,invs_valuz)
              # invoicess= fbcursor.fetchone()

              if ltr!=ltr1:
                  print("hai")


                  ltt=rp_scr_frm.get_date()
                  ltt1=rp_sc_to.get_date()
                  

                  var_1=ltt
                  var_2=ltt1
                  
                  sql_paid ="SELECT SUM(invoicetot)from invoice WHERE invodate BETWEEN %s and %s"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(sql_paid,inv_valuz)
                  invoice= fbcursor.fetchone()

                  x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice WHERE invodate BETWEEN %s and %s)"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(x_axis, inv_valuz)
                  axis_x= fbcursor.fetchone()



                  sql_company = "SELECT SUM(totpaid)from invoice WHERE invodate BETWEEN %s and %s"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(sql_company,inv_valuz)
                  paid= fbcursor.fetchone()



                  sql_outstanding = "SELECT SUM(balance)from invoice WHERE invodate BETWEEN %s and %s"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(sql_outstanding,inv_valuz)
                  outstanding= fbcursor.fetchone()


                  frame = Frame(
                          reportframe,
                          width=1380,
                          height=1000,
                          bg='#b3b3b3',
                          )
                  frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                      
                  frame.pack()


                  x=ltt1
              
                  y=invoice

                  x=axis_x
                  figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
                  plt.bar(x,y, label="Invoice", color="orange")
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()

                  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




                  #**************add dates********

                  dates=axis_x[0]+timedelta(days=2)

                  y=outstanding
                  x=dates
                  plt.bar(x,y, label="Outstanding", color="blue")
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()
                  # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


                  dates3=axis_x[0]-timedelta(days=2)
                  y=paid
                  x=dates3
                  plt.bar(x,y, label="Paid", color="green") 
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()
                  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

                  #used to display chart in our frame
                  canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

                  #second graph

                  sec_paid = "SELECT invoicetot from (select invodate, invoicetot from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(sec_paid,inv_valuz)
                  paid_sec_x= fbcursor.fetchone()

                  


                  sec_paid_y = "SELECT businessname from (select invodate, businessname from invoice  GROUP BY businessname having invodate BETWEEN %s and %s ORDER by COUNT(businessname) DESC LIMIT 1)as sec"
                  inv_valuz=(var_1,var_2)

                  fbcursor.execute(sec_paid_y,inv_valuz)

                  paid_sec_y= fbcursor.fetchone()

                  


                  figsecond = plt.figure(figsize=(9, 4), dpi=80)

                  x=paid_sec_y
                  y=paid_sec_x
                  plt.barh(x,y, label="Top Billed Customer", color="orange") 
                  plt.legend()
                  plt.xlabel("Invoiced Amont")
                  plt.ylabel("")
                  axes=plt.gca()
                  axes.xaxis.grid()


                  canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=0, y=370)

                  # #second graph

                  thrd_paid = "SELECT invoicetot from(select invodate,invoicetot from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(thrd_paid,inv_valuz)
                  paid_thrd_x= fbcursor.fetchone()
                  


                  thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from(select invodate,Productserviceid from invoice GROUP BY Productserviceid HAVING invodate BETWEEN %s and %s ORDER by COUNT(Productserviceid) DESC LIMIT 1)as lkiii)"
                  inv_valuz=(var_1,var_2)
                  fbcursor.execute(thrd_paid_y,inv_valuz)

                  paid_thrd_y= fbcursor.fetchone()


                  figlast = plt.figure(figsize=(9, 4), dpi=80)

                  x=paid_thrd_y
                  y=paid_thrd_x   
                  plt.barh(x,y, label="Top Product Sale", color="blue") 
                  plt.legend()
                  plt.xlabel("Total Sales")
                  plt.ylabel("")
                  axes=plt.gca()
                  axes.xaxis.grid()
                  

                  canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=650, y=370)

                  lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
                  lbl_invdtt2.place(x=2, y=85)
                  # def my_popup(event):
                  #     my_menu.tk_popup(event.x_root, event.y_root)
                      
                  # my_menu= Menu(canvasbar, tearoff=False)
                  # my_menu.add_command(label="Refresh Chart", command="run")
                  # my_menu.add_separator()
                  # my_menu.add_command(label="Copy Chart To Clipboard", command="pr")
                  # my_menu.add_separator()
                  # my_menu.add_command(label="Save Chart As Image", command='emailrp')
                  # my_menu.add_separator()
                  # my_menu.add_command(label="Print Chart", command="excel")
                  # canvasbar.bind("<Button-3>", my_popup)
              else:
              
                  sql_paid = "SELECT SUM(invoicetot)from invoice"
                  fbcursor.execute(sql_paid)
                  invoice= fbcursor.fetchone()

                  x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
                  fbcursor.execute(x_axis)
                  axis_x= fbcursor.fetchone()



                  sql_company = "SELECT SUM(totpaid)from invoice"
                  fbcursor.execute(sql_company)
                  paid= fbcursor.fetchone()



                  sql_outstanding = "SELECT SUM(balance)from invoice"
                  fbcursor.execute(sql_outstanding)
                  outstanding= fbcursor.fetchone()


                  frame = Frame(
                          reportframe,
                          width=1380,
                          height=1000,
                          bg='#b3b3b3',
                          )
                  frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                      
                  frame.pack()


                  x=datetime.today()

                  y=0

                  x=axis_x
                  figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
                  plt.bar(x,y, label="Invoice", color="orange")
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()

                  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




                  #**************add dates********

                  dates=axis_x[0]+timedelta(days=2)

                  y=0
                  x=dates
                  plt.bar(x,y, label="Outstanding", color="blue")
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()
                  # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


                  dates3=axis_x[0]-timedelta(days=2)
                  y=0
                  x=dates3
                  plt.bar(x,y, label="Paid", color="green") 
                  plt.legend()
                  plt.xlabel("Total Amount")
                  plt.ylabel("Date")
                  axes=plt.gca()
                  axes.yaxis.grid()
                  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

                  #used to display chart in our frame
                  canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

                  #second graph

                  sec_paid = "SELECT MAX(invoicetot) from invoice"
                  fbcursor.execute(sec_paid)
                  paid_sec_x= fbcursor.fetchone()

                  sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

                  fbcursor.execute(sec_paid_y)

                  paid_sec_y= fbcursor.fetchone()


                  figsecond = plt.figure(figsize=(9, 4), dpi=80)

                  x=0
                  y=0
                  plt.barh(x,y, label="Top Billed Customer", color="orange") 
                  plt.legend()
                  plt.xlabel("Invoiced Amount")
                  plt.ylabel("")
                  axes=plt.gca()
                  axes.xaxis.grid()


                  canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=0, y=370)

                  # #second graph

                  thrd_paid = "SELECT MAX(unitprice) from productservice"
                  fbcursor.execute(thrd_paid)
                  paid_thrd_x= fbcursor.fetchone()


                  thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

                  fbcursor.execute(thrd_paid_y)

                  paid_thrd_y= fbcursor.fetchone()

                  figlast = plt.figure(figsize=(9, 4), dpi=80)

                  x=0
                  y=0 
                  plt.barh(x,y, label="Top Product Sale", color="blue") 
                  plt.legend()
                  plt.xlabel("Total Sales")
                  plt.ylabel("")
                  axes=plt.gca()
                  axes.xaxis.grid()
                  

                  canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
                  canvasbar.draw()
                  canvasbar.get_tk_widget().place(x=650, y=370)

                  lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
                  lbl_invdtt2.place(x=2, y=85)

          else:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              frame = Frame(
                      reportframe,
                      width=1380,
                      height=1000,
                      bg='#b3b3b3',
                      )
              frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
                  
              frame.pack()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)

              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Total Amount")
              plt.ylabel("Date")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              #second graph

              sec_paid = "SELECT MAX(invoicetot) from invoice"
              fbcursor.execute(sec_paid)
              paid_sec_x= fbcursor.fetchone()

              sec_paid_y = "SELECT businessname from invoice WHERE invoicetot= (SELECT MAX(invoicetot) from invoice)"

              fbcursor.execute(sec_paid_y)

              paid_sec_y= fbcursor.fetchone()


              figsecond = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_sec_x
              plt.barh(x,y, label="Top Billed Customer", color="orange") 
              plt.legend()
              plt.xlabel("Invoiced Amount")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()


              canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=0, y=370)

              # #second graph

              thrd_paid = "SELECT MAX(unitprice) from productservice"
              fbcursor.execute(thrd_paid)
              paid_thrd_x= fbcursor.fetchone()


              thrd_paid_y = "SELECT name from productservice WHERE unitprice= (SELECT MAX(unitprice) from productservice)"

              fbcursor.execute(thrd_paid_y)

              paid_thrd_y= fbcursor.fetchone()

              figlast = plt.figure(figsize=(9, 4), dpi=80)

              x=0
              y=paid_thrd_x   
              plt.barh(x,y, label="Top Product Sale", color="blue") 
              plt.legend()
              plt.xlabel("Total Sales")
              plt.ylabel("")
              axes=plt.gca()
              axes.xaxis.grid()
              

              canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
              canvasbar.draw()
              canvasbar.get_tk_widget().place(x=650, y=370)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

            

          #============================================================================================
      else:
          pass
      

  #---------------------------------------------------INVOICE FILTER-----------------------------------------------
  def emailkj():
              rpmailDetail=Toplevel()
              rpmailDetail.title("E-Mail")
              p2 = PhotoImage(file = "images/fbicon.png")
              rpmailDetail.iconphoto(False, p2)
              rpmailDetail.geometry("1030x550+150+120")
              
              def myrp_SMTP():
                  if True:
                      em_ser_conbtn.destroy()
                      mysmtpservercon=LabelFrame(account_Frame,text="SMTP server connection(ask your ISP for your SMTP settings)", height=165, width=380)
                      mysmtpservercon.place(x=610, y=110)
                      lbl_hostn=Label(mysmtpservercon, text="Hostname").place(x=5, y=10)
                      hostnent=Entry(mysmtpservercon, width=30).place(x=80, y=10)
                      lbl_portn=Label(mysmtpservercon, text="Port").place(x=5, y=35)
                      portent=Entry(mysmtpservercon, width=30).place(x=80, y=35)
                      lbl_usn=Label(mysmtpservercon, text="Username").place(x=5, y=60)
                      unament=Entry(mysmtpservercon, width=30).place(x=80, y=60)
                      lbl_pasn=Label(mysmtpservercon, text="Password").place(x=5, y=85)
                      pwdent=Entry(mysmtpservercon, width=30).place(x=80, y=85)
                      ssl_chkvar=IntVar()
                      ssl_chkbtn=Checkbutton(mysmtpservercon, variable=ssl_chkvar, text="This server requires a secure connection(SSL)", onvalue=1, offvalue=0)
                      ssl_chkbtn.place(x=50, y=110)
                      em_ser_conbtn1=Button(account_Frame, text="Test E-mail Server Connection").place(x=610, y=285)
                  else:
                      pass
              
              style = ttk.Style()
              style.theme_use('default')
              style.configure('TNotebook.Tab', background="#999999", padding=5)
              email_Notebook = ttk.Notebook(rpmailDetail)
              email_Frame = Frame(email_Notebook, height=500, width=1080)
              account_Frame = Frame(email_Notebook, height=550, width=1080)
              email_Notebook.add(email_Frame, text="E-mail")
              email_Notebook.add(account_Frame, text="Account")
              email_Notebook.place(x=0, y=0)
              messagelbframe=LabelFrame(email_Frame,text="Message", height=495, width=730)
              messagelbframe.place(x=5, y=5)
              lbl_emailtoaddr=Label(messagelbframe, text="Email to address").place(x=5, y=5)
              emailtoent=Entry(messagelbframe, width=50).place(x=120, y=5)
              sendemail_btn=Button(messagelbframe, text="Send Email", width=10, height=1).place(x=600, y=10)
              lbl_carcopyto=Label(messagelbframe, text="Carbon copy to").place(x=5, y=32)
              carcopyent=Entry(messagelbframe, width=50).place(x=120, y=32)
              stopemail_btn=Button(messagelbframe, text="Stop sending", width=10, height=1).place(x=600, y=40)
              lbl_subject=Label(messagelbframe, text="Subject").place(x=5, y=59)
              subent=Entry(messagelbframe, width=50).place(x=120, y=59)

              style = ttk.Style()
              style.theme_use('default')
              style.configure('TNotebook.Tab', background="#999999", width=20, padding=5)
              mess_Notebook = ttk.Notebook(messagelbframe)
              emailmessage_Frame = Frame(mess_Notebook, height=350, width=710)
              htmlsourse_Frame = Frame(mess_Notebook, height=350, width=710)
              mess_Notebook.add(emailmessage_Frame, text="E-mail message")
              mess_Notebook.add(htmlsourse_Frame, text="Html sourse code")
              mess_Notebook.place(x=5, y=90)

              btn1=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=selectall).place(x=0, y=1)  
              btn2=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=cut).place(x=36, y=1)
              btn3=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=copy).place(x=73, y=1)
              btn4=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=paste).place(x=105, y=1)
              btn5=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=undo).place(x=140, y=1)
              btn6=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=redo).place(x=175, y=1)
              btn7=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=bold).place(x=210, y=1)
              btn8=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=italics).place(x=245, y=1)
              btn9=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=underline).place(x=280, y=1)
              btn10=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=left).place(x=315, y=1)
              btn11=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=right).place(x=350, y=1)
              btn12=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=center).place(x=385, y=1)
              btn13=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=hyperlink).place(x=420, y=1)
              btn14=Button(emailmessage_Frame,width=31,height=23,compound = LEFT,image=remove).place(x=455, y=1)

              dropcomp = ttk.Combobox(emailmessage_Frame, width=12, height=3).place(x=500, y=5)
              dropcompo = ttk.Combobox(emailmessage_Frame, width=6, height=3).place(x=600, y=5)
              mframe=Frame(emailmessage_Frame, height=350, width=710, bg="white")
              mframe.place(x=0, y=28)
              btn1=Button(htmlsourse_Frame,width=31,height=23,compound = LEFT,image=selectall).place(x=0, y=1)
              btn2=Button(htmlsourse_Frame,width=31,height=23,compound = LEFT,image=cut).place(x=36, y=1)
              btn3=Button(htmlsourse_Frame,width=31,height=23,compound = LEFT,image=copy).place(x=73, y=1)
              btn4=Button(htmlsourse_Frame,width=31,height=23,compound = LEFT,image=paste).place(x=105, y=1)
              mframe=Frame(htmlsourse_Frame, height=350, width=710, bg="white")
              mframe.place(x=0, y=28)
              rp_attachlbframe=LabelFrame(email_Frame,text="Attachment(s)", height=350, width=280)
              rp_attachlbframe.place(x=740, y=5)
              htcodeframe=Frame(rp_attachlbframe, height=220, width=265, bg="white").place(x=5, y=5)
              lbl_btn_info=Label(rp_attachlbframe, text="Double click on attachment to view").place(x=30, y=230)
              btn17=Button(rp_attachlbframe, width=20, text="Add attacment file...").place(x=60, y=260)
              btn18=Button(rp_attachlbframe, width=20, text="Remove attacment").place(x=60, y=295)
              lbl_tt_info=Label(email_Frame, text="You can create predefined invoice, order, estimate\nand payment receipt email templates under Main\nmenu/Settings/E-Mail templates tab")
              lbl_tt_info.place(x=740, y=370)

              ready_frame=Frame(rpmailDetail, height=20, width=1080, bg="#b3b3b3").place(x=0,y=530)
              
              sendatalbframe=LabelFrame(account_Frame,text="E-Mail(Sender data)",height=270, width=600)
              sendatalbframe.place(x=5, y=5)
              lbl_sendermail=Label(sendatalbframe, text="Your company email address").place(x=5, y=30)
              sentent=Entry(sendatalbframe, width=40).place(x=195, y=30)
              lbl_orcompanyname=Label(sendatalbframe, text="Your name or company name").place(x=5, y=60)
              nament=Entry(sendatalbframe, width=40).place(x=195, y=60)
              lbl_reply=Label(sendatalbframe, text="Reply to email address").place(x=5, y=90)
              replyent=Entry(sendatalbframe, width=40).place(x=195, y=90)
              lbl_sign=Label(sendatalbframe, text="Signature").place(x=5, y=120)
              signent=Entry(sendatalbframe,width=50).place(x=100, y=120,height=75)
              confirm_chkvar=IntVar()
              confirm_chkbtn=Checkbutton(sendatalbframe, variable=confirm_chkvar, text="Confirmation reading", onvalue=1, offvalue=0)
              confirm_chkbtn.place(x=200, y=215)
              btn18=Button(account_Frame, width=15, text="Save settings").place(x=25, y=285)

              sendatalbframe=LabelFrame(account_Frame,text="SMTP Server",height=100, width=380)
              sendatalbframe.place(x=610, y=5)
              servar=IntVar()
              SMTP_rbtn=Radiobutton(sendatalbframe, text="Use the Built-In SMTP Server Settings", variable=servar, value=1)
              SMTP_rbtn.place(x=10, y=10)
              MySMTP_rbtn=Radiobutton(sendatalbframe, text="Use My Own SMTP Server Settings(Recommended)", variable=servar, value=2, command=myrp_SMTP)
              MySMTP_rbtn.place(x=10, y=40)
              em_ser_conbtn=Button(account_Frame, text="Test E-mail Server Connection")
              em_ser_conbtn.place(x=710, y=110)


#   sql='select dateformat from company'
#   fbcursor.execute(sql)
#   rp_date_for=fbcursor.fetchone()
#   global dts
#   if not rp_date_for:
#         pass
#   else:
#           if rp_date_for[0]=="mm-dd-yyyy":
#              dts='%m-%d-%Y'

#           elif rp_date_for[0]=="dd-mm-yyyy":
#              dts='%d-%m-%Y'
   
#           elif rp_date_for[0]=="yyyy.mm.dd":
#              dts='%Y.%m.%d'
    
#           elif rp_date_for[0]=="mm/dd/yyyy":
#               dts='%m/%d/%y'
    
#           elif rp_date_for[0]=="dd/mm/yyyy":
#               dts='%d/%m/%Y'
             
#           elif rp_date_for[0]=="dd.mm.yyyy":
#               dts='%d.%m.%Y'
              
#           elif rp_date_for[0]=="yyyy/mm/dd":
#               dts='%Y/%m/%d'

#           else:
#               dts='%d-%m-%Y'
              


  def category():
      sql='select dateformat from company'
      fbcursor.execute(sql)
      rp_date_for=fbcursor.fetchone()
      global dts
      if not rp_date_for:
                pass
      else:
                if rp_date_for[0]=="mm-dd-yyyy":
                    dts='%m-%d-%Y'

                elif rp_date_for[0]=="dd-mm-yyyy":
                    dts='%d-%m-%Y'
        
                elif rp_date_for[0]=="yyyy.mm.dd":
                    dts='%Y.%m.%d'
            
                elif rp_date_for[0]=="mm/dd/yyyy":
                    dts='%m/%d/%y'
            
                elif rp_date_for[0]=="dd/mm/yyyy":
                    dts='%d/%m/%Y'
                    
                elif rp_date_for[0]=="dd.mm.yyyy":
                    dts='%d.%m.%Y'
                    
                elif rp_date_for[0]=="yyyy/mm/dd":
                    dts='%Y/%m/%d'

                else:
                    dts='%d-%m-%Y'
      
    # firtst filter-----------------------------------Month to date
      
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      global drf
      
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      
      #-------------------------
      
      rth=invfilter.get()
      
      if rth=="Month to date":
          sql='select dateformat from company'
          fbcursor.execute(sql)
          rp_date_for=fbcursor.fetchone()

          print(rp_exir.get())
          lkj=rp_exir.get()
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          print(in_dat)
          rp_exir.delete(0,'end')
        #   jh=rp_exir.insert(0, in_dat)
          rp_exir.set_date(in_dat.strftime(dts))
        
          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          drf=canvas

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')

          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
        
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw",justify=LEFT, width=50, height=6)
              labelcmpl.config(justify="left")
              
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')
              
              
              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
            
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  
                  count += 1
              
              
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # print ('haii')
              # tot_tri= fbcursor.fetchall()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchall()
              
              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_inv_bal= fbcursor.fetchall()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','-End Of List- ','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_inv_bal))
              

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)
              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          
          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
      

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          rp_exir.delete(0,'end')
          rp_exir.insert(0, start.strftime(dts))

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw",justify=LEFT, width=50, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          rp_exir.delete(0,'end')
          rp_exir.insert(0, start.strftime(dts))

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, end.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", justify=LEFT,width=50, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
              tot_tris= fbcursor.fetchall()
            
              
              for i in tot_tris:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
            #   total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
            #   inv_valuz1=(var1,var2)
            #   fbcursor.execute(total_tri,inv_valuz1)
            #   tot_tri1= fbcursor.fetchone()
              

            #   total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
            #   inv_valuz2=(var1,var2)
            #   fbcursor.execute(total_tax1_tri,inv_valuz2)
            #   tot_tax1_tri= fbcursor.fetchone()

            #   total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
            #   inv_valuz3=(var1,var2)
            #   fbcursor.execute(total_tax2_tri,inv_valuz3)
            #   tot_balance= fbcursor.fetchone()
              
            #   rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
            #   rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri1,tot_tax1_tri,tot_balance))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          rp_exir.delete(0,'end')
          rp_exir.insert(0, in_dat.strftime(dts))

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, nxt_mnth.strftime(dts))
          
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50, justify=LEFT,height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":

        #   given_date=rp_exir.get_date().strftime(dts)
          
          given_date = date.today()
          rp_exir.delete(0,'end')
          rp_exir.insert(0,given_date.strftime(dts))

        #   cr=date.today()
        #   rp_exir1.delete(0,'end')
        #   rp_exir1.insert(0, cr.strftime(dts))
          cr=rp_exir1.get_date().strftime(dts)
          
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              inv_valuz1=(var1,var2)
              fbcursor.execute(total_tri,inv_valuz1)
              tot_tri= fbcursor.fetchone()
              

              total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              inv_valuz2=(var1,var2)
              fbcursor.execute(total_tax1_tri,inv_valuz2)
              tot_tax1_tri= fbcursor.fetchone()

              total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              inv_valuz3=(var1,var2)
              fbcursor.execute(total_tax2_tri,inv_valuz3)
              tot_tax2_tri= fbcursor.fetchone()
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoicess Total','Total Paid','Balance'))
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)


          
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          rp_exir.delete(0,'end')
          rp_exir.insert(0, in_dat.strftime(dts))

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          rp_exir.delete(0,'end')
          rp_exir.insert(0, in_dat)

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr)
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')
              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
      #========================================================================================================
      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          rp_exir.delete(0,'end')
          rp_exir.insert(0, in_dat.strftime(dts))

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Terms")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Invoice Paid")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          rp_exir.delete(0,'end')
          rp_exir.insert(0, in_dat.strftime(dts))

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          

          last_year = (datetime.now()-relativedelta(years=1))
          rp_exir.delete(0,'end')
          rp_exir.insert(0, last_year.strftime(dts))

          cr=date.today()
          rp_exir1.delete(0,'end')
          rp_exir1.insert(0, cr.strftime(dts))
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)
      # ------------------------------
      elif rth=="Custom Range":
          trt=rp_exir.get_date()
          ltt=trt.set_date(trt).strftime(dts)
          ltt1=rp_exir1.get_date().strftime(dts)

          
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          # Create an instance of Style widget
          style=ttk.Style()
          style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
          style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
          style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
          
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
                  
              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0
            
              var1=ltt
              var2=ltt1
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)

              fbcursor.execute(sql_inv_dt,inv_valuz)
            
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice WHERE invoicetot = (SELECT invoicetot FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz1=(var1,var2)
              # fbcursor.execute(total_tri,inv_valuz1)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice WHERE totpaid = (SELECT totpaid FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz2=(var1,var2)
              # fbcursor.execute(total_tax1_tri,inv_valuz2)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice WHERE balance = (SELECT balance FROM invoice WHERE invodate BETWEEN %s and %s)'
              # inv_valuz3=(var1,var2)
              # fbcursor.execute(total_tax2_tri,inv_valuz3)
              # tot_tax2_tri= fbcursor.fetchone()
              
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              # rp_inv_tree.insert('', 'end',text="1",values=('','','','','',tot_tri,tot_tax1_tri,tot_tax2_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              rp_inv_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+invfrm.get()+"      Date To:"+invto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp())


          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass
      
  #---------------------------------------------------INVOICE REPORT (WITH CUSTOMER)---------------------------------
  def category_irwc(): 
      sql='select dateformat from company'
      fbcursor.execute(sql)
      rp_date_for=fbcursor.fetchone()
      if not rp_date_for:
                pass
      else:
                if rp_date_for[0]=="mm-dd-yyyy":
                    dts='%m-%d-%Y'

                elif rp_date_for[0]=="dd-mm-yyyy":
                    dts='%d-%m-%Y'
        
                elif rp_date_for[0]=="yyyy.mm.dd":
                    dts='%Y.%m.%d'
            
                elif rp_date_for[0]=="mm/dd/yyyy":
                    dts='%m/%d/%y'
            
                elif rp_date_for[0]=="dd/mm/yyyy":
                    dts='%d/%m/%Y'
                    
                elif rp_date_for[0]=="dd.mm.yyyy":
                    dts='%d.%m.%Y'
                    
                elif rp_date_for[0]=="yyyy/mm/dd":
                    dts='%Y/%m/%d'

                else:
                    dts='%d-%m-%Y'
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
     

      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
    
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      
      ps_cr=post_rp[0]
      global drf
      rth=irwcfilter.get()
      if rth=="Month to date":
          

          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              

              
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              print(ps_cr)

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8]+" "+crc)))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, start.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50, justify=LEFT,height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, start.strftime(dts))

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          irwcto1.delete(0,'end')
          irwcto1.insert(0, end.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          irwcto1.delete(0,'end')
          irwcto1.insert(0, nxt_mnth.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
        #   given_date = date.today()
        #   irwcfrm1.delete(0,'end')
          given_date=irwcfrm1.get_date()
        #   irwcfrm1.insert(0,given_date.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
  
      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, in_dat.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1))
          irwcfrm1.delete(0,'end')
          irwcfrm1.insert(0, last_year.strftime(dts))

          cr=date.today()
          irwcto1.delete(0,'end')
          irwcto1.insert(0, cr.strftime(dts))

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0
              
              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)
      elif rth=="Custom Range":
          lte=irwcfrm1.get_date()
          lte1=irwcto1.get_date()
        

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_irwc_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              # Insert the data in Treeview widget
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=lte
              var2=lte1
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
          
              
              # rp_irwc_tree.insert('', 'end',text="1",values=('','','End of List','','','Invoice Total'))

              # rp_irwc_tree.insert('', 'end',text="1",values=('','','','','Summary:',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_irwc_tree)


              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irwcfrm.get()+"      Date To:"+irwcto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
              
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_irwc())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_irwc())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas2())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_irwc())


          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      
      else:
          pass
      
      

  #-------------------------------------------------Order report-----------------------------------------
  def category_or():
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      or_company = "SELECT * from company"
      fbcursor.execute(or_company)
      company_or= fbcursor.fetchone()
      global drf
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=orfilter.get()
      if rth=="Month to date":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame( 
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  
                  
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          orfrm1.delete(0,'end')
          orfrm1.insert(0, start)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0

              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          orfrm1.delete(0,'end')
          orfrm1.insert(0, start)

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          orto1.delete(0,'end')
          orto1.insert(0, end)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))
              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          orto1.delete(0,'end')
          orto1.insert(0, nxt_mnth)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
              
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0

              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
          given_date = date.today()
          orfrm1.delete(0,'end')
          orfrm1.insert(0,given_date)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)


      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          orfrm1.delete(0,'end')
          orfrm1.insert(0, in_dat)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
          orfrm1.delete(0,'end')
          orfrm1.insert(0, last_year)

          cr=date.today()
          orto1.delete(0,'end')
          orto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0

              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)
      elif rth=="Custom Range":
          loy=orfrm1.get_date()
          loy1=orto1.get_date()
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvas,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_or_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_or_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_or_tree.heading("# 1", text="No")
              rp_or_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 2", text="Date")
              rp_or_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_or_tree.heading("# 3", text="Due Date")
              rp_or_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_or_tree.heading("# 4", text="Customer")
              rp_or_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 5", text="Status")
              rp_or_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_or_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_or_tree.get_children():
                  rp_or_tree.delete(record)
              count=0
              var1=loy
              var2=loy1
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  
                  if ps_cr=="before amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+str(i[26])))
                     
                  elif ps_cr=="after amount":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], crc+" "+str(i[26])))
                      
                  elif ps_cr=="after amount with space":
                      rp_or_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], i[3], i[4], str(i[26])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(sum_subtotal) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              # rp_or_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_or_tree)


          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
                  
                  # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

                  # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          
          canvas.create_text(900,100,text="Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+orfrm.get()+"      Date To:"+orto.get()+"\n order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_or())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_or())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas3())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_or())
          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass
  #-------------------------------------------------Tax Report Invoice-----------------------------------------
  def category_tri():
    # firtst filter-----------------------------------Month to date
      
      tri_company = "SELECT * from company"
      fbcursor.execute(tri_company)
      company_tri= fbcursor.fetchone()
      global drf
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=trifilter.get()
      if rth=="Month to date":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500, 
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                    
                  
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          trifrm1.delete(0,'end')
          trifrm1.insert(0, start)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          trifrm1.delete(0,'end')
          trifrm1.insert(0, start)

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          trito1.delete(0,'end')
          trito1.insert(0, end)
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          trito1.delete(0,'end')
          trito1.insert(0, nxt_mnth)
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))
              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
          given_date = date.today()
          trifrm1.delete(0,'end')
          trifrm1.insert(0,given_date)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
            
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))


              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')



          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)


      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))
              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          trifrm1.delete(0,'end')
          trifrm1.insert(0, in_dat)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
          trifrm1.delete(0,'end')
          trifrm1.insert(0, last_year)

          cr=date.today()
          trito1.delete(0,'end')
          trito1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)
      elif rth=="Custom Range":
          mlk=trifrm1.get_date()
          mlk1=trito1.get_date()
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=mlk
              var2=mlk1
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr= fbcursor.fetchone()

              
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','',tot_bfr,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=rep_tri_tree)

          canvas.create_text(875,100,text="Tax Report(Invoice)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trifrm.get()+"      Date To:"+trito.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tri())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tri())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas11())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tri())
          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass
      drf=canvas
  #-------------------------------------------------tax report order-----------------------------------------
  def category_tro():
    # firtst filter-----------------------------------Month to date
      

      # #for company details
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=trofilter.get()
      if rth=="Month to date":

          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass

                  
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          trofrm1.delete(0,'end')
          trofrm1.insert(0, start)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          
              
              

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
          
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          trofrm1.delete(0,'end')
          trofrm1.insert(0, start)

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          troto1.delete(0,'end')
          troto1.insert(0, end)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          troto1.delete(0,'end')
          troto1.insert(0, nxt_mnth)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
          given_date = date.today()
          trofrm1.delete(0,'end')
          trofrm1.insert(0,given_date)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the  headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))


              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)


      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          trofrm1.delete(0,'end')
          trofrm1.insert(0, in_dat)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))
              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
          trofrm1.delete(0,'end')
          trofrm1.insert(0, last_year)

          cr=date.today()
          troto1.delete(0,'end')
          troto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)
      elif rth=="Custom Range":
          cft=trofrm1.get_date()
          cft1=troto1.get_date()
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(365,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tro_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Order No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0
              var1=cft
              var2=cft1
              sql_inv_dt='SELECT * FROM orders WHERE order_date BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:

                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+str(i[28]), crc+str(i[14]), crc+str(i[29]),crc+str(i[8])))
                      
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+crc, str(i[14])+crc, str(i[29])+crc,str(i[8])+crc))
                      
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], crc+" "+str(i[28]), crc+" "+str(i[14]), crc+" "+str(i[29]),crc+" "+str(i[8])))
                    
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[1], i[2], str(i[28])+" "+crc, str(i[14])+" "+crc, str(i[29])+" "+crc,str(i[8])+" "+crc))
                      
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(Order_total) from orders'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(tax1) from orders'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(tax2) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_tri= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(totalbeforetax) from orders'
              # fbcursor.execute(total_tax2_tri)
              # tot_bfr_tri= fbcursor.fetchone()
              
              # rep_tro_tree.insert('', 'end',text="1",values=('','-End of list-','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              # rep_tro_tree.insert('', 'end',text="1",values=('','','Summary:',tot_bfr_tri,tot_tax1_tri,tot_tax2_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rep_tro_tree)

              
              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Order No")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Total Before TAX")
              tree.column("# 5", anchor=E, stretch=NO, width=90)
              tree.heading("# 5", text="TAX1")
              tree.column("# 6", anchor=E, stretch=NO, width=90)
              tree.heading("# 6", text="TAX2")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Order Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Order Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(880,100,text="Tax Report(Orders)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+trofrm.get()+"      Date To:"+troto.get()+"\n Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_tro())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_tro())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas12())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_tro())
          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass
  #-------------------------------------------------Sales report group by date------------------------------------------
  def category_srgd():
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]

      irt1=srgd_frm.get_date()
      irt2=srgd_to.get_date()
      rth=srgdfilter.get()
      if rth==rth:
          lkt=srgdfilter.get()
          lkts=srgdfilter.get()
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
              
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=120)
              tree.heading("# 1", text="Date")
              tree.column("# 2", anchor=E, stretch=NO, width=145)
              tree.heading("# 2", text="Quantity")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Cost")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Income")
              tree.column("# 5", anchor=E, stretch=NO, width=150)
              tree.heading("# 5", text="Profit")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','',''))
              
              for record in tree.get_children():
                  tree.delete(record)
              count=0

              var_1=irt1
              var_2=irt2
              sql_inv='SELECT * FROM productservice Where name=%s'
              # inv_valuz=(var1,var2)
              
              inv=(lkts,)
              fbcursor.execute(sql_inv, inv)
              tre=fbcursor.fetchall()
              

              sel_inv_dt1='SELECT * FROM invoice Where invodate between %s and %s and Productserviceid=(SELECT Productserviceid from productservice Where name=%s)'
              inv_valuz=(var_1, var_2,lkt)
              fbcursor.execute(sel_inv_dt1, inv_valuz)
              tre1=fbcursor.fetchall()

              
              
              for i in tre1:
                  for j in tre:
                      y=int(j[9])*int(i[38])
                      r=i[8]
                      l=r-y
                      if ps_cr=="before amount":
                            tree.insert(parent='', index='end', text='hello',values=(i[2],i[38],crc+str(int(j[9])*int(i[38])),crc+str(i[8]),crc+str(l)))
                            
                            
                      elif ps_cr=="after amount":
                            tree.insert(parent='', index='end', text='hello',values=(i[2],i[38],str(int(j[9])*int(i[38]))+crc,str(i[8])+crc,str(l)+crc))
                            
                            
                      elif ps_cr=="before amount with space":
                            tree.insert(parent='', index='end', text='hello',values=(i[2],i[38],crc+" "+str(int(j[9])*int(i[38])),crc+" "+str(i[8]),crc+" "+str(l)))
                            
                            
                      elif ps_cr=="after amount with space":
                            tree.insert(parent='', index='end', text='hello',values=(i[2],i[38],str(int(j[9])*int(i[38]))+" "+crc,str(i[8])+" "+crc,str(l)+" "+crc))
                            
                      else:
                            pass
                            # tree.insert(parent='', index='end', text='hello',values=(i[2],i[38],int(j[9])*int(i[38]),i[8],l))
                      count += 1


                  count +=1


              window = canvas.create_window(270, 260, anchor="nw", window=tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Terms")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Invoice Paid")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(850,100,text="Sales Report(Group By Daste)",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+srgdfrm.get()+"      Date To:"+srgdto.get()+"\nOrder Category: All",fill='black',font=("Helvetica", 8), justify='right')
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_srgd())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_srgd())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas13())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_srgd())
          canvas.bind("<Button-3>", my_popup)

      else:
          pass

  #----------------------------------------invoice report detail------------------------------------------------------
  def category_ird():
    # firtst filter-----------------------------------Month to date
      
      ird1=irdfrm1.get_date()
      ird2=irdfrm2.get_date()
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=irdfilter.get()
      if rth=="All":

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_ird_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rep_ird_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 1", text="Invoice No")
              rep_ird_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 2", text="Date")
              rep_ird_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rep_ird_tree.heading("# 3", text="Customer")
              rep_ird_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rep_ird_tree.heading("# 4", text="Invoice Total")
              rep_ird_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rep_ird_tree.heading("# 5", text="Paid")
              rep_ird_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 6", text="Balance")
              # Insert the data in Treeview widget
              for record in rep_ird_tree.get_children():
                  rep_ird_tree.delete(record)
              count=0

              var_1=ird1
              var_2=ird2
              
              sql_inv_dt='SELECT * from invoice where invodate between %s and %s'
              inv_valuz=(var_1,var_2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              rep_ird_tree.insert('', 'end',text="1",values=('','','','Invoice Total','Paid','Balance'))
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], crc+str(i[8]), crc+str(i[9]), crc+str(i[10])))
                  elif ps_cr=="after amount":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], str(i[8])+crc, str(i[9])+crc, str(i[10])+crc))
  
                  elif ps_cr=="before amount with space":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], crc+" "+str(i[8]), crc+" "+str(i[9]), crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], str(i[8])+" "+crc, str(i[9])+" "+crc, str(i[10])+" "+crc))
 
                  else:
                      pass
                #   rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], i[8], i[9], i[10]))
                  count += 1

              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_ird= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_ird= fbcursor.fetchone()
              
              # rep_ird_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2'))

              # rep_ird_tree.insert('', 'end',text="1",values=('','','Summary:',tot_ird,tot_tax1_ird,tot_tax2_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rep_ird_tree)

              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Invoice Total")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Paid")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Invoice Total','Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+irdfrm.get()+"      Date To:"+irdto.get()+"\n Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_ird())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_ird())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas14())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_ird())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
  #-----------------------------------daily invoice report
  def category_dir():
          tro_company = "SELECT * from company"
          fbcursor.execute(tro_company)
          company_tro= fbcursor.fetchone()
          
          ddr=dir_frm.get_date()

          ddr2=date.today()
          rth=invfilter.get()
          sqlr= 'select currencysign from company'
          fbcursor.execute(sqlr)
          crncy=fbcursor.fetchone()
          global crc
          crc=crncy[0]
          sqlrt= 'select currsignplace from company'
          fbcursor.execute(sqlrt)
          post_rp=fbcursor.fetchone()
          global ps_cr
          ps_cr=post_rp[0]
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_ird_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rep_ird_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 1", text="Invoice No")
              rep_ird_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 2", text="Date")
              rep_ird_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rep_ird_tree.heading("# 3", text="Customer")
              rep_ird_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rep_ird_tree.heading("# 4", text="Invoice Total")
              rep_ird_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rep_ird_tree.heading("# 5", text="Paid")
              rep_ird_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rep_ird_tree.heading("# 6", text="Balance")
              # Insert the data in Treeview widget
              for record in rep_ird_tree.get_children():
                  rep_ird_tree.delete(record)
              count=0
              rep_ird_tree.insert('', 'end',text="1",values=('','','','Invoice Total','Paid','Balance'))
              
              sql_inv_dt='SELECT * FROM invoice WHERE invodate=%s'
          
              inv_valuz=(ddr,)
              
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              

              for i in tre:
                  if ps_cr=="before amount":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], crc+str(i[8]), crc+str(i[9]), crc+str(i[10])))
                  elif ps_cr=="after amount":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], str(i[8])+crc, str(i[9])+crc, str(i[10])+crc))
  
                  elif ps_cr=="before amount with space":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], crc+" "+str(i[8]), crc+" "+str(i[9]), crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], str(i[8])+" "+crc, str(i[9])+" "+crc, str(i[10])+" "+crc))
 
                  else:
                      pass
                #   rep_ird_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[29], i[8], i[9], i[10]))
                  count += 1
              # total_tri='SELECT SUM(invoicetot) from invoice'
              # fbcursor.execute(total_tri)
              # tot_ird= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_ird= fbcursor.fetchone()

              # total_tax2_tri='SELECT SUM(balance) from invoice'
              # fbcursor.execute(total_tax2_tri)
              # tot_tax2_ird= fbcursor.fetchone()
              
              # rep_ird_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2'))

              # rep_ird_tree.insert('', 'end',text="1",values=('','','Summary:',tot_ird,tot_tax1_ird,tot_tax2_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rep_ird_tree)
          
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Invoice Total")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Paid")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','Invoice Total','Paid','Balance'))


              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvas.create_text(880,100,text="Daily Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(935,145,text="Date:"+dirdate.get(),fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_dir())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_dir())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas15())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_dir())
          canvas.bind("<Button-3>", my_popup)


  #----------------------------------------------Purchase Order Report-------------------------------------

  def category_por():   
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      or_company = "SELECT * from company"
      fbcursor.execute(or_company)
      company_or= fbcursor.fetchone()
      global drf
      ddr2=date.today()
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=porfilter.get()
      if rth=="Month to date":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)
          
          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          global canvaspor
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
          
                #   rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], i[10]))
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

         

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)


      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          porfrm1.delete(0,'end')
          porfrm1.insert(0, start)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=90)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          porfrm1.delete(0,'end')
          porfrm1.insert(0, start)

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          porto1.delete(0,'end')
          porto1.insert(0, end)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))


              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:

              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          porto1.delete(0,'end')
          porto1.insert(0, nxt_mnth)
          
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
          given_date = date.today()
          porfrm1.delete(0,'end')
          porfrm1.insert(0,given_date)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))


              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))
              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:

              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
      #========================================================================================================
      
      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))
              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

          
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          porfrm1.delete(0,'end')
          porfrm1.insert(0, in_dat)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
          porfrm1.delete(0,'end')
          porfrm1.insert(0, last_year)

          cr=date.today()
          porto1.delete(0,'end')
          porto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvaspor.create_text(359,228,text="Sales tax reg No:"+company_or[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)
      # ------------------------------
      elif rth=="Custom Range":
          lhy=porfrm1.get_date()
          lhy1=porto1.get_date()
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvaspor=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvaspor
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvaspor.yview)
          canvaspor.config(width=1310,height=600)

          canvaspor.config(
              yscrollcommand=vertibar.set
              )
          canvaspor.pack(expand=True,side=LEFT,fill=BOTH)
          canvaspor.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_or is not None:
              labelcmp=Label(canvaspor,text=company_or[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvaspor.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvaspor,text=company_or[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvaspor.create_window(285,120, anchor="nw", window=labelcmpl)
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=lhy
              var2=lhy1
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)


          else:
              canvaspor.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvaspor.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
              canvaspor.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

          canvaspor.create_text(870,100,text="Purchase Order Report",fill='black',font=("Helvetica", 16), justify='right')
          canvaspor.create_text(880,145,text="Date From:"+porfrm.get()+"      Date To:"+porto.get()+"\n Purchase Order Category: All",fill='black',font=("Helvetica", 8), justify='right')

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvaspor, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_por())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_por())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas16())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_por())
          canvaspor.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass
  #------------------------------------expense report--------------------
  def category_exp():
      
    # firtst filter-----------------------------------Month to date
      
      
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      ddr2=date.today()
      rth=invfilter.get()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      
      # given_date = datetime.today().date()
      # in_dat = given_date.replace(day=1)
      # exp_frm.delete(0,'end')
      # exp_frm.insert(0, in_dat)

      # cr=date.today()
      # exp_to.delete(0,'end')
      # exp_to.insert(0, cr)

      global drf
      rth=expfilter.get()
      if rth=="All":
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_exp_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_exp_tree.heading("# 1", text="Date")
              rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
              rp_exp_tree.heading("# 2", text="Customer")
              rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
              rp_exp_tree.heading("# 3", text="Vendor")
              rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_exp_tree.heading("# 4", text="Invoice")
              rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_exp_tree.heading("# 5", text="Rebill.Amount")
              rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_exp_tree.heading("# 6", text="Amount")
              # Insert the data in Treeview widget
              rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
              
              for record in rp_exp_tree.get_children():
                  rp_exp_tree.delete(record)
              count=0
              var_1=exp_frm.get_date()
              var_2=exp_to.get_date()

              lre='SELECT * from expenses WHERE date BETWEEN %s and %s '
              sre=(var_1, var_2)
              fbcursor.execute(lre,sre)
              tre=fbcursor.fetchall()

              for i in tre:
                #   if ps_cr=="before amount":
                #       rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                      
                     
                #   elif ps_cr=="after amount":
                #       rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                      
                     
                #   elif ps_cr=="before amount with space":
                #       rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                      
                #   elif ps_cr=="after amount with space":
                #       rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                   
                #   else:
                #       pass
 
                  rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], i[16], i[3]))
                  count += 1

              # total_tri='SELECT SUM(expense_amount) from expenses'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(rebill_amount) from expenses'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              
              # rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
              # rp_exp_tree.insert('', 'end',text="1",values=('','','','Summary',tot_tax1_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_exp_tree)

              
              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Date")
              tree.column("# 2", anchor=E, stretch=NO, width=150)
              tree.heading("# 2", text="Customer")
              tree.column("# 3", anchor=E, stretch=NO, width=120)
              tree.heading("# 3", text="Vendor")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Invoice")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Rebill.Amount")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="Amount")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Expenses Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+expfrm.get()+"      Date To:"+expto.get()+"\n Expense Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_exp())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas17())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_exp())
          canvas.bind("<Button-3>", my_popup)

      elif rth=="Internal":

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_exp_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_exp_tree.heading("# 1", text="Date")
              rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
              rp_exp_tree.heading("# 2", text="Customer")
              rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
              rp_exp_tree.heading("# 3", text="Vendor")
              rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_exp_tree.heading("# 4", text="Invoice")
              rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_exp_tree.heading("# 5", text="Rebill.Amount")
              rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_exp_tree.heading("# 6", text="Amount")
              # Insert the data in Treeview widget
              rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
              
              for record in rp_exp_tree.get_children():
                  rp_exp_tree.delete(record)
              count=0
              var_1=exp_frm.get_date()
              var_2=exp_to.get_date()

              lre='SELECT * from expenses WHERE date BETWEEN %s and %s and customer="Internal" '
              sre=(var_1, var_2)
              fbcursor.execute(lre,sre)
              tre=fbcursor.fetchall()


              for i in tre:
                  if ps_cr=="before amount":
                      rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                      
                     
                  elif ps_cr=="after amount":
                      rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                      
                     
                  elif ps_cr=="before amount with space":
                      rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                      
                  elif ps_cr=="after amount with space":
                      rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                   
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(expense_amount) from expenses WHERE customer="Internal" '
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              

              # total_tax1_tri='SELECT SUM(rebill_amount) from expenses WHERE customer="Internal"'
              # fbcursor.execute(total_tax1_tri)
              # tot_tax1_tri= fbcursor.fetchone()

              
              # rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
              # rp_exp_tree.insert('', 'end',text="1",values=('','','','Summary',tot_tax1_tri,tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_exp_tree)

              
              
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Date")
              tree.column("# 2", anchor=E, stretch=NO, width=150)
              tree.heading("# 2", text="Customer")
              tree.column("# 3", anchor=E, stretch=NO, width=120)
              tree.heading("# 3", text="Vendor")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Invoice")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Rebill.Amount")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="Amount")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvas.create_text(900,100,text="Expenses Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+expfrm.get()+"      Date To:"+expto.get()+"\n Expense Category: All",fill='black',font=("Helvetica", 8), justify='right')

          

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_exp())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_exp())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas17())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_exp())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
      
  #------------------------------payment report------------------------
  def category_pyr():
    # firtst filter-----------------------------------Month to date
      
      tri_company = "SELECT * from company"
      fbcursor.execute(tri_company)
      company_tri= fbcursor.fetchone()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      global drf
      rth=pyrfilter.get()
      if rth=="Month to date":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)


          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                #   rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],i[9]))
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(260, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Year To Date":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, start)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=start
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="Current year":
          test_date=pendulum.today().date()
          start = test_date.start_of('year')
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, start)

          test_date_end=pendulum.today().date()
          end = test_date_end.end_of('year')
          pyrto1.delete(0,'end')
          pyrto1.insert(0, end)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=start
              var2=end
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Current month":
          given_date = datetime.today().date()
          in_dat = given_date.replace(day=1)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          test_date=date.today()
          nxt_mnth=(test_date+relativedelta(day=31))
          pyrto1.delete(0,'end')
          pyrto1.insert(0, nxt_mnth)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=nxt_mnth
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)

          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
          #=====================================================================================================
      elif rth=="Current days":
          given_date = date.today()
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0,given_date)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=given_date
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

          
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
          #=================================================================================================
      elif rth=="Last 30 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=30)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
      
      #=====================================================================================================
      elif rth=="Last 60 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=60)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
              
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          
              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
    

      #================================================================================================================
      elif rth=="Last 90 days":
          date_filter=date.today()
          in_dat=date_filter-timedelta(days=90)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
          #====================================================================================================
      elif rth=="Previous month":
          last_day_of_prev_month=date.today().replace(day=1)- timedelta(days=1)
          in_dat=date.today().replace(day=1)-timedelta(last_day_of_prev_month.day)
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, in_dat)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
          #===========================================================================================================
      elif rth=="Previous year":
          last_year = (datetime.now()-relativedelta(years=1)).strftime("%Y-%m-%d")
          pyrfrm1.delete(0,'end')
          pyrfrm1.insert(0, last_year)

          cr=date.today()
          pyrto1.delete(0,'end')
          pyrto1.insert(0, cr)

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=last_year
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
          
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)
      # ------------------------------
      elif rth=="Custom Range":
          ltr=pyrfrm1.get_date()
          ltr1=pyrto1.get_date()
          
          

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tri is not None:
              labelcmp=Label(canvas,text=company_tri[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tri[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tri[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rp_pr_tree.column("# 1", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 1", text="Invoice No")
              rp_pr_tree.column("# 2", anchor=E, stretch=NO, width=140)
              rp_pr_tree.heading("# 2", text="Invoice Issue Date")
              rp_pr_tree.column("# 3", anchor=E, stretch=NO, width=130)
              rp_pr_tree.heading("# 3", text="Customer")
              rp_pr_tree.column("# 4", anchor=E, stretch=NO, width=90)
              rp_pr_tree.heading("# 4", text="Payment ID")
              rp_pr_tree.column("# 5", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 5", text="Payment Date")
              rp_pr_tree.column("# 6", anchor=E, stretch=NO, width=80)
              rp_pr_tree.heading("# 6", text="Paid By")
              rp_pr_tree.column("# 7", anchor=E, stretch=NO, width=110)
              rp_pr_tree.heading("# 7", text="Amount Paid")
              rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',''))
              for record in rp_pr_tree.get_children():
                  rp_pr_tree.delete(record)
              count=0
              var1=ltr
              var2=ltr1
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
              
                  if ps_cr=="before amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+str(i[9])))

                  elif ps_cr=="after amount":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],crc+" "+str(i[9])))

                  elif ps_cr=="after amount with space":
                      rp_pr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[18], i[34], i[2], i[18],str(i[9])+" "+crc))
 
                  else:
                      pass
                  count += 1

              # total_tri='SELECT SUM(totpaid) from invoice'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              # rp_pr_tree.insert('', 'end',text="1",values=('','','','','','',tot_tri))

              window = canvas.create_window(270, 260, anchor="nw", window=rp_pr_tree)
          else:
          
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=140)
              tree.heading("# 2", text="Invoice Issue Date")
              tree.column("# 3", anchor=E, stretch=NO, width=130)
              tree.heading("# 3", text="Customer")
              tree.column("# 4", anchor=E, stretch=NO, width=90)
              tree.heading("# 4", text="Payment ID")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Payment Date")
              tree.column("# 6", anchor=E, stretch=NO, width=80)
              tree.heading("# 6", text="Paid By")
              tree.column("# 7", anchor=E, stretch=NO, width=110)
              tree.heading("# 7", text="Amount Paid")
      
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','',''))
              window = canvas.create_window(290, 260, anchor="nw", window=tree)
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
          
          canvas.create_text(900,100,text="Payment Report",fill='black',font=("Helvetica", 16), justify='right')
          canvas.create_text(875,145,text="Date From:"+pyrfrm.get()+"      Date To:"+pyrto.get(),fill='black',font=("Helvetica", 8), justify='right')

          

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pyr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pym())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas18())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pym())
          canvas.bind("<Button-3>", my_popup)

          #============================================================================================
      else:
          pass

  #Recurring Invoice----------------------------------------------
  def category_rir():
          tro_company = "SELECT * from company"
          fbcursor.execute(tro_company)
          company_tro= fbcursor.fetchone()
          sqlr= 'select currencysign from company'
          fbcursor.execute(sqlr)
          crncy=fbcursor.fetchone()
          global crc
          crc=crncy[0]
          sqlrt= 'select currsignplace from company'
          fbcursor.execute(sqlrt)
          post_rp=fbcursor.fetchone()
          global ps_cr
          ps_cr=post_rp[0]
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company_tro[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company_tro[4],fill='black',font=("Helvetica", 8), justify='left')
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_rir_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_rir_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_rir_tree.heading("# 1", text="Invoice No")
              rp_rir_tree.column("# 2", anchor=E, stretch=NO, width=130)
              rp_rir_tree.heading("# 2", text="Customer")
              rp_rir_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rp_rir_tree.heading("# 3", text="Next Invoice")
              rp_rir_tree.column("# 4", anchor=E, stretch=NO, width=140)
              rp_rir_tree.heading("# 4", text="Recurring Interval")
              rp_rir_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_rir_tree.heading("# 5", text="Stop After")
              rp_rir_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_rir_tree.heading("# 6", text="Invoice Total")
              # Insert the data in Treeview widget
              rp_rir_tree.insert('', 'end',text="1",values=('','','','','','Total'))
              # Insert the data in Treeview widget
              for record in rp_rir_tree.get_children():
                  rp_rir_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from invoice')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_rir_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[18], i[26], i[24], i[27], crc+str(i[8])))

                  elif ps_cr=="after amount":
                      rp_rir_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[18], i[26], i[24], i[27], str(i[8])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_rir_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[18], i[26], i[24], i[27], crc+" "+str(i[8])))

                  elif ps_cr=="after amount with space":
                      rp_rir_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[18], i[26], i[24], i[27], str(i[8])+" "+crc))
 
                  else:
                      pass
                #   rp_rir_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[18], i[26], i[24], i[27], i[8]))
                  count += 1

              total_tri='SELECT SUM(invoicetot) from invoice'
              fbcursor.execute(total_tri)
              tot_ird= fbcursor.fetchone()
              
              
              rp_rir_tree.insert('', 'end',text="1",values=('','','','','','Total'))

              rp_rir_tree.insert('', 'end',text="1",values=('','','-End List-','','Total',tot_ird))
              
              window = canvas.create_window(270, 260, anchor="nw", window=rp_rir_tree)

              
          else:
                  
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')


              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="Invoice No")
              tree.column("# 2", anchor=E, stretch=NO, width=130)
              tree.heading("# 2", text="Customer")
              tree.column("# 3", anchor=E, stretch=NO, width=100)
              tree.heading("# 3", text="Next Invoice")
              tree.column("# 4", anchor=E, stretch=NO, width=140)
              tree.heading("# 4", text="Recurring Interval")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Stop After")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="Invoice Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Total'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(865,100,text="Recurring Invoice Report",fill='black',font=("Helvetica", 16), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_rir())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_rir())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas4())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_rir())
          canvas.bind("<Button-3>", my_popup)

  #-------------------------------------------------past due invoice------------------------------------------
  def category_pdi():
          sql_company = "SELECT * from company"
          fbcursor.execute(sql_company)
          company= fbcursor.fetchone()

          sqlr= 'select currencysign from company'
          fbcursor.execute(sqlr)
          crncy=fbcursor.fetchone()
          global crc
          crc=crncy[0]
          sqlrt= 'select currsignplace from company'
          fbcursor.execute(sqlrt)
          post_rp=fbcursor.fetchone()
          global ps_cr
          ps_cr=post_rp[0]
          global drf
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)

              labelcmpl=Label(canvas,text=company[2], bg="white",font=("Helvetica", 9),anchor="nw", width=50,justify=LEFT, height=6)
              windowl = canvas.create_window(285,120, anchor="nw", window=labelcmpl)
              lk=canvas.create_text(359,228,text="Sales tax reg No:"+company[4],fill='black',font=("Helvetica", 8), justify='left')

              # Add a Treeview widge
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                  
              rp_pdi_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_pdi_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_pdi_tree.heading("# 1", text="No")
              rp_pdi_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_pdi_tree.heading("# 2", text="Date")
              rp_pdi_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_pdi_tree.heading("# 3", text="Due Date")
              rp_pdi_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_pdi_tree.heading("# 4", text="Terms")
              rp_pdi_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_pdi_tree.heading("# 5", text="Status")
              rp_pdi_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_pdi_tree.heading("# 6", text="Invoice Total")
              rp_pdi_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_pdi_tree.heading("# 7", text="Invoice Paid")
              rp_pdi_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_pdi_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_pdi_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_pdi_tree.get_children():
                  rp_pdi_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * FROM invoice WHERE duedate>invodate')
              
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_pdi_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))

                  elif ps_cr=="after amount":
                      rp_pdi_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pdi_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_pdi_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
 
                  else:
                      pass
                  
                #   rp_pdi_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], i[8], i[9],i[10]))
                  count += 1

            #   total_tri='SELECT SUM(invoicetot) from invoice'
            #   fbcursor.execute(total_tri)
            #   tot_ird= fbcursor.fetchone()
              

            #   total_tax1_tri='SELECT SUM(totpaid) from invoice'
            #   fbcursor.execute(total_tax1_tri)
            #   tot_tax1_ird= fbcursor.fetchone()

            #   total_tax2_tri='SELECT SUM(balance) from invoice'
            #   fbcursor.execute(total_tax2_tri)
            #   tot_tax2_ird= fbcursor.fetchone()
              

            #   rp_pdi_tree.insert('', 'end',text="1",values=('','','','','',tot_ird,tot_tax1_ird,tot_tax2_ird))
              window = canvas.create_window(270, 260, anchor="nw", window=rp_pdi_tree)
          else:
              
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              canvas.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')
              canvas.create_text(930,145,text="Invoice Category: All",fill='black',font=("Helvetica", 8), justify='right')
              canvas.create_text(330,228,text="Sales tax reg No.",fill='black',font=("Helvetica", 8), justify='left')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6","c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=60)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=80)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Terms")
              tree.column("# 5", anchor=E, stretch=NO, width=110)
              tree.heading("# 5", text="Overdue Days")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Total Paid")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Total', '', ''))

              window = canvas.create_window(270, 260, anchor="nw", window=tree)
          canvas.create_text(865,100,text="Past Due Invoice Report",fill='black',font=("Helvetica", 16), justify='right')
          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_pdi())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_pdi())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas5())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_pdi())
          canvas.bind("<Button-3>", my_popup)
  #-----------------------Customer list --------------------------------------
  def category_cl():
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]

      global drf
      
      rth=clfilter.get()
      if rth=="All Customers ":

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(175,80, anchor="nw", window=labelcmp)          
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_cl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_cl_tree.heading("# 1", text="Customer Id")
              rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
              rp_cl_tree.heading("# 2", text="Category")
              rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
              rp_cl_tree.heading("# 3", text="Customer Businnes Name")
              rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
              rp_cl_tree.heading("# 4", text="Customer Person")
              rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
              rp_cl_tree.heading("# 5", text="Tel")
              rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
              rp_cl_tree.heading("# 6", text="Fax")
              # Insert the data in Treeview widget
              rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

              # Insert the data in Treeview widget
              for record in rp_cl_tree.get_children():
                  rp_cl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from customer')
              for i in fbcursor:
                  rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                  count += 1
              window = canvas.create_window(170, 150, anchor="nw",  window=rp_cl_tree)
          
          
          else:
              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
                  
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Customer Id")
              tree.column("# 2", anchor=E, stretch=NO, width=170)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=250)
              tree.heading("# 3", text="Customer Businnes Name")
              tree.column("# 4", anchor=E, stretch=NO, width=180)
              tree.heading("# 4", text="Customer Person")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Tel")
              tree.column("# 6", anchor=E, stretch=NO, width=130)
              tree.heading("# 6", text="Fax")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)
          canvas.create_text(1070,100,text="Customers List",fill='black',font=("Helvetica", 16), justify='right') 

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_cl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_cl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas6())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_cl())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Default":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)           
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_cl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_cl_tree.heading("# 1", text="Customer Id")
              rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
              rp_cl_tree.heading("# 2", text="Category")
              rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
              rp_cl_tree.heading("# 3", text="Customer Businnes Name")
              rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
              rp_cl_tree.heading("# 4", text="Customer Person")
              rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
              rp_cl_tree.heading("# 5", text="Tel")
              rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
              rp_cl_tree.heading("# 6", text="Fax")
              # Insert the data in Treeview widget
              rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

              # Insert the data in Treeview widget
              for record in rp_cl_tree.get_children():
                  rp_cl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from customer WHERE category="Default"')
              if fbcursor is not None:
                  for i in fbcursor:
                      rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                      count += 1
              else:
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


              window = canvas.create_window(170, 150, anchor="nw",  window=rp_cl_tree)
          
          
          else:
              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Customer Id")
              tree.column("# 2", anchor=E, stretch=NO, width=170)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=250)
              tree.heading("# 3", text="Customer Businnes Name")
              tree.column("# 4", anchor=E, stretch=NO, width=180)
              tree.heading("# 4", text="Customer Person")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Tel")
              tree.column("# 6", anchor=E, stretch=NO, width=130)
              tree.heading("# 6", text="Fax")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)
          canvas.create_text(1070,100,text="Customers List",fill='black',font=("Helvetica", 16), justify='right') 

          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_cl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_cl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas6())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_cl())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
      drf=canvas
  #-----------------------Customer list detailed--------------------------
  def category_cld():
    # firtst filter-----------------------------------Month to date
      
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()

      global drf
      rth=cldfilter.get()

      if rth=="All Customers ":
          # #for company details
          tro_company = "SELECT * from company"
          fbcursor.execute(tro_company)
          company_tro= fbcursor.fetchone()
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)           
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_cld_tree=ttk.Treeview(canvas, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
              rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
              rp_cld_tree.heading("# 1", text="")
              rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
              rp_cld_tree.heading("# 2", text="")
              
              # Insert the data in Treeview widget
              rp_cld_tree.insert('', 'end',text="1",values=('',''))

              # Insert the data in Treeview widget
              for record in rp_cld_tree.get_children():
                  rp_cld_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from customer')
              for i in fbcursor:
                  rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                  rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                  rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                  rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                  rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                  rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                  rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                  
                  count += 1
              window = canvas.create_window(290, 130, anchor="nw", window=rp_cld_tree)
          
          
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=345)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=345)
              tree.heading("# 2", text="Date")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('',''))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Customer List",fill='black',font=("Helvetica", 16), justify='right') 

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_cld())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_cld())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas7())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_cld())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="Default":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company is not None:
              labelcmp=Label(canvas,text=company[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)             
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_cld_tree=ttk.Treeview(canvas, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
              rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
              rp_cld_tree.heading("# 1", text="")
              rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
              rp_cld_tree.heading("# 2", text="")
              
              # Insert the data in Treeview widget
              rp_cld_tree.insert('', 'end',text="1",values=('',''))

              # Insert the data in Treeview widget
              for record in rp_cld_tree.get_children():
                  rp_cld_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from customer WHERE category="Default"')
              for i in fbcursor:
                  rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                  rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                  rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                  rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                  rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                  rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                  rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                  
                  count += 1
              window = canvas.create_window(290, 130, anchor="nw", window=rp_cld_tree)
          
          
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Terms")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Invoice Paid")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = canvas.create_window(290, 260, anchor="nw", window=tree)
          canvas.create_text(900,100,text="Customer List",fill='black',font=("Helvetica", 16), justify='right')
                    


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_cld())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_cld())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas7())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_cld())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
      
  #products/Service list--------------------------------------------------------------------------
  def category_psl():
    # firtst filter-----------------------------------Month to date
      
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      global drf
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=pslfilter.get()
      
      if rth=="All product and Services ":

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(175,80, anchor="nw", window=labelcmp)           
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_psl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 1", text="Product ID")
              rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
              rp_psl_tree.heading("# 2", text="Category")
              rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
              rp_psl_tree.heading("# 3", text="Product/ Service Name")
              rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_psl_tree.heading("# 4", text="Description")
              rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
              rp_psl_tree.heading("# 5", text="Warehouse")
              rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 6", text="Stock")
              rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 7", text="Cost")
              rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


              # Insert the data in Treeview widget
              for record in rp_psl_tree.get_children():
                  rp_psl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                  elif ps_cr=="after amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                  elif ps_cr=="after amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
 
                  else:
                      pass
                #   rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], i[9], i[11]))
                  count += 1
              window = canvas.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
          
          
          else:
              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=120)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=180)
              tree.heading("# 3", text="Product/ Service Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Description")
              tree.column("# 5", anchor=E, stretch=NO, width=150)
              tree.heading("# 5", text="Warehouse")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Stock")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Cost")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)
          canvas.create_text(1000,100,text="Products And Services Report",fill='black',font=("Helvetica", 16), justify='right') 

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_psl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_psl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas8())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_psl())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="All products":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(175,80, anchor="nw", window=labelcmp)             
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_psl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 1", text="Product ID")
              rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
              rp_psl_tree.heading("# 2", text="Category")
              rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
              rp_psl_tree.heading("# 3", text="Product/ Service Name")
              rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_psl_tree.heading("# 4", text="Description")
              rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
              rp_psl_tree.heading("# 5", text="Warehouse")
              rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 6", text="Stock")
              rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 7", text="Cost")
              rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


              # Insert the data in Treeview widget
              for record in rp_psl_tree.get_children():
                  rp_psl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="products" ')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                  elif ps_cr=="after amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                  elif ps_cr=="after amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
          
          
          else:

              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=120)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=180)
              tree.heading("# 3", text="Product/ Service Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Description")
              tree.column("# 5", anchor=E, stretch=NO, width=150)
              tree.heading("# 5", text="Warehouse")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Stock")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Cost")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)
          canvas.create_text(1000,100,text="Products And Services Report",fill='black',font=("Helvetica", 16), justify='right') 
              
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_psl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_psl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas8())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_psl())
          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="All Service":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(175,80, anchor="nw", window=labelcmp)             
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_psl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 1", text="Product ID")
              rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
              rp_psl_tree.heading("# 2", text="Category")
              rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
              rp_psl_tree.heading("# 3", text="Product/ Service Name")
              rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_psl_tree.heading("# 4", text="Description")
              rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
              rp_psl_tree.heading("# 5", text="Warehouse")
              rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 6", text="Stock")
              rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 7", text="Cost")
              rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


              # Insert the data in Treeview widget
              for record in rp_psl_tree.get_children():
                  rp_psl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="Service" ')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                  elif ps_cr=="after amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                  elif ps_cr=="after amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
          
          
          else:
                  
              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=120)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=180)
              tree.heading("# 3", text="Product/ Service Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Description")
              tree.column("# 5", anchor=E, stretch=NO, width=150)
              tree.heading("# 5", text="Warehouse")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Stock")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Cost")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)

          canvas.create_text(1000,100,text="Products And Services Report",fill='black',font=("Helvetica", 16), justify='right') 

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_psl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_psl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas8())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_psl())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Default":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )
          drf=canvas
          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(120,25,1200,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(175,80, anchor="nw", window=labelcmp)           
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_psl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 1", text="Product ID")
              rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
              rp_psl_tree.heading("# 2", text="Category")
              rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
              rp_psl_tree.heading("# 3", text="Product/ Service Name")
              rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_psl_tree.heading("# 4", text="Description")
              rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
              rp_psl_tree.heading("# 5", text="Warehouse")
              rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 6", text="Stock")
              rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 7", text="Cost")
              rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_psl_tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


              # Insert the data in Treeview widget
              for record in rp_psl_tree.get_children():
                  rp_psl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="Default"')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                  elif ps_cr=="after amount":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                  elif ps_cr=="after amount with space":
                      rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
          
          
          else:

              canvas.create_text(240,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
    
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=120)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=180)
              tree.heading("# 3", text="Product/ Service Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Description")
              tree.column("# 5", anchor=E, stretch=NO, width=150)
              tree.heading("# 5", text="Warehouse")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Stock")
              tree.column("# 7", anchor=E, stretch=NO, width=100)
              tree.heading("# 7", text="Cost")
              tree.column("# 8", anchor=E, stretch=NO, width=100)
              tree.heading("# 8", text="Price")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','','',''))

              window = canvas.create_window(170, 150, anchor="nw", window=tree)
          canvas.create_text(1000,100,text="Products And Services Report",fill='black',font=("Helvetica", 16), justify='right') 


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_psl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_psl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas8())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_psl())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
      
  #-------------------------------------------------prace list----------------------
  def category_prl():
    # firtst filter-----------------------------------Month to date
      
      # #for company details
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      global drf
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      rth=prlfilter.get()
      if rth=="All product and Services ":

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)           
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 1", text="Product ID")
              rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 2", text="Product/Service Name")
              rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 3", text="Description")
              rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


              # Insert the data in Treeview widget
              for record in rp_pl_tree.get_children():
                  rp_pl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                  elif ps_cr=="after amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                  elif ps_cr=="after amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
 
                  else:
                      pass
                 
                #   rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], i[7]))
                  count += 1
              window = canvas.create_window(280, 130, anchor="nw", window=rp_pl_tree)
          
          
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=150)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=200)
              tree.heading("# 2", text="Product/Service Name")
              tree.column("# 3", anchor=E, stretch=NO, width=200)
              tree.heading("# 3", text="Description")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','',''))

              window = canvas.create_window(280, 130, anchor="nw", window=tree)
          canvas.create_text(930,100,text="Price List",fill='black',font=("Helvetica", 16), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_prl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_prl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas9())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_prl())
          canvas.bind("<Button-3>", my_popup)

      #--------------------------------------------------------------------------------------------------------------
      elif rth=="All products":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)          
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 1", text="Product ID")
              rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 2", text="Product/Service Name")
              rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 3", text="Description")
              rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


              # Insert the data in Treeview widget
              for record in rp_pl_tree.get_children():
                  rp_pl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="Products"')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                  elif ps_cr=="after amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                  elif ps_cr=="after amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(280, 130, anchor="nw", window=rp_pl_tree)
          
          
          else:

              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')


              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=150)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=200)
              tree.heading("# 2", text="Product/Service Name")
              tree.column("# 3", anchor=E, stretch=NO, width=200)
              tree.heading("# 3", text="Description")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','',''))

              window = canvas.create_window(280, 130, anchor="nw", window=tree)
          canvas.create_text(930,100,text="Price List",fill='black',font=("Helvetica", 16), justify='right')


          
          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_prl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_prl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas9())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_prl())
          canvas.bind("<Button-3>", my_popup)
          #===============================================================================================
      elif rth=="All Service":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)        
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 1", text="Product ID")
              rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 2", text="Product/Service Name")
              rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 3", text="Description")
              rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


              # Insert the data in Treeview widget
              for record in rp_pl_tree.get_children():
                  rp_pl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="Service"')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                  elif ps_cr=="after amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                  elif ps_cr=="after amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(280, 130, anchor="nw", window=rp_pl_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=150)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=200)
              tree.heading("# 2", text="Product/Service Name")
              tree.column("# 3", anchor=E, stretch=NO, width=200)
              tree.heading("# 3", text="Description")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','',''))

              window = canvas.create_window(280, 130, anchor="nw", window=tree)

          canvas.create_text(930,100,text="Price List",fill='black',font=("Helvetica", 16), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_prl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_prl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas9())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_prl())
          canvas.bind("<Button-3>", my_popup)
      #==============================================================================================================
      elif rth=="Default":
          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp)         
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_pl_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 1", text="Product ID")
              rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 2", text="Product/Service Name")
              rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
              rp_pl_tree.heading("# 3", text="Description")
              rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_pl_tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


              # Insert the data in Treeview widget
              for record in rp_pl_tree.get_children():
                  rp_pl_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE category="Default"')
              for i in fbcursor:
                  if ps_cr=="before amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                  elif ps_cr=="after amount":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
  
                  elif ps_cr=="before amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                  elif ps_cr=="after amount with space":
                      rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
 
                  else:
                      pass
                  count += 1
              window = canvas.create_window(280, 130, anchor="nw", window=rp_pl_tree)
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=150)
              tree.heading("# 1", text="Product ID")
              tree.column("# 2", anchor=E, stretch=NO, width=200)
              tree.heading("# 2", text="Product/Service Name")
              tree.column("# 3", anchor=E, stretch=NO, width=200)
              tree.heading("# 3", text="Description")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Unit Price")
              
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','',''))

              window = canvas.create_window(280, 130, anchor="nw", window=tree)

          canvas.create_text(930,100,text="Price List",fill='black',font=("Helvetica", 16), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_prl())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_prl())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas9())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_prl())
          canvas.bind("<Button-3>", my_popup)
      else:
          pass
      drf=canvas

  #-------------------------product low stock report---------------------
  def category_plsr():
          tro_company = "SELECT * from company"
          fbcursor.execute(tro_company)
          company_tro= fbcursor.fetchone()

          global drf
          sqlr= 'select currencysign from company'
          fbcursor.execute(sqlr)
          crncy=fbcursor.fetchone()
          global crc
          crc=crncy[0]
          sqlrt= 'select currsignplace from company'
          fbcursor.execute(sqlrt)
          post_rp=fbcursor.fetchone()
          global ps_cr
          ps_cr=post_rp[0]

          frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
          frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
          frame.place(x=20,y=115)
          canvas=Canvas(
              frame,
              bg='grey',
              width=1400,
              height=1200,
              scrollregion=(0,0,1500, 1500)
              )

          vertibar=Scrollbar(
              frame,
              orient=VERTICAL
              )
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1310,height=600)

          canvas.config(
              yscrollcommand=vertibar.set
              )
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
          if company_tro is not None:
              labelcmp=Label(canvas,text=company_tro[1], bg="white",anchor="nw",font=("Helvetica", 12), width=40, height=2)
              window = canvas.create_window(285,80, anchor="nw", window=labelcmp) 
              
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_plsr_tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_plsr_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 1", text="Product Id")
              rp_plsr_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 2", text="Category")
              rp_plsr_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_plsr_tree.heading("# 3", text="Product Name")
              rp_plsr_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 4", text="Warehouse")
              rp_plsr_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 5", text="Low Stock Limit")
              rp_plsr_tree.column("# 6", anchor=E, stretch=NO, width=70)
              rp_plsr_tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              rp_plsr_tree.insert('', 'end',text="1",values=('','','','','',''))
              # Insert the data in Treeview widget
              for record in rp_plsr_tree.get_children():
                  rp_plsr_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE stock < stocklimit')
              for i in fbcursor:
                  rp_plsr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[15], i[14], i[13]))
                  count += 1
              
              window = canvas.create_window(290, 130, anchor="nw", window=rp_plsr_tree)

              
          else:
              canvas.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')
              # Create an instance of Style widget
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product Id")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Product Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Warehouse")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Low Stock Limit")
              tree.column("# 6", anchor=E, stretch=NO, width=70)
              tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = canvas.create_window(290, 130, anchor="nw", window=tree)
          canvas.create_text(840,100,text="Product Low Stock Report",fill='black',font=("Helvetica", 16), justify='right')

          def my_popup(event):
              my_menu.tk_popup(event.x_root, event.y_root)
          my_menu= Menu(canvas, tearoff=False)
          my_menu.add_command(label="Run Report", command=lambda:category_plsr())
          my_menu.add_separator()
          my_menu.add_command(label="Print Report", command=lambda:pr_exp_plsr())
          my_menu.add_command(label="Email Report", command=lambda:rp_addemail_order())

          my_menu.add_separator()
          my_menu.add_command(label="Export Report To Excel", command=lambda:exportcanvas10())
          my_menu.add_command(label="Export Report To PDF", command=lambda:pdf_exp_plsr())
          canvas.bind("<Button-3>", my_popup)
          drf=canvas
  ######################################################################################################################


  canvas=StringVar()
  scrfilter=StringVar()
  scrfrm=StringVar()
  scrto=StringVar()
  #it is for invoice report
  invfilter = StringVar()# veriable for store category filter
  invfrm=StringVar()
  invto=StringVar()

  #it is for invoice report(With cust)
  irwcfilter = StringVar()
  irwcfrm=StringVar()
  irwcto=StringVar()

  #it is for Order report
  orfilter = StringVar()
  orfrm=StringVar()
  orto=StringVar()

  #Tax report Invoice
  trifilter = StringVar()
  trifrm=StringVar()
  trito=StringVar()

  #Tax report order
  trofilter = StringVar()
  trofrm=StringVar()
  troto=StringVar()

  #Tax report order
  srgdfilter = StringVar()
  srgdfrm=StringVar()
  srgdto=StringVar()

  #invoice report by date
  irdfilter = StringVar()
  irdfrm=StringVar()
  irdto=StringVar()

  #daily invoice report by date

  dirdate=StringVar()

  #purchase order report 
  porfilter = StringVar()
  porfrm=StringVar()
  porto=StringVar()

  #expense report
  expfilter = StringVar()
  expfrm=StringVar()
  expto=StringVar()

  #payment report
  pyrfilter = StringVar()
  pyrfrm=StringVar()
  pyrto=StringVar()
  #customer list
  clfilter = StringVar()
  #customer list Detaild
  cldfilter = StringVar()

  #Purchase/ service list
  pslfilter = StringVar()

  #price list
  prlfilter = StringVar()

  #function For chkbox     
  checkvar1 = BooleanVar()
  checkvar2 = BooleanVar()
  checkvar3 = BooleanVar()

  rpcheckvar1_ir = BooleanVar()
  rpcheckvar2_ir = BooleanVar()
  rpcheckvar3_ir = BooleanVar()

  rpcheckvar1_irwc = BooleanVar()
  rpcheckvar2_irwc = BooleanVar()
  rpcheckvar3_irwc = BooleanVar()

  rpcheckvar1_tri = BooleanVar()
  rpcheckvar2_tri = BooleanVar()
  rpcheckvar3_tri = BooleanVar()


  rpcheckvar1_plr = BooleanVar()
  rpcheckvar2_plr = BooleanVar()


  rpcheckvar1_psl = BooleanVar()
  rpcheckvar2_psl = BooleanVar()


  rpcheckvar1_pl = BooleanVar()
  rpcheckvar2_pl = BooleanVar()


  rpcheckvar1_por= BooleanVar()
  rpcheckvar2_por= BooleanVar()

  rpcheckvar1_exp= BooleanVar()
  rpcheckvar2_exp= BooleanVar()

  rpcheckvar1_cl= BooleanVar()
  rpcheckvar2_cl= BooleanVar()

  rpcheckvar1_cld= BooleanVar()
  rpcheckvar2_cld= BooleanVar()


  #####################################(Drop down Function)##################################################
  def maindropmenu(event):
    menuvar=menu1.get()
    if menuvar== "Screen Charts":
          rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55, command=lambda:screen_flt())
          rprefreshlebel.place(x=22,y=12)


          rpprintlabel = Button(midFrame,compound="top", text="Print Chart",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:image_print())
          rpprintlabel.place(x=95,y=12)
      


          rpsaveLabel = Button(midFrame,compound="top", text="Save Chart\nimage",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:image())
          rpsaveLabel.place(x=168,y=12)

          rpcopyLabel = Button(midFrame,compound="top", text="Copy Chart\n to Clipboard",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command="convert")
          rpcopyLabel.place(x=240,y=12)
          
          iruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
          iruw1.place(x=415,y=9)
          iruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
          iruw2.place(x=530,y=9)

          global rp_scr_frm
          global rp_sc_to


          lbl_ir =Label(midFrame, text="From:" , bg="#f8f8f2")
          lbl_ir.place(x=676,y=10)

          exir=DateEntry(midFrame,textvariable=scrfrm, date_pattern='y-mm-dd')
          exir.place(x=721,y=10)

          lbl_ir =Label(midFrame, text="To:", bg="#f8f8f2")
          lbl_ir.place(x=690,y=50)

          exir=DateEntry(midFrame,textvariable=scrto, date_pattern='y-mm-dd')
          exir.place(x=721,y=50)

          lbl_ir = Label(midFrame, text="Category:", bg="#f8f8f2")
          lbl_ir.place(x=470,y=10)

          menuir = StringVar()
          drop1ir=ttk.Combobox(midFrame, textvariable=menuir)
          drop1ir.place(x=530,y=10)
          drop1ir["values"]=("Java","Php", "POP")
          drop1ir.current(0)

          
          drop2=ttk.Combobox(midFrame, textvariable=scrfilter)
          drop2.place(x=530,y=50)
          drop2["values"]=("Year To Date","Current year","Last 3 Month","Last 6 Month", "Last 12 Month", "Last 18 Month", "Last 24 Month","Previous Year", "Before Previous Year", "Custom Range" )
          drop2.current(0)



          #--------------------------------check box-------------------------------------
          

          # checkvar1 = BooleanVar()
          rp_1_chkbtn1 = Checkbutton(midFrame, text = "Invoice", variable = checkvar1, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:chek_function())
          rp_1_chkbtn1.place(x=815,y=2)
          rp_1_chkbtn1.select()

          # checkvar2 = BooleanVar()
          rp_2_chkbtn2 = Checkbutton(midFrame, text = "Outstanding", variable = checkvar2, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:chek_function())
          rp_2_chkbtn2.place(x=830,y=40)
          rp_2_chkbtn2.select()

          # checkvar3 = BooleanVar()
          rp_3_chkbtn3 = Checkbutton(midFrame, text = "Paid", variable = checkvar3, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:chek_function())
          rp_3_chkbtn3.place(x=883,y=2)
          rp_3_chkbtn3.select()

          mainchartframe2 =Frame(reportframe,height=1500, width=200)
          mainchartframe2.pack(side="top", padx=0, pady=0)

          irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
          irwcuw1.place(x=2,y=90)


          lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
          lbl_invdtt2.place(x=2, y=87)
          irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
          irwcuw1.place(x=1135, y=97)
          lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
          lbl_invdtt2.place(x=1140, y=97)

          ######################################################################################################################


          #########################################(Graph Section)#############################################################
          sql_paid = "SELECT SUM(invoicetot)from invoice"
          fbcursor.execute(sql_paid)
          invoice= fbcursor.fetchone()

          x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
          fbcursor.execute(x_axis)
          axis_x= fbcursor.fetchone()



          sql_company = "SELECT SUM(totpaid)from invoice"
          fbcursor.execute(sql_company)
          paid= fbcursor.fetchone()



          sql_outstanding = "SELECT SUM(balance)from invoice"
          fbcursor.execute(sql_outstanding)
          outstanding= fbcursor.fetchone()


          frame = Frame(
                  reportframe,
                  width=1380,
                  height=1000,
                  bg='#b3b3b3',
                  )
          frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
              
          frame.pack()


          x=datetime.today()

          y=invoice

          x=axis_x
          figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
          plt.bar(x,y, label="Invoice", color="orange")
          plt.legend()
          plt.xlabel("x-axis")
          plt.ylabel("y-label")
          axes=plt.gca()
          axes.yaxis.grid()

          # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




          #**************add dates********

          dates=axis_x[0]+timedelta(days=2)

          y=outstanding
          x=dates
          plt.bar(x,y, label="Outstanding", color="blue")
          plt.legend()
          plt.xlabel("x-axis")
          plt.ylabel("y-label")
          axes=plt.gca()
          axes.yaxis.grid()
          # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


          dates3=axis_x[0]-timedelta(days=2)
          y=paid
          x=dates3
          plt.bar(x,y, label="Paid", color="green") 
          plt.legend()
          plt.xlabel("x-axis")
          plt.ylabel("y-label")
          axes=plt.gca()
          axes.yaxis.grid()
          # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

          #used to display chart in our frame
          canvasbar = FigureCanvasTkAgg(figfirst, master=reportframe)
          canvasbar.draw()
          canvasbar.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

          #second graph

          sec_paid = "SELECT invoicetot from invoice  GROUP BY businessname ORDER by COUNT(businessname) DESC LIMIT 1"
          fbcursor.execute(sec_paid)
          paid_sec_x= fbcursor.fetchone()

          
          sec_paid_y = "SELECT businessname from invoice  GROUP BY businessname  ORDER by COUNT(businessname) DESC LIMIT 1"
          fbcursor.execute(sec_paid_y)

          paid_sec_y= fbcursor.fetchone()


          figsecond = plt.figure(figsize=(9, 4), dpi=80)

          x=paid_sec_y
          y=paid_sec_x
          plt.barh(x,y, label="Top Billed Customer", color="orange") 
          plt.legend()
          plt.xlabel("x-axis")
          plt.ylabel("y-label")
          axes=plt.gca()
          axes.xaxis.grid()


          canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
          canvasbar.draw()
          canvasbar.get_tk_widget().place(x=0, y=370)

          # #second graph

          thrd_paid = "SELECT invoicetot from invoice GROUP BY Productserviceid ORDER by COUNT(Productserviceid) DESC LIMIT 1"
          fbcursor.execute(thrd_paid)
          paid_thrd_x= fbcursor.fetchone()


          thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from invoice GROUP BY Productserviceid ORDER by COUNT(Productserviceid) DESC LIMIT 1)"

          fbcursor.execute(thrd_paid_y)

          paid_thrd_y= fbcursor.fetchone()

          figlast = plt.figure(figsize=(9, 4), dpi=80)

          x=paid_thrd_y
          y=paid_thrd_x   
          plt.barh(x,y, label="Top Product Sale", color="blue") 
          plt.legend()
          plt.xlabel("x-axis")
          plt.ylabel("y-label")
          axes=plt.gca()
          axes.xaxis.grid()
          

          canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
          canvasbar.draw()
          canvasbar.get_tk_widget().place(x=650, y=370)

          lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
          lbl_ir.place(x=1115,y=85)

          lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
          lbl_invdtt2.place(x=2, y=85)

    elif menuvar== "Invoice Report":
      #frame for display data to a a4 sheet

      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55, command=category)
      rprefreshlebel.place(x=22,y=12)

      
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)


      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp())
      rpprintlabel.place(x=95,y=12)
    


      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp())
      rpcopyLabel.place(x=240,y=12)
      
      iruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      iruw1.place(x=415,y=9)
      iruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      iruw2.place(x=530,y=9)
      lbl_ir =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_ir.place(x=676,y=10)

      global rp_exir
      rp_exir=DateEntry(midFrame, textvariable=invfrm,  )
      rp_exir.place(x=721,y=10)

      lbl_ir =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_ir.place(x=690,y=50)
      


      global rp_exir1
      rp_exir1=DateEntry(midFrame,textvariable=invto, )
      rp_exir1.place(x=721,y=50)

      sql='select dateformat from company'
      fbcursor.execute(sql)
      rp_date_for=fbcursor.fetchone()
      if not rp_date_for:
          pass
      else:
          if rp_date_for[0]=="mm-dd-yyyy":
              rp_exir.set_date(rp_exir._date.strftime('%m-%d-%Y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%m-%d-%Y'))
          elif rp_date_for[0]=="dd-mm-yyyy":
              rp_exir.set_date(rp_exir._date.strftime('%d-%m-%Y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%d-%m-%Y'))
        #   elif rp_date_for[0]=="yyyy.mm.dd":
        #       rp_exir.set_date(rp_exir._date.strftime('%Y.%m.%d'))
        #       rp_exir1.set_date(rp_exir1._date.strftime('%Y.%m.%d'))
          elif rp_date_for[0]=="mm/dd/yyyy":
              rp_exir.set_date(rp_exir._date.strftime('%m/%d/%y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%m/%d/%y'))
          elif rp_date_for[0]=="dd/mm/yyyy":
              rp_exir.set_date(rp_exir._date.strftime('%d/%m/%Y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%d/%m/%Y'))
          elif rp_date_for[0]=="dd.mm.yyyy":
              rp_exir.set_date(rp_exir._date.strftime('%d.%m.%Y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%d.%m.%Y'))
        #   elif rp_date_for[0]=="yyyy/mm/dd":
        #       rp_exir.set_date(rp_exir._date.strftime('%Y/%m/%d'))
        #       rp_exir1.set_date(rp_exir1._date.strftime('%Y/%m/%d'))
          else:
              rp_exir.set_date(rp_exir._date.strftime('%d-%m-%Y'))
              rp_exir1.set_date(rp_exir1._date.strftime('%d-%m-%Y'))
              



      lbl_ir = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_ir.place(x=470,y=10)

      menuir = StringVar()
      drop1ir=ttk.Combobox(midFrame, textvariable=menuir)
      drop1ir.place(x=530,y=10)
      drop1ir["values"]=("Java","Php", "POP")
      drop1ir.current(0)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)

      
      rpdrop2_ir=ttk.Combobox(midFrame, textvariable=invfilter)
      rpdrop2_ir["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_ir.place(x=530,y=50)
      rpdrop2_ir.current(0)



      #--------------------------------check box-------------------------------------
      
      rpchkbtn1_ir= Checkbutton(midFrame, text = "Paid", variable = rpcheckvar1_ir, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_inv())
      rpchkbtn1_ir.place(x=815,y=2)
      rpchkbtn1_ir.select()

      
      rpchkbtn1_ir = Checkbutton(midFrame, text = "Void", variable = rpcheckvar2_ir, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_inv())
      rpchkbtn1_ir.place(x=815,y=40)
      rpchkbtn1_ir.select()
      
      rpchkbtn1_ir= Checkbutton(midFrame, text = "Unpaid", variable = rpcheckvar3_ir, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_inv())
      rpchkbtn1_ir.place(x=883,y=2)
      rpchkbtn1_ir.select()
      
      mainchartframe2 =Frame(reportframe,height=1500, width=200)
      mainchartframe2.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1200,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1000,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      
      global id_inv1
      global id_inv2
      global id_inv
      
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      id_inv=canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')
      

      id_inv1=canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      id_inv2=canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

      # midFrame2=LabelFrame(frame, bg="red", width=100, height=60)
      # midFrame2.place(x=20, y=100)
      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Invoice Report(With Customer)":

      #frame for display data to a a4 sheet

      rprefreshlebel_cst = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_irwc)
      rprefreshlebel_cst.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel_cst = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_irwc())
      rpprintlabel_cst.place(x=95,y=12)
    
      rpsaveLabel_cst = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas2())
      rpsaveLabel_cst.place(x=168,y=12)

      rpcopyLabel_cst = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_irwc())
      rpcopyLabel_cst.place(x=240,y=12)

      irwcuw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      irwcuw1.place(x=415,y=9)
      irwcuw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      irwcuw2.place(x=530,y=9)
      lbl_irwc =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_irwc.place(x=676,y=10)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)

      global irwcfrm1
      irwcfrm1=DateEntry(midFrame, textvariable=irwcfrm,date_pattern='y-mm-dd')
      irwcfrm1.place(x=721,y=10)

      lbl_irwc =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_irwc.place(x=690,y=50)

      global irwcto1
      irwcto1=DateEntry(midFrame, textvariable=irwcto, date_pattern='y-mm-dd')
      irwcto1.place(x=721,y=50)

      lbl_irwc = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_irwc.place(x=470,y=10)

      menuirwc = StringVar()
      drop1irwc=ttk.Combobox(midFrame, textvariable=menuirwc)
      drop1irwc.place(x=530,y=10)
      drop1irwc["values"]=("Java","Php", "POP")
      drop1irwc.current(0)

      
      rpdrop2_irwc=ttk.Combobox(midFrame, textvariable=irwcfilter)
      rpdrop2_irwc["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_irwc.place(x=530,y=50)
      rpdrop2_irwc.current(0)



      #--------------------------------check box-------------------------------------
      
      rpchkbtn1_irwc= Checkbutton(midFrame, text = "Paid", variable = rpcheckvar1_irwc, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_irwc())
      rpchkbtn1_irwc.place(x=815,y=2)
      rpchkbtn1_irwc.select()
    
      rpchkbtn1_irwc = Checkbutton(midFrame, text = "Void", variable = rpcheckvar2_irwc, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_irwc())
      rpchkbtn1_irwc.place(x=815,y=40)
      rpchkbtn1_irwc.select()
      
      rpchkbtn1_irwc = Checkbutton(midFrame, text = "Unpaid", variable = rpcheckvar3_irwc, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_irwc())
      rpchkbtn1_irwc.place(x=883,y=2)
      rpchkbtn1_irwc.select()

      mainchartframe3 =Frame(reportframe,height=1500, width=200)
      mainchartframe3.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Order Report":
      #frame for display data to a a4 sheet


      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_or)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_or())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas3())
      rpsaveLabel.place(x=168,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_or())
      rpcopyLabel.place(x=240,y=12)
      
      oruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      oruw1.place(x=415,y=9)
      oruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      oruw2.place(x=530,y=9)

      lbl_or =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_or.place(x=676,y=10)
      
      global orfrm1
      orfrm1=DateEntry(midFrame, textvariable=orfrm, date_pattern='y-mm-dd')
      orfrm1.place(x=721,y=10)

      lbl_or =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_or.place(x=690,y=50)
      global orto1
      orto1=DateEntry(midFrame, textvariable=orto, date_pattern='y-mm-dd')
      orto1.place(x=721,y=50)

      lbl_or = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_or.place(x=470,y=10)

      menuor = StringVar()
      drop1or=ttk.Combobox(midFrame, textvariable=menuor)
      drop1or.place(x=530,y=10)
      drop1or["values"]=("Java","Php", "POP")
      drop1or.current(0)


      rpdrop2_or=ttk.Combobox(midFrame, textvariable=orfilter)
      rpdrop2_or["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_or.place(x=530,y=50)
      rpdrop2_or.current(0)
      
      mainchartframe4 =Frame(reportframe,height=1500, width=200)
      mainchartframe4.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
    
        #----------------------------------------------------------------------------------------------------
    elif menuvar=="Recurring Invoice Report":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_rir)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_rir())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas4())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_rir())
      rpcopyLabel.place(x=240,y=12)

      
      pruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      pruw1.place(x=415,y=9)
      pruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      pruw2.place(x=530,y=9)

      mainchartframe5 =Frame(reportframe,height=1500, width=200)
      mainchartframe5.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

        #----------------------------------------------------------------------------------------------------
    elif menuvar=="Past Due Invoices":

      rprefreshlebelpdi = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_pdi)
      rprefreshlebelpdi.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabelpdi = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_pdi())
      rpprintlabelpdi.place(x=95,y=12)
    

      rpsaveLabelpdi = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas5())
      rpsaveLabelpdi.place(x=168,y=12)

      rpcopyLabelpdi = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_pdi())
      rpcopyLabelpdi.place(x=240,y=12)
      
      pdiuw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      pdiuw1.place(x=415,y=9)
      pdiuw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      pdiuw2.place(x=530,y=9)


      lbl_pdi = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_pdi.place(x=530,y=9)
      
      menupdi = StringVar()
      drop1pdi=ttk.Combobox(midFrame, textvariable=menupdi, width=30)
      drop1pdi.place(x=530,y=50)
      drop1pdi["values"]=("Java","Php", "POP")
      drop1pdi.current(0)

      mainchartframe6 =Frame(reportframe,height=1500, width=200)
      mainchartframe6.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    
    elif menuvar=="Customers List":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_cl)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print Chart",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_cl())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas6())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_cl())
      rpcopyLabel.place(x=240,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)

      pdiuw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      pdiuw1.place(x=415,y=9)

      cluw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      cluw2.place(x=530,y=9)


      lbl_cl = Label(midFrame, text=" Select Customer Category:", bg="#f8f8f2")
      lbl_cl.place(x=530,y=9)
      

      drop1cl=ttk.Combobox(midFrame, textvariable=clfilter, width=30)
      drop1cl.place(x=530,y=50)
      drop1cl["values"]=("All Customers ","Default")
      drop1cl.current(0)

      
      rpchkbtn1_cl = Checkbutton(midFrame, text = "Active", variable = rpcheckvar1_cl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_cl())
      rpchkbtn1_cl.place(x=725,y=2)
      rpchkbtn1_cl.select()

      
      rpchkbtn1_cl = Checkbutton(midFrame, text = "Inactive", variable = rpcheckvar2_cl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_cl())
      rpchkbtn1_cl.place(x=730,y=40)
      rpchkbtn1_cl.select()
      
      mainchartframe7 =Frame(reportframe,height=1500, width=200)
      mainchartframe7.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    
    elif menuvar=="Customers List(Detailed)":
      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_cld)
      rprefreshlebel.place(x=22,y=12)


      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_cld())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas7())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_cld())
      rpcopyLabel.place(x=240,y=12)

      cluw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      cluw2.place(x=530,y=9)


      lbl_cl = Label(midFrame, text=" Select Customer Category:", bg="#f8f8f2")
      lbl_cl.place(x=530,y=9)
      
      menucl = StringVar()
      drop1cl=ttk.Combobox(midFrame, textvariable=cldfilter, width=30)
      drop1cl.place(x=530,y=50)
      drop1cl["values"]=("All Customers ","Default")
      drop1cl.current(0)

      rpchkbtn1_cl = Checkbutton(midFrame, text = "Active", variable = rpcheckvar1_cld, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_cld())
      rpchkbtn1_cl.place(x=725,y=2)
      rpchkbtn1_cl.select()

      rpchkbtn1_cl = Checkbutton(midFrame, text = "Inactive", variable = rpcheckvar2_cld, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_cld())
      rpchkbtn1_cl.place(x=730,y=40)
      rpchkbtn1_cl.select()

      mainchartframe8 =Frame(reportframe,height=1500, width=200)
      mainchartframe8.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    
    elif menuvar=="Product/Service List":
      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)

      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_psl)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_psl())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas8())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_psl())
      rpcopyLabel.place(x=240,y=12) 

      psluw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      psluw1.place(x=415,y=9)

      psluw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      psluw2.place(x=530,y=9)


      lbl_psl = Label(midFrame, text=" Select Product Category:", bg="#f8f8f2")
      lbl_psl.place(x=530,y=9)
      
      menupsl = StringVar()
      drop1psl=ttk.Combobox(midFrame, textvariable=pslfilter, width=30)
      drop1psl.place(x=530,y=50)
      drop1psl["values"]=("All product and Services ", "All products", "All Service","Default")
      drop1psl.current(0)

      
      rpchkbtn1_psl = Checkbutton(midFrame, text = "Active", variable = rpcheckvar1_psl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_psl())
      rpchkbtn1_psl.place(x=725,y=2)
      rpchkbtn1_psl.select()
      
      rpchkbtn1_psl = Checkbutton(midFrame, text = "Inactive", variable = rpcheckvar2_psl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_psl())
      rpchkbtn1_psl.place(x=730,y=40)
      rpchkbtn1_psl.select()
      mainchartframe9 =Frame(reportframe,height=1500, width=200)
      mainchartframe9.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

        #----------------------------------------------------------------------------------------------------

    elif menuvar=="Price List":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_prl)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)

      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_prl())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas9())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_prl())
      rpcopyLabel.place(x=240,y=12)

      pluw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      pluw1.place(x=415,y=9)

      pluw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      pluw2.place(x=530,y=9)


      lbl_pl = Label(midFrame, text=" Select Product Category:", bg="#f8f8f2")
      lbl_pl.place(x=530,y=9)
      
      menupl = StringVar()
      drop1pl=ttk.Combobox(midFrame, textvariable=prlfilter, width=30)
      drop1pl.place(x=530,y=50)
      drop1pl["values"]=("All product and Services ", "All products", "All Service","Default")
      drop1pl.current(0)

      
      rpchkbtn1_pl = Checkbutton(midFrame, text = "Active", variable = rpcheckvar1_pl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_pl())
      rpchkbtn1_pl.place(x=725,y=2)
      rpchkbtn1_pl.select()

      
      rpchkbtn1_pl = Checkbutton(midFrame, text = "Inactive", variable = rpcheckvar2_pl, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_pl())
      rpchkbtn1_pl.place(x=730,y=40)
      rpchkbtn1_pl.select()

      mainchartframe10 =Frame(reportframe,height=1500, width=200)
      mainchartframe10.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    
    elif menuvar=="Products Low Stock Report":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_plsr)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_plsr())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas10())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_plsr())
      rpcopyLabel.place(x=240,y=12)

      plruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      plruw1.place(x=415,y=9)

      plruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      plruw2.place(x=530,y=9)


      
      rpchkbtn1_plr = Checkbutton(midFrame, text = "Active", variable = rpcheckvar1_plr, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_plsr())
      rpchkbtn1_plr.place(x=530,y=2)
      rpchkbtn1_plr.select()
  
      rpchkbtn1_plr = Checkbutton(midFrame, text = "Inactive", variable = rpcheckvar2_plr, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_plsr())
      rpchkbtn1_plr.place(x=535,y=40)
      rpchkbtn1_plr.select()

      mainchartframe11 =Frame(reportframe,height=1500, width=200)
      mainchartframe11.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
    
      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Tax Report(Invoices)":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_tri)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_tri())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas11())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_tri())
      rpcopyLabel.place(x=240,y=12)

      triuw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      triuw1.place(x=415,y=9)

      triuw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      triuw2.place(x=530,y=9)

      lbl_tri =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_tri.place(x=676,y=10)

      global trifrm1
      global trito1
      trifrm1=DateEntry(midFrame, textvariable=trifrm, date_pattern='y-mm-dd')
      trifrm1.place(x=721,y=10)

      lbl_tri =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_tri.place(x=690,y=50)

      trito1=DateEntry(midFrame, textvariable=trito, date_pattern='y-mm-dd')
      trito1.place(x=721,y=50)

      lbl_tri = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_tri.place(x=470,y=10)

      menutri = StringVar()
      drop1tri=ttk.Combobox(midFrame, textvariable=menutri)
      drop1tri.place(x=530,y=10)
      drop1tri["values"]=("Java","Php", "POP")
      drop1tri.current(0)


      rpdrop2_tri=ttk.Combobox(midFrame, textvariable=trifilter)
      rpdrop2_tri["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_tri.place(x=530,y=50)
      rpdrop2_tri.current(0)
        

      
      rpchkbtn1_tri= Checkbutton(midFrame, text = "Paid", variable = rpcheckvar1_tri, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_tri())
      rpchkbtn1_tri.place(x=815,y=2)
      rpchkbtn1_tri.select()
      
      rpchkbtn1_tri = Checkbutton(midFrame, text = "Void", variable = rpcheckvar2_tri, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_tri())
      rpchkbtn1_tri.place(x=815,y=40)
      rpchkbtn1_tri.select()

      rpchkbtn1_tri = Checkbutton(midFrame, text = "Unpaid", variable = rpcheckvar3_tri, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_tri())
      rpchkbtn1_tri.place(x=883,y=2)
      rpchkbtn1_tri.select()
      
      mainchartframe12 =Frame(reportframe,height=1500, width=200)
      mainchartframe12.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Tax Report(Orders)":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_tro)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_tro())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas12())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_tro())
      rpcopyLabel.place(x=240,y=12)


      trouw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      trouw1.place(x=415,y=9)

      trouw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      trouw2.place(x=530,y=9)

      lbl_tro =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_tro.place(x=676,y=10)
      global trofrm1
      global troto1
      trofrm1=DateEntry(midFrame, textvariable=trofrm, date_pattern='y-mm-dd')
      trofrm1.place(x=721,y=10)

      lbl_tro =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_tro.place(x=690,y=50)

      troto1=DateEntry(midFrame, textvariable=troto, date_pattern='y-mm-dd')
      troto1.place(x=721,y=50)

      lbl_tro = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_tro.place(x=470,y=10)

      menutro = StringVar()
      drop1tro=ttk.Combobox(midFrame, textvariable=menutro)
      drop1tro.place(x=530,y=10)
      drop1tro["values"]=("Java","Php", "POP")
      drop1tro.current(0)
    
  
      rpdrop2_tro=ttk.Combobox(midFrame, textvariable=trofilter,)
      rpdrop2_tro["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_tro.place(x=530,y=50)
      rpdrop2_tro.current(0)
      
      mainchartframe13 =Frame(reportframe,height=1500, width=200)
      mainchartframe13.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    
    elif menuvar=="Sales Report(group by date)":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_srgd)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_srgd())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas13())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_srgd())
      rpcopyLabel.place(x=240,y=12)

      sruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      sruw1.place(x=415,y=9)

      sruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      sruw2.place(x=530,y=9)

      lbl_sr =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_sr.place(x=728,y=10)

      global srgd_frm
      global srgd_to
      srgd_frm=DateEntry(midFrame, textvariable=srgdfrm, date_pattern='y-mm-dd')
      srgd_frm.place(x=773,y=10)

      lbl_sr =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_sr.place(x=743,y=50)

      srgd_to=DateEntry(midFrame, textvariable=srgdto, date_pattern='y-mm-dd')
      srgd_to.place(x=773,y=50)

      lbl_sr = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_sr.place(x=470,y=10)

      menusr = StringVar()
      drop1sr=ttk.Combobox(midFrame, textvariable=menusr, width=30)
      drop1sr.place(x=530,y=10)
      drop1sr["values"]=("0")
      drop1sr.current(0)

      rpdrop2_sr=ttk.Combobox(midFrame, textvariable=srgdfilter,width=30)
      
              
      sql_inv_dt='SELECT name from productservice'
      
      fbcursor.execute(sql_inv_dt)
      tre=fbcursor.fetchall()
      
        
      
      rpdrop2_sr["values"]=tre
          

      rpdrop2_sr.place(x=530,y=50)
      rpdrop2_sr.current(0)


      mainchartframe14 =Frame(reportframe,height=1500, width=200)
      mainchartframe14.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

        #----------------------------------------------------------------------------------------------------
    elif menuvar=="Invoice Report(Detailed)":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_ird)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_ird())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas14())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_ird())
      rpcopyLabel.place(x=240,y=12)
      plruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      plruw1.place(x=415,y=9)

      irduw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      irduw2.place(x=530,y=9)

      lbl_ird =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_ird.place(x=728,y=10)
      
      global irdfrm1
      global irdfrm2 
      irdfrm1=DateEntry(midFrame, textvariable=irdfrm, date_pattern='y-mm-dd')
      irdfrm1.place(x=773,y=10)

      lbl_ird =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_ird.place(x=743,y=50)

      irdfrm2=DateEntry(midFrame, textvariable=irdto, date_pattern='y-mm-dd')
      irdfrm2.place(x=773,y=50)

      lbl_ird = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_ird.place(x=470,y=10)

      menuird = StringVar()
      drop1ird=ttk.Combobox(midFrame, textvariable=menuird, width=30)
      drop1ird.place(x=530,y=10)
      drop1ird["values"]=("Java","Php", "POP")
      drop1ird.current(0) 

      rpdrop2_ird=ttk.Combobox(midFrame, textvariable=irdfilter,width=30)
      rpdrop2_ird["values"]=("All")
      rpdrop2_ird.place(x=530,y=50)
      rpdrop2_ird.current(0)


      
      mainchartframe15 =Frame(reportframe,height=1500, width=200)
      mainchartframe15.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Daily Invoices Report":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_dir)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_dir())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas15())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_dir())
      rpcopyLabel.place(x=240,y=12)\

      diruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      diruw1.place(x=415,y=9)

      diruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      diruw2.place(x=530,y=9)


      lbl_dir = Label(midFrame, text=" Day:", bg="#f8f8f2")
      lbl_dir.place(x=526,y=9)
      
      global dir_frm
      dir_frm=DateEntry(midFrame, textvariable=dirdate, date_pattern='y-mm-dd')
      dir_frm.place(x=530,y=50)

    
      mainchartframe16 =Frame(reportframe,height=1500, width=200)
      mainchartframe16.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------  
    elif menuvar=="Purchase orders Report":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_por)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_por())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas16())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_por())
      rpcopyLabel.place(x=240,y=12)

      poruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      poruw1.place(x=415,y=9)

      poruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      poruw2.place(x=530,y=9)

      lbl_por =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_por.place(x=676,y=10)
      global porfrm1
      global porto1
      porfrm1=DateEntry(midFrame, textvariable=porfrm, date_pattern='y-mm-dd')
      porfrm1.place(x=721,y=10)

      lbl_por =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_por.place(x=690,y=50)

      porto1=DateEntry(midFrame, textvariable=porto, date_pattern='y-mm-dd')
      porto1.place(x=721,y=50)

      lbl_por = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_por.place(x=470,y=10)

      menupor = StringVar()
      drop1por=ttk.Combobox(midFrame, textvariable=menupor)
      drop1por.place(x=530,y=10)
      drop1por["values"]=("0")
      drop1por.current(0)

      rpdrop2_por=ttk.Combobox(midFrame, textvariable=porfilter)
      rpdrop2_por["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      rpdrop2_por.place(x=530,y=50)
      rpdrop2_por.current(0)
        

      
      rpchkbtn1_por= Checkbutton(midFrame, text = "Complete", variable = rpcheckvar1_por, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_function_por())
      rpchkbtn1_por.place(x=820,y=2)
      rpchkbtn1_por.select()
      
      rpchkbtn1_por = Checkbutton(midFrame, text = "Draft", variable = rpcheckvar2_por, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_function_por())
      rpchkbtn1_por.place(x=810,y=40)
      rpchkbtn1_por.select()


      mainchartframe17 =Frame(reportframe,height=1500, width=200)
      mainchartframe17.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="red"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')
      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Expenses Report":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_exp)
      rprefreshlebel.place(x=22,y=12)
      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_exp())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas17())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_exp())
      rpcopyLabel.place(x=240,y=12)
      sruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      sruw1.place(x=415,y=9)

      sruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      sruw2.place(x=530,y=9)

      lbl_er =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_er.place(x=728,y=10)
      global exp_frm
      global exp_to
      exp_frm=DateEntry(midFrame, textvariable=expfrm, date_pattern='y-mm-dd')
      exp_frm.place(x=773,y=10)

      lbl_er =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_er.place(x=743,y=50)

      exp_to=DateEntry(midFrame, textvariable=expto, date_pattern='y-mm-dd')
      exp_to.place(x=773,y=50)

      lbl_er = Label(midFrame, text="Category:", bg="#f8f8f2")
      lbl_er.place(x=470,y=10)

      menuer = StringVar()
      drop1er=ttk.Combobox(midFrame, textvariable=menuer, width=30)
      drop1er.place(x=530,y=10)
      drop1er["values"]=("")
      

      rpdrop2_er=ttk.Combobox(midFrame, textvariable=expfilter,width=30)
      rpdrop2_er["values"]=("All","Internal")
      rpdrop2_er.place(x=530,y=50)
      rpdrop2_er.current(0)

  
      rpchkbtn1_er= Checkbutton(midFrame, text = "Invoiced", variable = rpcheckvar1_exp, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=lambda:check_exp())
      rpchkbtn1_er.place(x=868,y=2)
      rpchkbtn1_er.select()

    
      rpchkbtn1_er = Checkbutton(midFrame, text = "Rebilable", variable = rpcheckvar2_exp, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=lambda:check_exp())
      rpchkbtn1_er.place(x=868,y=40)
      rpchkbtn1_er.select()

      mainchartframe19 =Frame(reportframe,height=1500, width=200)
      mainchartframe19.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

      #----------------------------------------------------------------------------------------------------
    elif menuvar=="Payment Reports":
      rprefreshlebel = Button(midFrame,compound="top", text="Refresh",relief=RAISED, image=photo8,bg="#f5f3f2", fg="black", height=55, bd=1, width=55,command=category_pyr)
      rprefreshlebel.place(x=22,y=12)

      lbl_ir = Label(reportframe, text="    \n   \n   \n   \n   \n  ", bg="#f8f8f2")
      lbl_ir.place(x=0,y=500)
      lbl_ir = Label(reportframe, text="                                                                                     ", bg="white" , font=("arial", 8))
      lbl_ir.place(x=1110,y=85)
      rpprintlabel = Button(midFrame,compound="top", text="Print",relief=RAISED, image=photo5,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pr_exp_pym())
      rpprintlabel.place(x=95,y=12)
    

      rpsaveLabel = Button(midFrame,compound="top", text="Export Report\n to Excel",relief=RAISED, image=photo3,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:exportcanvas18())
      rpsaveLabel.place(x=168,y=12)

      rpcopyLabel = Button(midFrame,compound="top", text="Export Report\n to PDF",relief=RAISED, image=copy,bg="#f8f8f2", fg="black", height=55, bd=1, width=55,command=lambda:pdf_exp_pym())
      rpcopyLabel.place(x=240,y=12)

      pruw1 = Label(midFrame,text="                                    ", bg="#f8f8f2")
      pruw1.place(x=415,y=9)
      pruw2 = Label(midFrame,text="                                                                                                             \n                                                                                                                                                  \n                                                              \n                                                            ", bg="#f8f8f2")
      pruw2.place(x=530,y=9)


      lbl_pr = Label(midFrame, text="Date Period:", bg="#f8f8f2")
      lbl_pr.place(x=530,y=9)
      
      menupr = StringVar()
      drop1pr=ttk.Combobox(midFrame, textvariable=pyrfilter, width=30)
      drop1pr.place(x=530,y=50)
      drop1pr["values"]=("Month to date","Year To Date","Current year","Current month","Current days", "Last 30 days", "Last 60 days", "Last 90 days","Previous month", "Previous year", "Custom Range")
      drop1pr.current(0)

      lbl_pr =Label(midFrame, text="From:" , bg="#f8f8f2")
      lbl_pr.place(x=725,y=10)
      global pyrfrm1
      global pyrto1
      pyrfrm1=DateEntry(midFrame, textvariable=pyrfrm, date_pattern='y-mm-dd')
      pyrfrm1.place(x=770,y=10)

      lbl_pr =Label(midFrame, text="To:", bg="#f8f8f2")
      lbl_pr.place(x=740,y=50)

      pyrto1=DateEntry(midFrame, textvariable=pyrto, date_pattern='y-mm-dd')
      pyrto1.place(x=770,y=50)


      mainchartframe18 =Frame(reportframe,height=1500, width=200)
      mainchartframe18.pack(side="top", padx=0, pady=0)

      irwcuw1 = Label(reportframe,text="                                                                                                                                                               \n", bg="white")
      irwcuw1.place(x=2,y=90)


      lbl_invdtt2 =Label(reportframe, text="Report Result Preview", bg="white" , font=("arial", 16))
      lbl_invdtt2.place(x=2, y=87)
      irwcuw1 = Label(reportframe,text="                                                                                               ", bg="white")
      irwcuw1.place(x=1135, y=97)
      lbl_invdtt2 =Label(reportframe, text="Right Click on Preview For More Options", bg="white" , font=("arial",8 ))
      lbl_invdtt2.place(x=1140, y=97)

      frame = Frame(
          reportframe,
          width=1500,
          height=1000,
          bg="#f8f8f2"
          )
      frame.pack(expand=True, fill=BOTH,  padx=10, pady=20)
      frame.place(x=20,y=115)
      canvas=Canvas(
          frame,
          bg='grey',
          width=1400,
          height=1200,
          scrollregion=(0,0,1500, 1500)
          )

      vertibar=Scrollbar(
          frame,
          orient=VERTICAL
          )
      vertibar.pack(side=RIGHT,fill=Y)
      vertibar.config(command=canvas.yview)
      canvas.config(width=1310,height=600)

      canvas.config(
          yscrollcommand=vertibar.set
          )
      canvas.pack(expand=True,side=LEFT,fill=BOTH)
      canvas.create_rectangle(235,25,1025,1430,  outline='yellow',fill='white')
      
      canvas.create_text(620,300,text="No Data To Display",fill='black',font=("arial", 14), justify='center')

      canvas.create_text(625,350,text="Please sdelect the report type from the list above\nAfter you can set the date period or other parameters",fill='blue',font=("arial", 12), justify='center')

      canvas.create_text(620,400,text="Click on 'Run Report' button for the report result",fill='blue',font=("arial", 12), justify='center')

    
    else:
      pass

  #############################################################################################################


  #***************************************************(Three Check Box)**************************************

  def chek_function():
    
          
      if checkvar1.get()==0 and checkvar2.get()==1 and checkvar3.get()==1:
              global canvasbar_ch
              global lbl_invdtt2
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
          



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
            
              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

      elif checkvar1.get()==0 and checkvar2.get()==0 and checkvar3.get()==1:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
            
              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

      elif checkvar1.get()==0 and checkvar2.get()==1 and checkvar3.get()==0:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              


              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
      
      elif checkvar1.get()==1 and checkvar2.get()==1 and checkvar3.get()==1:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
      elif checkvar1.get()==1 and checkvar2.get()==0 and checkvar3.get()==1:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=paid
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

      elif checkvar1.get()==1 and checkvar2.get()==1 and checkvar3.get()==0:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              


              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=outstanding
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)

      elif checkvar1.get()==1 and checkvar2.get()==0 and checkvar3.get()==0:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=invoice

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window
              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)
      elif checkvar1.get()==0 and checkvar2.get()==0 and checkvar3.get()==0:
              sql_paid = "SELECT SUM(invoicetot)from invoice"
              fbcursor.execute(sql_paid)
              invoice= fbcursor.fetchone()

              x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
              fbcursor.execute(x_axis)
              axis_x= fbcursor.fetchone()



              sql_company = "SELECT SUM(totpaid)from invoice"
              fbcursor.execute(sql_company)
              paid= fbcursor.fetchone()



              sql_outstanding = "SELECT SUM(balance)from invoice"
              fbcursor.execute(sql_outstanding)
              outstanding= fbcursor.fetchone()


              x=datetime.today()

              y=0

              x=axis_x
              figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
              plt.bar(x,y, label="Invoice", color="orange")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()

              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)
              



              #**************add dates********

              dates=axis_x[0]+timedelta(days=2)
              
              y=0
              x=dates
              plt.bar(x,y, label="Outstanding", color="blue")
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


              dates3=axis_x[0]-timedelta(days=2)
              y=0
              x=dates3
              plt.bar(x,y, label="Paid", color="green") 
              plt.legend()
              plt.xlabel("Date")
              plt.ylabel("Total Amount")
              axes=plt.gca()
              axes.yaxis.grid()
              # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

              #used to display chart in our frame
              canvasbar_ch = FigureCanvasTkAgg(figfirst, master=reportframe)
              canvasbar_ch.draw()
              canvasbar_ch.get_tk_widget().place(x=0, y=85) # show the barchart on the ouput window

              lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
              lbl_ir.place(x=1115,y=85)

              lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
              lbl_invdtt2.place(x=2, y=85)


      else:
          
          pass
        

  def check_function_por():
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      if rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==0:
          
          in_dat=porfrm.get()
          cr=porto.get()
          or_company = "SELECT * from company"
          fbcursor.execute(or_company)
          company_or= fbcursor.fetchone()
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE (porderdate BETWEEN %s and %s AND status="Complete")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
 
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)
          else:
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)


      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==0:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
      elif rpcheckvar1_por.get()==0 and rpcheckvar2_por.get()==1:
          
          in_dat=porfrm.get()
          cr=porto.get()
          or_company = "SELECT * from company"
          fbcursor.execute(or_company)
          company_or= fbcursor.fetchone()
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE (porderdate BETWEEN %s and %s AND status="Draft")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
 
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)
          else:
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
      elif rpcheckvar1_por.get()==1 and rpcheckvar2_por.get()==1:
          
          in_dat=porfrm.get()
          cr=porto.get()
          or_company = "SELECT * from company"
          fbcursor.execute(or_company)
          company_or= fbcursor.fetchone()
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_por_tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_por_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_por_tree.heading("# 1", text="No")
              rp_por_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_por_tree.heading("# 2", text="Date")
              rp_por_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 3", text="Due Date")
              rp_por_tree.column("# 4", anchor=E, stretch=NO, width=150)
              rp_por_tree.heading("# 4", text="Vendor")
              rp_por_tree.column("# 5", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 5", text="Status")
              rp_por_tree.column("# 6", anchor=E, stretch=NO, width=115)
              rp_por_tree.heading("# 6", text="P.Order Total")

              # Insert the data in Treeview widget
              rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              for record in rp_por_tree.get_children():
                  rp_por_tree.delete(record)
              count=0
              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM porder WHERE porderdate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()

              for i in tre:
          
                  if ps_cr=="before amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+crc))
                     
                  elif ps_cr=="before amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], crc+" "+str(i[10])))

                  elif ps_cr=="after amount with space":
                      rp_por_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[3], i[26], i[5], str(i[10])+" "+crc))
 
                  else:
                      pass
 
                  count += 1
              # total_tri='SELECT SUM(total) from porder'
              # fbcursor.execute(total_tri)
              # tot_tri= fbcursor.fetchone()
              
              
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))
              # rp_por_tree.insert('', 'end',text="1",values=('','','','','',tot_tri))

              window = canvaspor.create_window(270, 260, anchor="nw", window=rp_por_tree)
          else:
              tree=ttk.Treeview(canvaspor, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=80)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=150)
              tree.heading("# 4", text="Vendor")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="P.Order Total")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','P.Order Total'))

              window = canvaspor.create_window(290, 260, anchor="nw", window=tree)
      else:
          pass

  def check_inv():  
      in_dat=rp_exir.get_date()
      cr=rp_exir1.get_date()
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()
      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      
      
      if rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
              print("haii")

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','-No Data-','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)
          
      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s AND 	invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)
        
        

      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid != "0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==0 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==1 and rpcheckvar3_ir.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)

      elif rpcheckvar1_ir.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_ir.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=80)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))
              
              for record in rp_inv_tree.get_children():
                  rp_inv_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance!="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+str(i[8]), crc+str(i[9]),crc+str(i[10])))
                     
                  elif ps_cr=="after amount":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+crc, str(i[9])+crc,str(i[10])+crc))
                      
                  elif ps_cr=="before amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], crc+" "+str(i[8]), crc+" "+str(i[9]),crc+" "+str(i[10])))
                      
                      
                  elif ps_cr=="after amount with space":
                      rp_inv_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[35], i[4], str(i[8])+" "+crc, str(i[9])+" "+crc,str(i[10])+" "+crc))
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_inv_tree)

          else:
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_inv_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_inv_tree.heading("# 1", text="No")
              rp_inv_tree.column("# 2", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 2", text="Date")
              rp_inv_tree.column("# 3", anchor=E, stretch=NO, width=70)
              rp_inv_tree.heading("# 3", text="Due Date")
              rp_inv_tree.column("# 4", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 4", text="Terms")
              rp_inv_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 5", text="Status")
              rp_inv_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 6", text="Invoice Total")
              rp_inv_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 7", text="Invoice Paid")
              rp_inv_tree.column("# 8", anchor=E, stretch=NO, width=100)
              rp_inv_tree.heading("# 8", text="Balance")
              # Insert the data in Treeview widget
              rp_inv_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total','Total Paid','Balance'))

              window = drf.create_window(290, 260, anchor="nw", window=rp_inv_tree)
      else:
          pass

  def check_irwc():
      in_dat=irwcfrm.get_date()
      cr=irwcto.get_date()
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]

      if rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==0:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','-No Data-','','Invoice Total'))

              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)
          
      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s AND 	invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
                  count+=1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)
        
        

      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_inv_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass              
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8]+" "+crc)))
                  else:
                      pass
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_ir.get()==0 and rpcheckvar3_irwc.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid != "0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass              
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_irwc.get()==0 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass              
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

              

      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==1 and rpcheckvar3_irwc.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass              
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_irwc.get()==1 and rpcheckvar2_irwc.get()==0 and rpcheckvar3_irwc.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rp_irwc_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_irwc_tree.column("# 1", anchor=E, stretch=NO, width=50)
              rp_irwc_tree.heading("# 1", text="No")
              rp_irwc_tree.column("# 2", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 2", text="Date")
              rp_irwc_tree.column("# 3", anchor=E, stretch=NO, width=90)
              rp_irwc_tree.heading("# 3", text="Due Date")
              rp_irwc_tree.column("# 4", anchor=E, stretch=NO, width=300)
              rp_irwc_tree.heading("# 4", text="Customer")
              rp_irwc_tree.column("# 5", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 5", text="Status")
              rp_irwc_tree.column("# 6", anchor=E, stretch=NO, width=100)
              rp_irwc_tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              rp_irwc_tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))
              
              for record in rp_irwc_tree.get_children():
                  rp_irwc_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance!="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+str(i[8])))
                  elif ps_cr=="after amount":
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+crc))
                  elif ps_cr=="before amount with space":
                      
                      rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], crc+" "+str(i[8])))
                  elif ps_cr=="after amount with space":
                     rp_irwc_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], i[18], i[4], str(i[8])+" "+crc))
                  else:
                      pass               
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rp_irwc_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)
      else:
          pass


  def check_tri():
      in_dat=trifrm.get_date()
      cr=trito.get_date()
      sql_company = "SELECT * from company"
      fbcursor.execute(sql_company)
      company= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]

      if rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rep_tri_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tri_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 1", text="Invoice No")
              rep_tri_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 2", text="Issue Date")
              rep_tri_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 3", text="Due Date")
              rep_tri_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tri_tree.heading("# 4", text="Total Before TAX")
              rep_tri_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 5", text="TAX1")
              rep_tri_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tri_tree.heading("# 6", text="TAX2")
              rep_tri_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tri_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tri_tree.insert('', 'end',text="1",values=('','-No Data-','','Total Before TAX','TAX1','TAX2','Invoice Total'))

              window = drf.create_window(270, 260, anchor="nw", window=rep_tri_tree)
          
      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s AND 	invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count+=1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)
        
        

      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid != "0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE invodate BETWEEN %s and %s'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_tri.get()==0 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

              

      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==1 and rpcheckvar3_tri.get()==0:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid is not null or invoicetot="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_tri.get()==1 and rpcheckvar2_tri.get()==0 and rpcheckvar3_tri.get()==1:
          if company is not None:

              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders
              rep_tro_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7"), show='headings', height=55, style='mystyle.Treeview')
              rep_tro_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 1", text="Invoice No")
              rep_tro_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 2", text="Issue Date")
              rep_tro_tree.column("# 3", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 3", text="Due Date")
              rep_tro_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rep_tro_tree.heading("# 4", text="Total Before TAX")
              rep_tro_tree.column("# 5", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 5", text="TAX1")
              rep_tro_tree.column("# 6", anchor=E, stretch=NO, width=90)
              rep_tro_tree.heading("# 6", text="TAX2")
              rep_tro_tree.column("# 7", anchor=E, stretch=NO, width=100)
              rep_tro_tree.heading("# 7", text="Invoice Total")

              # Insert the data in Treeview widget
              rep_tro_tree.insert('', 'end',text="1",values=('','','','Total Before TAX','TAX1','TAX2','Invoice Total'))
              
              for record in rep_tro_tree.get_children():
                  rep_tro_tree.delete(record)
              count=0

              var1=in_dat
              var2=cr
              sql_inv_dt='SELECT * FROM invoice WHERE(invodate BETWEEN %s and %s and totpaid="0" or balance!="0")'
              inv_valuz=(var1,var2)
              fbcursor.execute(sql_inv_dt,inv_valuz)
              tre=fbcursor.fetchall()
              
              
              for i in tre:
                  if ps_cr=="before amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+str(i[37]), crc+str(i[16]), crc+str(i[36]),crc+str(i[8])))
                     
                  elif ps_cr=="after amount":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], str(i[37])+crc, str(i[16])+crc, str(i[36])+crc,str(i[8])))
                      
                  elif ps_cr=="before amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3], crc+" "+str(i[37]), crc+" "+str(i[16]), crc+" "+str(i[36]),crc+" "+str(i[8])))
                      
                  elif ps_cr=="after amount with space":
                      rep_tro_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[1], i[2], i[3],str(i[37])+" "+crc, str(i[16])+" "+crc, str(i[36])+" "+crc,str(i[8])+" "+crc))
                      
                   
                  else:
                      pass
                  count += 1
              
              window = drf.create_window(270, 260, anchor="nw", window=rep_tro_tree)

          else:
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=50)
              tree.heading("# 1", text="No")
              tree.column("# 2", anchor=E, stretch=NO, width=70)
              tree.heading("# 2", text="Date")
              tree.column("# 3", anchor=E, stretch=NO, width=70)
              tree.heading("# 3", text="Due Date")
              tree.column("# 4", anchor=E, stretch=NO, width=300)
              tree.heading("# 4", text="Customer")
              tree.column("# 5", anchor=E, stretch=NO, width=100)
              tree.heading("# 5", text="Status")
              tree.column("# 6", anchor=E, stretch=NO, width=100)
              tree.heading("# 6", text="Invoice Total")

              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','','Invoice Total'))

              window = drf.create_window(290, 260, anchor="nw", window=tree)
      else:
          pass

  def check_plsr():
      or_company = "SELECT * from company"
      fbcursor.execute(or_company)
      company_or= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]

      if rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==0:
          
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_plsr_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_plsr_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 1", text="Product Id")
              rp_plsr_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 2", text="Category")
              rp_plsr_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_plsr_tree.heading("# 3", text="Product Name")
              rp_plsr_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 4", text="Warehouse")
              rp_plsr_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 5", text="Low Stock Limit")
              rp_plsr_tree.column("# 6", anchor=E, stretch=NO, width=70)
              rp_plsr_tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              rp_plsr_tree.insert('', 'end',text="1",values=('','','','','',''))
              # Insert the data in Treeview widget
              for record in rp_plsr_tree.get_children():
                  rp_plsr_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE stock > stocklimit')
              for i in fbcursor:
                  rp_plsr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[15], i[14], i[13]))
                  count += 1
              
              window = drf.create_window(290, 130, anchor="nw", window=rp_plsr_tree)
          else:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product Id")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Product Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Warehouse")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Low Stock Limit")
              tree.column("# 6", anchor=E, stretch=NO, width=70)
              tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = drf.create_window(290, 130, anchor="nw", window=tree)


      elif rpcheckvar1_plr.get()==0 and rpcheckvar2_plr.get()==0:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product Id")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Product Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Warehouse")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Low Stock Limit")
              tree.column("# 6", anchor=E, stretch=NO, width=70)
              tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','-No Data-','','',''))

              window = drf.create_window(290, 130, anchor="nw", window=tree)

      elif rpcheckvar1_plr.get()==0 and rpcheckvar2_plr.get()==1:
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_plsr_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_plsr_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 1", text="Product Id")
              rp_plsr_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 2", text="Category")
              rp_plsr_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_plsr_tree.heading("# 3", text="Product Name")
              rp_plsr_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 4", text="Warehouse")
              rp_plsr_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 5", text="Low Stock Limit")
              rp_plsr_tree.column("# 6", anchor=E, stretch=NO, width=70)
              rp_plsr_tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              rp_plsr_tree.insert('', 'end',text="1",values=('','','','','',''))
              # Insert the data in Treeview widget
              for record in rp_plsr_tree.get_children():
                  rp_plsr_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE stock < stocklimit')
              for i in fbcursor:
                  rp_plsr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[15], i[14], i[13]))
                  count += 1
              
              window = drf.create_window(290, 130, anchor="nw", window=rp_plsr_tree)
          else:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product Id")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Product Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Warehouse")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Low Stock Limit")
              tree.column("# 6", anchor=E, stretch=NO, width=70)
              tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = drf.create_window(290, 130, anchor="nw", window=tree)
      elif rpcheckvar1_plr.get()==1 and rpcheckvar2_plr.get()==1:
          
          if company_or is not None:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              rp_plsr_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              rp_plsr_tree.column("# 1", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 1", text="Product Id")
              rp_plsr_tree.column("# 2", anchor=E, stretch=NO, width=100)
              rp_plsr_tree.heading("# 2", text="Category")
              rp_plsr_tree.column("# 3", anchor=E, stretch=NO, width=150)
              rp_plsr_tree.heading("# 3", text="Product Name")
              rp_plsr_tree.column("# 4", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 4", text="Warehouse")
              rp_plsr_tree.column("# 5", anchor=E, stretch=NO, width=130)
              rp_plsr_tree.heading("# 5", text="Low Stock Limit")
              rp_plsr_tree.column("# 6", anchor=E, stretch=NO, width=70)
              rp_plsr_tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              rp_plsr_tree.insert('', 'end',text="1",values=('','','','','',''))
              # Insert the data in Treeview widget
              for record in rp_plsr_tree.get_children():
                  rp_plsr_tree.delete(record)
              count=0
              fbcursor.execute('SELECT * from productservice WHERE stock<stocklimit')
              for i in fbcursor:
                  rp_plsr_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[15], i[14], i[13]))
                  count += 1
              
              window = drf.create_window(290, 130, anchor="nw", window=rp_plsr_tree)
          else:
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=100)
              tree.heading("# 1", text="Product Id")
              tree.column("# 2", anchor=E, stretch=NO, width=100)
              tree.heading("# 2", text="Category")
              tree.column("# 3", anchor=E, stretch=NO, width=150)
              tree.heading("# 3", text="Product Name")
              tree.column("# 4", anchor=E, stretch=NO, width=130)
              tree.heading("# 4", text="Warehouse")
              tree.column("# 5", anchor=E, stretch=NO, width=130)
              tree.heading("# 5", text="Low Stock Limit")
              tree.column("# 6", anchor=E, stretch=NO, width=70)
              tree.heading("# 6", text="Stock")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','','','',''))

              window = drf.create_window(290, 130, anchor="nw", window=tree)
      else:
          pass


  def check_pl():
      rth=prlfilter.get()
      or_company = "SELECT * from company"
      fbcursor.execute(or_company)
      company_tro= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      
      if rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==0:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE stock > stocklimit')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)


          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE (category="Products" and stock > stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')


                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE (category="Service" and stock > stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)
          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)
              
      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE stock < stocklimit')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)


          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE (category="Products" and stock < stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')


                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE (category="Service" and stock < stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

          
      #==============================================================================================================
          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE (category="Default" and stock < stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)
      elif rpcheckvar1_pl.get()==1 and rpcheckvar2_pl.get()==1:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)


          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE category="Products" ')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              
              
              else:

              


                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE category="Service"')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

          
      #==============================================================================================================
          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_pl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  rp_pl_tree.column("# 1", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 1", text="Product ID")
                  rp_pl_tree.column("# 2", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 2", text="Product/Service Name")
                  rp_pl_tree.column("# 3", anchor=E, stretch=NO, width=200)
                  rp_pl_tree.heading("# 3", text="Description")
                  rp_pl_tree.column("# 4", anchor=E, stretch=NO, width=150)
                  rp_pl_tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  rp_pl_tree.insert('', 'end',text="1",values=('','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_pl_tree.get_children():
                      rp_pl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice WHERE category="Default"')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+str(i[7])))

                        elif ps_cr=="after amount":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], crc+" "+str(i[7])))

                        elif ps_cr=="after amount with space":
                            rp_pl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[4], i[5], str(i[7])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(280, 130, anchor="nw", window=rp_pl_tree)
              else:
                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

      elif rpcheckvar1_pl.get()==0 and rpcheckvar2_pl.get()==0:
          if rth=="All product and Services ":
              

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','-No Data-',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)


          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','-No Data-','',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

              #===============================================================================================
          elif rth=="All Service":
              
                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','-No Data-',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)

          
      #==============================================================================================================
          elif rth=="Default":
                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=150)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=200)
                  tree.heading("# 2", text="Product/Service Name")
                  tree.column("# 3", anchor=E, stretch=NO, width=200)
                  tree.heading("# 3", text="Description")
                  tree.column("# 4", anchor=E, stretch=NO, width=150)
                  tree.heading("# 4", text="Unit Price")
                  
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','-No Data-',''))

                  window = drf.create_window(280, 130, anchor="nw", window=tree)
      else:
          pass


  def check_psl():
      rth=pslfilter.get()
      or_company = "SELECT * from company"
      fbcursor.execute(or_company)
      company_tro= fbcursor.fetchone()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      
      if rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==0:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where stock>stocklimit')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Products" and stock>stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)


              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Service" and stock > stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Default" and stock > stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)


      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice Where stock < stocklimit')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Products" and stock < stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)


              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Service" and stock < stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where (category="Default" and stock<stocklimit)')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)
      elif rpcheckvar1_psl.get()==1 and rpcheckvar2_psl.get()==1:
          if rth=="All product and Services ":
              if company_tro is not None:
                          
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          #--------------------------------------------------------------------------------------------------------------
          elif rth=="All products":
              
              if company_tro is not None:           
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where category="Products" ')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)


              #===============================================================================================
          elif rth=="All Service":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where category="Service" ')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

          elif rth=="Default":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_psl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  rp_psl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 1", text="Product ID")
                  rp_psl_tree.column("# 2", anchor=E, stretch=NO, width=120)
                  rp_psl_tree.heading("# 2", text="Category")
                  rp_psl_tree.column("# 3", anchor=E, stretch=NO, width=180)
                  rp_psl_tree.heading("# 3", text="Product/ Service Name")
                  rp_psl_tree.column("# 4", anchor=E, stretch=NO, width=130)
                  rp_psl_tree.heading("# 4", text="Description")
                  rp_psl_tree.column("# 5", anchor=E, stretch=NO, width=150)
                  rp_psl_tree.heading("# 5", text="Warehouse")
                  rp_psl_tree.column("# 6", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 6", text="Stock")
                  rp_psl_tree.column("# 7", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 7", text="Cost")
                  rp_psl_tree.column("# 8", anchor=E, stretch=NO, width=100)
                  rp_psl_tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  rp_psl_tree.insert('', 'end',text="1",values=('','','','','','','',''))


                  # Insert the data in Treeview widget
                  for record in rp_psl_tree.get_children():
                      rp_psl_tree.delete(record)
                  count=0
                  fbcursor.execute('SELECT * from productservice where category="Default" ')
                  for i in fbcursor:
                        if ps_cr=="before amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+str(i[9]), crc+str(i[11])))

                        elif ps_cr=="after amount":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+crc, str(i[11])+crc))
        
                        elif ps_cr=="before amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], crc+" "+str(i[9]), crc+" "+str(i[11])))

                        elif ps_cr=="after amount with space":
                            rp_psl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[3], i[4], i[5], i[15], i[13], str(i[9])+" "+crc, str(i[11])+" "+crc))
        
                        else:
                            pass
                        count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_psl_tree)
              
              
              else:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

      elif rpcheckvar1_psl.get()==0 and rpcheckvar2_psl.get()==0:

                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6", "c7", "c8"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Product ID")
                  tree.column("# 2", anchor=E, stretch=NO, width=120)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=180)
                  tree.heading("# 3", text="Product/ Service Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=130)
                  tree.heading("# 4", text="Description")
                  tree.column("# 5", anchor=E, stretch=NO, width=150)
                  tree.heading("# 5", text="Warehouse")
                  tree.column("# 6", anchor=E, stretch=NO, width=100)
                  tree.heading("# 6", text="Stock")
                  tree.column("# 7", anchor=E, stretch=NO, width=100)
                  tree.heading("# 7", text="Cost")
                  tree.column("# 8", anchor=E, stretch=NO, width=100)
                  tree.heading("# 8", text="Price")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)
      else:
          pass


  def check_exp():
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()
      rth=expfilter.get()

      sqlr= 'select currencysign from company'
      fbcursor.execute(sqlr)
      crncy=fbcursor.fetchone()
      global crc
      crc=crncy[0]
      sqlrt= 'select currsignplace from company'
      fbcursor.execute(sqlrt)
      post_rp=fbcursor.fetchone()
      global ps_cr
      ps_cr=post_rp[0]
      if rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==0:
          if rth=="All":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s and invoiced="Yes")'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:

                  drf.create_text(360,100,text="Your Company Name",fill='black',font=("Helvetica", 12), justify='center')

                  drf.create_text(335,165,text="Address line1\nAddress line2\nAddress line3\nAddress line3\nAddress line4\nPhone 555-5555",fill='black',font=("Helvetica", 10), justify='left')

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)
          elif rth=="Internal":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s and customer="Internal" and invoiced="Yes")'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:

                  
                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)


      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              if company_tro is not None:
              
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s and rebillable="Yes")'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)
          elif rth=="Internal":
              if company_tro is not None:
              
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s and customer="Internal" and rebillable="Yes")'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:

                  

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_exp.get()==1 and rpcheckvar2_exp.get()==1:
          if rth=="All":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s)'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],i[14], crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], i[14], str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:


                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)
          elif rth=="Internal":
              if company_tro is not None:
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_exp_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_exp_tree.column("# 1", anchor=E, stretch=NO, width=80)
                  rp_exp_tree.heading("# 1", text="Date")
                  rp_exp_tree.column("# 2", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 2", text="Customer")
                  rp_exp_tree.column("# 3", anchor=E, stretch=NO, width=160)
                  rp_exp_tree.heading("# 3", text="Vendor")
                  rp_exp_tree.column("# 4", anchor=E, stretch=NO, width=100)
                  rp_exp_tree.heading("# 4", text="Invoice")
                  rp_exp_tree.column("# 5", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 5", text="Rebill.Amount")
                  rp_exp_tree.column("# 6", anchor=E, stretch=NO, width=115)
                  rp_exp_tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  rp_exp_tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))
                  
                  for record in rp_exp_tree.get_children():
                      rp_exp_tree.delete(record)
                  count=0
                  var_1=exp_frm.get_date()
                  var_2=exp_to.get_date()

                  lre='SELECT * from expenses WHERE(date BETWEEN %s and %s and customer="Internal")'
                  sre=(var_1, var_2)
                  fbcursor.execute(lre,sre)
                  tre=fbcursor.fetchall()

                  for i in tre:
                        if ps_cr=="before amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],crc+str(i[14]), crc+str(i[16]), crc+str(i[3])))
                            
                            
                        elif ps_cr=="after amount":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], str(i[14])+crc, str(i[16])+crc, str(i[3])+crc))
                            
                            
                        elif ps_cr=="before amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5],crc+" "+str(i[14]), crc+" "+str(i[16]), crc+" "+str(i[3])))
                            
                        elif ps_cr=="after amount with space":
                            rp_exp_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[4], i[10], i[5], str(i[14])+" "+crc, str(i[16])+" "+crc, str(i[3])+" "+crc))
                        
                        else:
                            pass
                        count += 1

                  rp_exp_tree.insert('', 'end',text="1",values=('','','','-End List-','Rebill.Amount','Amount'))
                  

                  window = drf.create_window(270, 260, anchor="nw", window=rp_exp_tree)

                  
                  
              else:

                

                  
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=80)
                  tree.heading("# 1", text="Date")
                  tree.column("# 2", anchor=E, stretch=NO, width=150)
                  tree.heading("# 2", text="Customer")
                  tree.column("# 3", anchor=E, stretch=NO, width=120)
                  tree.heading("# 3", text="Vendor")
                  tree.column("# 4", anchor=E, stretch=NO, width=100)
                  tree.heading("# 4", text="Invoice")
                  tree.column("# 5", anchor=E, stretch=NO, width=115)
                  tree.heading("# 5", text="Rebill.Amount")
                  tree.column("# 6", anchor=E, stretch=NO, width=115)
                  tree.heading("# 6", text="Amount")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','Rebill.Amount','Amount'))

                  window = drf.create_window(290, 260, anchor="nw", window=tree)

      elif rpcheckvar1_exp.get()==0 and rpcheckvar2_exp.get()==0:
          if company_tro is not None:
              
              style=ttk.Style()
              style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
              style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
              style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

              # Add a Treeview widge
                      
              tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
              tree.column("# 1", anchor=E, stretch=NO, width=130)
              tree.heading("# 1", text="Date")
              tree.column("# 2", anchor=E, stretch=NO, width=150)
              tree.heading("# 2", text="Customer")
              tree.column("# 3", anchor=E, stretch=NO, width=120)
              tree.heading("# 3", text="Vendor")
              tree.column("# 4", anchor=E, stretch=NO, width=100)
              tree.heading("# 4", text="Invoice")
              tree.column("# 5", anchor=E, stretch=NO, width=115)
              tree.heading("# 5", text="Rebill.Amount")
              tree.column("# 6", anchor=E, stretch=NO, width=115)
              tree.heading("# 6", text="Amount")
              # Insert the data in Treeview widget
              tree.insert('', 'end',text="1",values=('','','-No Data-','','Rebill.Amount','Amount'))

              window = drf.create_window(270, 260, anchor="nw", window=tree)

      else:
          pass
      


  def check_cl():
      
      
      rth=clfilter.get()
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()

      if rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==0:
          
          if company_tro is not None:
              
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                          count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                          count += 1
                  else:
                      rp_cl_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree)

              else:
                  pass
          else:
                      
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Customer Id")
                  tree.column("# 2", anchor=E, stretch=NO, width=170)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=250)
                  tree.heading("# 3", text="Customer Businnes Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=180)
                  tree.heading("# 4", text="Customer Person")
                  tree.column("# 5", anchor=E, stretch=NO, width=130)
                  tree.heading("# 5", text="Tel")
                  tree.column("# 6", anchor=E, stretch=NO, width=130)
                  tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)

      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==1:
          
          if company_tro is not None:
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                          count += 1
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                          count += 1
                  else:
                      rp_cl_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree)

              else:
                  pass
          else:
                      
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Customer Id")
                  tree.column("# 2", anchor=E, stretch=NO, width=170)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=250)
                  tree.heading("# 3", text="Customer Businnes Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=180)
                  tree.heading("# 4", text="Customer Person")
                  tree.column("# 5", anchor=E, stretch=NO, width=130)
                  tree.heading("# 5", text="Tel")
                  tree.column("# 6", anchor=E, stretch=NO, width=130)
                  tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)
      elif rpcheckvar1_cl.get()==1 and rpcheckvar2_cl.get()==1:
          if company_tro is not None:
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  trf='select * from customer'
                  
                  fbcursor.execute(trf)
                  thg=fbcursor.fetchall()

                  for i in thg:
                      rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                      count += 1
                  else:
                      rp_cl_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))
                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cl_tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cl_tree.column("# 1", anchor=E, stretch=NO, width=100)
                  rp_cl_tree.heading("# 1", text="Customer Id")
                  rp_cl_tree.column("# 2", anchor=E, stretch=NO, width=170)
                  rp_cl_tree.heading("# 2", text="Category")
                  rp_cl_tree.column("# 3", anchor=E, stretch=NO, width=250)
                  rp_cl_tree.heading("# 3", text="Customer Businnes Name")
                  rp_cl_tree.column("# 4", anchor=E, stretch=NO, width=180)
                  rp_cl_tree.heading("# 4", text="Customer Person")
                  rp_cl_tree.column("# 5", anchor=E, stretch=NO, width=140)
                  rp_cl_tree.heading("# 5", text="Tel")
                  rp_cl_tree.column("# 6", anchor=E, stretch=NO, width=130)
                  rp_cl_tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  rp_cl_tree.insert('', 'end',text="1",values=('','','','','',''))

                  # Insert the data in Treeview widget
                  for record in rp_cl_tree.get_children():
                      rp_cl_tree.delete(record)
                  count=0
                  
                  trf='select * from customer where category="Default"'
                  
                  fbcursor.execute(trf)
                  thg=fbcursor.fetchall()

                  for i in thg:
                      rp_cl_tree.insert(parent='', index='end', iid=i, text='hello', values=(i[0], i[2], i[4], i[8], i[10], i[11]))
                      count += 1
                  else:
                      rp_cl_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(170, 150, anchor="nw",  window=rp_cl_tree)

              else:
                  pass
          else:
                      
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Customer Id")
                  tree.column("# 2", anchor=E, stretch=NO, width=170)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=250)
                  tree.heading("# 3", text="Customer Businnes Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=180)
                  tree.heading("# 4", text="Customer Person")
                  tree.column("# 5", anchor=E, stretch=NO, width=140)
                  tree.heading("# 5", text="Tel")
                  tree.column("# 6", anchor=E, stretch=NO, width=130)
                  tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','','','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)
      elif rpcheckvar1_cl.get()==0 and rpcheckvar2_cl.get()==0:
          if company_tro is not None:
              
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  tree=ttk.Treeview(drf, column=("c1", "c2","c3", "c4", "c5", "c6"), show='headings', height=55, style='mystyle.Treeview')
                  tree.column("# 1", anchor=E, stretch=NO, width=100)
                  tree.heading("# 1", text="Customer Id")
                  tree.column("# 2", anchor=E, stretch=NO, width=170)
                  tree.heading("# 2", text="Category")
                  tree.column("# 3", anchor=E, stretch=NO, width=250)
                  tree.heading("# 3", text="Customer Businnes Name")
                  tree.column("# 4", anchor=E, stretch=NO, width=180)
                  tree.heading("# 4", text="Customer Person")
                  tree.column("# 5", anchor=E, stretch=NO, width=130)
                  tree.heading("# 5", text="Tel")
                  tree.column("# 6", anchor=E, stretch=NO, width=130)
                  tree.heading("# 6", text="Fax")
                  # Insert the data in Treeview widget
                  tree.insert('', 'end',text="1",values=('','',' -=No Data-','','',''))

                  window = drf.create_window(170, 150, anchor="nw", window=tree)
      else:
          pass

  def check_cld():
      rth=cldfilter.get()
      tro_company = "SELECT * from company"
      fbcursor.execute(tro_company)
      company_tro= fbcursor.fetchone()

      if rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==0:
          
          if company_tro is not None:
              
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))

                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
              
              # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))
                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)>1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  else:
                      rp_cld_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree)

              else:
                  pass
          else:
                      
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('No Data',''))
                  window = drf.create_window(290, 130, anchor="nw", window=rp_cld_tree)

      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==1:
          
          if company_tro is not None:
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))

                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))

                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='SELECT * from invoice GROUP by businessname HAVING COUNT(businessname)=1'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                      trf='select * from customer where businessname=%s and category="Default"'
                      vs=(str(i[18]),)
                      
                      fbcursor.execute(trf, vs)
                      thg=fbcursor.fetchall()

                      for i in thg:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  else:
                      rp_cld_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree)

              else:
                  pass
          else:
                      
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('No Data',''))

                  window = drf.create_window(290, 130, anchor="nw", window=rp_cld_tree)
      elif rpcheckvar1_cld.get()==0 and rpcheckvar2_cld.get()==0:
          if company_tro is not None:
              
                  # Create an instance of Style widget
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13,'bold')) # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('-No Data-',''))

                  window = drf.create_window(290, 130, anchor="nw", window=rp_cld_tree)
      elif rpcheckvar1_cld.get()==1 and rpcheckvar2_cld.get()==1:
          if company_tro is not None:
              
              if rth=="All Customers ":
                  
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))
                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='select * from customer'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree) 
              

              elif rth=="Default":
                  style=ttk.Style()
                  style.configure("mystyle.Treeview", highlightthickness=0, bd=0, font=('Calibri', 11)) # Modify the font of the body
                  style.configure("mystyle.Treeview.Heading", font=('Calibri', 13), background='white') # Modify the font of the headings
                  style.layout("mystyle.Treeview", [('mystyle.Treeview.treearea', {'sticky': 'nswe'})]) # Remove the borders

                  # Add a Treeview widge
                          
                  rp_cld_tree=ttk.Treeview(drf, column=("c1", "c2"), show='headings', height=55, style='mystyle.Treeview')
                  rp_cld_tree.column("# 1", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 1", text="")
                  rp_cld_tree.column("# 2", anchor="sw", stretch=NO, width=345)
                  rp_cld_tree.heading("# 2", text="")
                  
                  # Insert the data in Treeview widget
                  rp_cld_tree.insert('', 'end',text="1",values=('',''))

                  # Insert the data in Treeview widget
                  for record in rp_cld_tree.get_children():
                      rp_cld_tree.delete(record)
                  count=0
                  trs='select * from customer where category="Default"'
                  fbcursor.execute(trs)
                  thj=fbcursor.fetchall()
                  for i in thj:
                          rp_cld_tree.insert("","end", iid=i, text='hello', values=("Billing Information:                      Customer Id:"+str(i[0]),"Shipping Information:                      Tax exempt No.:"+str(i[17])))

                          rp_cld_tree.insert("","end", values=('Name: '+str(i[4]),'Name:'+str(i[6])))

                          rp_cld_tree.insert("","end", values=('Address: '+str(i[5]),'Address:'+str(i[7])))
                          rp_cld_tree.insert("","end", values=('Contact Person: '+str(i[8]),'Contact Person:'+str(i[13])))
                          rp_cld_tree.insert("","end", values=('Tel:'+str(i[10])+'          Fax: '+str(i[11]),'Tel:'+str(i[15])+'          Fax: '+str(i[16])))
                          rp_cld_tree.insert("","end", values=('Email: '+str(i[9]),'Email: '+str(i[14])))
                          rp_cld_tree.insert('', 'end',text="1",values=('____________________________________________________________','____________________________________________________________'))
                          
                          count += 1
                  else:
                      rp_cld_tree.insert('', 'end',text="1",values=('','','','-No Data-','',''))


                  window = drf.create_window(290, 130, anchor="nw",  window=rp_cld_tree)

              else:
                  pass


      else:
          pass
  #==============================================================================================================
          
      
  #*****************************************Two Checkbox*****************************************************

  ############################################################(Screen Chart)###################################
  lbl_invdtt = Label(lbframe, text="Report Type:  ", bg="#f8f8f2")
  lbl_invdtt.place(x=8, y=10)
  global menu1
  menu1 = StringVar()
  drop=ttk.Combobox(lbframe, textvariable=menu1, width=30)
  drop.grid(row=2, column=0, pady=5, padx=(5, 0))
  drop["values"]=("Screen Charts","Invoice Report","Invoice Report(With Customer)", "Order Report", "Recurring Invoice Report", "Past Due Invoices", "Payment Reports", "Customers List","Customers List(Detailed)","Product/Service List", "Price List", "Products Low Stock Report", "Tax Report(Invoices)", "Tax Report(Orders)", "Sales Report(group by date)", "Invoice Report(Detailed)", "Daily Invoices Report", "Purchase orders Report", "Expenses Report"
  )
  drop.current(0)
  drop.bind("<<ComboboxSelected>>",maindropmenu)



  lbl_invdtt = Label(lbframe, text="Category:", bg="#f8f8f2")
  lbl_invdtt.grid(row=1, column=0, pady=5, padx=(150, 0))

  menu = StringVar()
  drop1=ttk.Combobox(lbframe, textvariable=menu)
  drop1.grid(row=1, column=3, pady=5, padx=(5, 0))
  drop1["values"]=("0")
  drop1.current(0)


  drop2=ttk.Combobox(lbframe, textvariable=scrfilter)
  drop2.grid(row=2, column=3, pady=5, padx=(5, 0))
  drop2["values"]=("Year To Date","Current year","Last 3 Month","Last 6 Month", "Last 12 Month", "Last 18 Month", "Last 24 Month","Previous Year", "Before Previous Year", "Custom Range")
  drop2.current(0)

    
  lbl_invdtt =Label(lbframe, text="From:" , bg="#f8f8f2")
  lbl_invdtt.grid(row=1, column=4, pady=5, padx=(5, 0))
  global rp_scr_frm
  global rp_sc_to

  rp_scr_frm=DateEntry(lbframe,textvariable=scrfrm, date_pattern='y-mm-dd')
  rp_scr_frm.grid(row=1, column=5)

  lbl_invdtt =Label(lbframe, text="To:", bg="#f8f8f2")
  lbl_invdtt.grid(row=2, column=4, pady=5, padx=(5, 0))

  rp_sc_to=DateEntry(lbframe,textvariable=scrto, date_pattern='y-mm-dd')
  rp_sc_to.grid(row=2, column=5)

  # checkvar1 = BooleanVar()
  rp_1_chkbtn1 = Checkbutton(lbframe, text = "Invoice", variable = checkvar1, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2",command=chek_function)
  rp_1_chkbtn1.grid(row=0, column=6, rowspan=2, padx=(0,3))
  rp_1_chkbtn1.select()

  # checkvar2 = BooleanVar()
  rp_2_chkbtn2 = Checkbutton(lbframe, text = "Outstanding", variable = checkvar2, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=chek_function)
  rp_2_chkbtn2.grid(row=2, column=6,rowspan=2,padx=(25,0))
  rp_2_chkbtn2.select()

  # checkvar3 = BooleanVar()
  rp_3_chkbtn3 = Checkbutton(lbframe, text = "Paid", variable = checkvar3, onvalue = 1, offvalue = 0, height = 2, width = 8, bg="#f8f8f2", command=chek_function)
  rp_3_chkbtn3.grid(row=1, column=7)
  rp_3_chkbtn3.select()


  # dt_to=rp_sc_to.get_date()
  # dts=2020-01-01
  # print(dt_to-dts)
  ######################################################################################################################


  #########################################(Graph Section)############################################################  #
  #first graph
  sql_paid = "SELECT SUM(invoicetot)from invoice"
  fbcursor.execute(sql_paid)
  invoice= fbcursor.fetchone()

  x_axis = "SELECT invodate from invoice WHERE invoicetot=(SELECT MAX(invoicetot) from invoice)"
  fbcursor.execute(x_axis)
  axis_x= fbcursor.fetchone()



  sql_company = "SELECT SUM(totpaid)from invoice"
  fbcursor.execute(sql_company)
  paid= fbcursor.fetchone()



  sql_outstanding = "SELECT SUM(balance)from invoice"
  fbcursor.execute(sql_outstanding)
  outstanding= fbcursor.fetchone()



  # print(rp_scr_frm.get_date())
  # x=rp_scr_frm.get_date()
  # # print(x.get_date())
  # invoice=1200
  # outstanding=22
  # paid=14

  #------------------------------------with cursor----------------
  # y=float(invoice)
  # x+=1
  # fig, ax =plt.subplots()
  # plt.bar(x,y, label="Invoice", color="orange")
  # plt.legend()
  # plt.xlabel("x-axis")
  # plt.ylabel("y-label")
  # axes=plt.gca()
  # axes.yaxis.grid()
  # cursor=Cursor(ax, horizOn=True, vertOn=True, color='r', linewidth=1)
  # plt.show()
  #-------------------------------------------------------------------------------


  frame = Frame(
          reportframe,
          width=1380,
          height=1000,
          bg='#b3b3b3',
          )
  frame.pack(expand=True, fill=BOTH,  padx=0, pady=0)
      
  frame.pack()


  x=datetime.today()

  y=invoice

  x=axis_x
  figfirst = plt.figure(figsize=(17, 3.58), dpi=80)
  plt.bar(x,y, label="Invoice", color="orange")
  plt.legend()
  plt.xlabel("Date")
  plt.ylabel("Total Amount")
  axes=plt.gca()
  axes.yaxis.grid()

  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)




  #**************add dates********

  dates=axis_x[0]+timedelta(days=2)

  y=outstanding
  x=dates
  plt.bar(x,y, label="Outstanding", color="blue")
  plt.legend()
  plt.xlabel("Date")
  plt.ylabel("Total Amount")
  axes=plt.gca()
  axes.yaxis.grid()
  # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)


  dates3=axis_x[0]-timedelta(days=2)
  y=paid
  x=dates3
  plt.bar(x,y, label="Paid", color="green") 
  plt.legend()
  plt.xlabel("Date")
  plt.ylabel("Total Amount")
  axes=plt.gca()
  axes.yaxis.grid()
  # # cursor=Cursor(ax, horizOn=True, vertOn=True, useblit=True, color='r', linewidth=1)

  #used to display chart in our frame
  canvasbar = FigureCanvasTkAgg(figfirst, master=frame)
  canvasbar.draw()
  canvasbar.get_tk_widget().place(x=0, y=0) # show the barchart on the ouput window

  #second graph

  sec_paid = "SELECT invoicetot from invoice  GROUP BY businessname ORDER by COUNT(businessname) DESC LIMIT 1"
  fbcursor.execute(sec_paid)
  paid_sec_x= fbcursor.fetchone()

          
  sec_paid_y = "SELECT businessname from invoice  GROUP BY businessname  ORDER by COUNT(businessname) DESC LIMIT 1"
  fbcursor.execute(sec_paid_y)

  paid_sec_y= fbcursor.fetchone()




  figsecond = plt.figure(figsize=(9, 4), dpi=80)

  x=paid_sec_y
  y=paid_sec_x
  plt.barh(x,y, label="Top Billed Customer", color="orange") 
  plt.legend()
  plt.xlabel("Invoiced Amount")
  plt.ylabel("")
  axes=plt.gca()
  axes.xaxis.grid()


  canvasbar = FigureCanvasTkAgg(figsecond, master=reportframe)
  canvasbar.draw() 
  canvasbar.get_tk_widget().place(x=0, y=370)

  # #second graph

  thrd_paid = "SELECT invoicetot from invoice GROUP BY Productserviceid ORDER by COUNT(Productserviceid) DESC LIMIT 1"

  fbcursor.execute(thrd_paid)
  paid_thrd_x= fbcursor.fetchone()
              


  thrd_paid_y = "select name from productservice where Productserviceid=(SELECT Productserviceid from invoice GROUP BY Productserviceid  ORDER by COUNT(Productserviceid) DESC LIMIT 1)"

  fbcursor.execute(thrd_paid_y)

  paid_thrd_y= fbcursor.fetchone()

  figlast = plt.figure(figsize=(9, 4), dpi=80)

  x=paid_thrd_y
  y=paid_thrd_x   
  plt.barh(x,y, label="Top Product Sale", color="blue") 
  plt.legend()
  plt.xlabel("Total Sales")
  plt.ylabel("")
  axes=plt.gca()
  axes.xaxis.grid()
  

  canvasbar = FigureCanvasTkAgg(figlast, master=reportframe)
  canvasbar.draw()
  canvasbar.get_tk_widget().place(x=650, y=370)  
  lbl_ir = Label(reportframe, text="Right Click On Each Chart For More Options", bg="white" , font=("arial", 8))
  lbl_ir.place(x=1115,y=85)


  lbl_invdtt2 =Label(reportframe, text="Screen Charts", bg="white" , font=("arial", 16))
  lbl_invdtt2.place(x=2, y=85)


  #______________________________________________Saiju______________________________________________________________________
  

  
  # def log():
  #   global user_name1
  #   user_name1=username1.get()
  #   passwd1=password1.get()
  #   if user_name1=="" or passwd1=="":
  #       Label(screen2,text='Plz enter both username and password',fg='red').place(x=85,y=260)
  #   else:
  #       sql='SELECT * FROM users WHERE username=%s AND password=%s'
  #       val=(user_name1,passwd1,)
  #       fbcursor.execute(sql,val)
  #       if fbcursor.fetchone()is not None:
  #           root(user_name1)
  #       else:
  #           messagebox.showinfo('Acess denied','Acess denied')
  
  # sql = "select * from users"
  # fbcursor.execute(sql)
  # user_log = fbcursor.fetchall()
  # if not user_log:
  #   pass
  # else:
  #     screen2=Toplevel()
  #     screen2.title('LOGIN')
  #     screen2.geometry('400x300')
  
  #     username1=StringVar()
  #     password1=StringVar()
  
  #     Label(screen2,text='Login Here').pack()
  #     uss1=Label(screen2,text='Username').place(x=50,y=70)
  #     ee1 = Entry(screen2,textvariable=username1).place(x=140,y=70)
  
  #     pss1=Label(screen2,text='Password').place(x=50,y=110)
  #     ee2=Entry(screen2,textvariable=password1).place(x=140,y=110)
  
  #     submitbtn1=Button(screen2,text='Login', width=20,height=2,command=log).place(x=70,y=200)
  
  # def check_empty() :
  #      if entry.get():
  #         pass     #your function where you want to jump
  #      else:
  #         messagebox.showinfo("Information", "Required entry")
  
  
  ######################## FRONT PAGE OF CUSTOMER SECTION   #######################################################################
  
      
  settingsframe=Frame(tab10, relief=GROOVE, bg="#f8f8f2")
  settingsframe.pack(side="top", fill=BOTH)
  
  settframe=Frame(settingsframe, bg="#f5f3f2", height=60)
  settframe.pack(side="top", fill=X)
  
  pn = Canvas(settframe, width=1, height=65, bg="#b3b3b3", bd=0)
  pn.pack(side="left", padx=(5, 2))
  pn = Canvas(settframe, width=1, height=65, bg="#b3b3b3", bd=0)
  pn.pack(side="left", padx=(0, 5))
  # def upload_filelogo():
  #   global imglogo,filename
  #   f_types =[('Png files','*.png'),('Jpg Files', '*.jpg')]
  #   filena = filedialog.askopenfilename(filetypes=f_types)
  #   shutil.copyfile(filena, os.getcwd()+'/images/'+filena.split('/')[-1])
  #   print(filena.split('/')[-1])
  #   image = Image.open(filena)
  #   resize_image = image.resize((280, 160))
  #   imglogo = ImageTk.PhotoImage(resize_image)
    # b2 = Button(secondtab,image=img)
    # b2.place(x=130, y=80)
  
    # btlogo = Button(secondtab,width=280,height=160,image=imglogo)
    # btlogo.place(x=580,y=280)
  global filename
  filename = ""
  def save_company():
    company_name = comname.get()
    company_address = caddent.get(1.0,END)
    company_mail = comemail.get()
    company_salestax =comsalestax.get()
    currency = comcur.get()
    currencysign = comcursign.get()
    currencysign_placement = comcursignpla.get()
    decimal_sepator = comdecsep.get()
    currency_example = comex.get()
    date_format = comdaf.get()
    example_dateformat = exd.get_date()
    tax = radtax.get()
    tax1name = tax1namee.get()
    tax1rate = tax1ratee.get()
    printtax1 = comptax1.get()
    tax2name = tax2namee.get()
    tax2rate = tax2ratee.get()
    printtax2 = comptax2.get()
    printimage = compimg.get()
    win_menu_colour = win_menu.get()
    radiobut = radema.get()
    cbut1 = checkb1.get()
    cbut2 = checkb2.get()
    cbut3 = checkb3.get()
    cbut4 = checkb4.get()
    cbut5 = checkb5.get()
    cbut6 = checkb6.get()
    est_prefix = est_str.get()
    est_header = win_menu1.get()
    est_text1 = est_str1.get()
    est_text2 = est_str2.get()
    est_text3 = est_str3.get()
    est_text4 = est_str4.get()
    est_text5 = est_str5.get()
    est_text6 = est_str6.get()
    est_predefined = est_str7.get(1.0,END)
    est_default = win_menu2.get()
    est_spin1 = spin1.get()
    adv_default = adv_win_menu8.get()

    child = exctree.get_children()
    var = json.dumps(child)
    sql = "select image from company"
    fbcursor.execute(sql)
    im = fbcursor.fetchone()
    sql = "select * from company"
    fbcursor.execute(sql)
    i = fbcursor.fetchall()
    if not i:
      if filename == "":
        print(12)
        sql = 'insert into company(name, address, email,salestaxno,currency,currencysign,currsignplace,  decimalseperator,excurrency,dateformat,exdate,taxtype,printimageornot,tax1name,tax1rate,printtax1,  tax2name,tax2rate,printtax2,attachment_file_type,miscellanoustab_cbutton1,miscellanoustab_cbutton2,miscellanoustab_cbutton3,miscellanoustab_cbutton4,miscellanoustab_cbutton5,miscellanoustab_cbutton6,Estimate_prefix,Customizeestimatetextlabels,Customizeestimatetextlabels1,Customizeestimatetextlabels2,Customizeestimatetextlabels3,Customizeestimatetextlabels4,Customizeestimatetextlabels5,Defaultestimatetemplate,Startingestimatenumber,Predefinedtextforestimates,adv_Selectedtemplatepreview,est_Headerboxbackgroundcolor) values(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s,%s,%s, %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'
        val = (company_name,company_address,company_mail,company_salestax,currency,currencysign,  currencysign_placement,decimal_sepator,currency_example,date_format,example_dateformat,tax,printimage,  tax1name,tax1rate,printtax1,tax2name,tax2rate,printtax2,radiobut,cbut1,cbut2,cbut3,cbut4,cbut5,cbut6,est_prefix,est_text1,est_text2,est_text3,est_text4,est_text5,est_text6,est_default,est_spin1,est_predefined,adv_default,est_header)
        fbcursor.execute(sql, val)
        fbilldb.commit()
      else:
        shutil.copyfile(filename, os.getcwd()+'/images/'+filename.split('/')[-1])
        sql = 'insert into company(name, address, email,salestaxno,currency,currencysign,currsignplace,  decimalseperator,excurrency,dateformat,exdate,taxtype,printimageornot,tax1name,tax1rate,printtax1,  tax2name,tax2rate,printtax2,image,attachment_file_type,miscellanoustab_cbutton1,miscellanoustab_cbutton2,miscellanoustab_cbutton3,miscellanoustab_cbutton4,miscellanoustab_cbutton5,miscellanoustab_cbutton6,Estimate_prefix,Customizeestimatetextlabels,Customizeestimatetextlabels1,Customizeestimatetextlabels2,Customizeestimatetextlabels3,Customizeestimatetextlabels4,Customizeestimatetextlabels5,Defaultestimatetemplate,Startingestimatenumber,Predefinedtextforestimates,adv_Selectedtemplatepreview,est_Headerboxbackgroundcolor) values(%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)'
        val = (company_name,company_address,company_mail,company_salestax,currency,currencysign,  currencysign_placement,decimal_sepator,currency_example,date_format,example_dateformat,tax,printimage,  tax1name,tax1rate,printtax1,tax2name,tax2rate,printtax2,filename.split('/')[-1],radiobut,cbut1,cbut2,cbut3,cbut4,cbut5,cbut6,est_prefix,est_text1,est_text2,est_text3,est_text4,est_text5,est_text6,est_default,est_spin1,est_predefined,adv_default,est_header)
        fbcursor.execute(sql, val)
        fbilldb.commit()
    else:
      if filename == "":
        sql = "update company set name=%s, address=%s, email=%s,salestaxno=%s,currency=%s,currencysign=%s,  currsignplace=%s,decimalseperator=%s,excurrency=%s,dateformat=%s,exdate=%s,taxtype=%s,  printimageornot=%s,tax1name=%s,tax1rate=%s,printtax1=%s,tax2name=%s,tax2rate=%s,printtax2=%s,attachment_file_type=%s,miscellanoustab_cbutton1=%s,miscellanoustab_cbutton2=%s,miscellanoustab_cbutton3=%s,miscellanoustab_cbutton4=%s,miscellanoustab_cbutton5=%s,miscellanoustab_cbutton6=%s,Estimate_prefix=%s,Customizeestimatetextlabels=%s,Customizeestimatetextlabels1=%s,Customizeestimatetextlabels2=%s,Customizeestimatetextlabels3=%s,Customizeestimatetextlabels4=%s,Customizeestimatetextlabels5=%s,Defaultestimatetemplate=%s,Startingestimatenumber=%s,Predefinedtextforestimates=%s,adv_Selectedtemplatepreview=%s,est_Headerboxbackgroundcolor=%s"
        val = (company_name,company_address,company_mail,company_salestax,currency,currencysign,  currencysign_placement,decimal_sepator,currency_example,date_format,example_dateformat,tax,printimage,  tax1name,tax1rate,printtax1,tax2name,tax2rate,printtax2,radiobut,cbut1,cbut2,cbut3,cbut4,cbut5,cbut6,est_prefix,est_text1,est_text2,est_text3,est_text4,est_text5,est_text6,est_default,est_spin1,est_predefined,adv_default,est_header)
        fbcursor.execute(sql, val)
        fbilldb.commit()
      else:
        shutil.copyfile(filename, os.getcwd()+'/images/'+filename.split('/')[-1])
        sql = "update company set name=%s, address=%s, email=%s,salestaxno=%s,currency=%s,currencysign=%s,  currsignplace=%s,decimalseperator=%s,excurrency=%s,dateformat=%s,exdate=%s,taxtype=%s,  printimageornot=%s,tax1name=%s,tax1rate=%s,printtax1=%s,tax2name=%s,tax2rate=%s,printtax2=%s,image=%s,attachment_file_type=%s,miscellanoustab_cbutton1=%s,miscellanoustab_cbutton2=%s,miscellanoustab_cbutton3=%s,miscellanoustab_cbutton4=%s,miscellanoustab_cbutton5=%s,miscellanoustab_cbutton6=%s,Estimate_prefix=%s,Customizeestimatetextlabels=%s,Customizeestimatetextlabels1=%s,Customizeestimatetextlabels2=%s,Customizeestimatetextlabels3=%s,Customizeestimatetextlabels4=%s,Customizeestimatetextlabels5=%s,Defaultestimatetemplate=%s,Startingestimatenumber=%s,Predefinedtextforestimates=%s,adv_Selectedtemplatepreview=%s,est_Headerboxbackgroundcolor=%s"
        val = (company_name,company_address,company_mail,company_salestax,currency,currencysign,  currencysign_placement,decimal_sepator,currency_example,date_format,example_dateformat,tax,printimage,  tax1name,tax1rate,printtax1,tax2name,tax2rate,printtax2,filename.split('/')[-1],radiobut,cbut1,cbut2,cbut3,cbut4,cbut5,cbut6,est_prefix,est_text1,est_text2,est_text3,est_text4,est_text5,est_text6,est_default,est_spin1,est_predefined,adv_default,est_header)
        fbcursor.execute(sql, val)
        fbilldb.commit()
      
      
  
  # addcustomerIcon = ImageTk.PhotoImage(Image.open("images/user_add.png"))
  save_setting = Button(settframe,compound="top", text="Save\nSettings",relief=RAISED,    command=save_company, image=saves, font=("arial", 8),bg="#f5f3f2", fg="black", height=55, bd=1, width=55)
  save_setting.pack(side="left", pady=3, ipadx=4)
  pn = Canvas(settframe, width=1, height=65, bg="#b3b3b3", bd=0)
  pn.pack(side="left", padx=(0, 5))
  
  def wiz_page():
    global filname
    filname = ""
    def upload_cfilelogo():
      global filname
      f_types =[('Png files','*.png'),('Jpg Files', '*.jpg')]
      filname = filedialog.askopenfilename(filetypes=f_types)
      shutil.copyfile(filname, os.getcwd()+'/images/'+filname.split('/')[-1])
      image = Image.open(filname)
      resize_image = image.resize((280, 140))
      imgclogo = ImageTk.PhotoImage(resize_image)
      btclogo = Button(wiz,width=280,height=140,image=imgclogo)
      btclogo.place(x=30,y=240)
      btclogo.photo = imgclogo
    def csave():
      company_name = company_namee.get()
      company_address = company_addresse.get('1.0', 'end-1c')
      company_email = company_emaile.get()
      salestaxregno = salestaxregnoe.get()
      cprint_logopic = cplogopic.get()
      sql = "select image from company"
      fbcursor.execute(sql)
      im = fbcursor.fetchone()
      sql = "select * from company"
      fbcursor.execute(sql)
      i = fbcursor.fetchall()
      if not i:
        if filname == "":
          sql = 'insert into company(name, address, email,salestaxno,printimageornot) values(%s, %s, %s, %s, %s)'
          val = (company_name,company_address,company_email,salestaxregno,cprint_logopic)
          fbcursor.execute(sql, val)
          fbilldb.commit()
        else:
          shutil.copyfile(filname, os.getcwd()+'/images/'+filname.split('/')[-1])
          sql = 'insert into company(name, address, email,salestaxno,printimageornot,image) values(%s, %s, %s, %s, %s, %s)'
          val = (company_name,company_address,company_email,salestaxregno,cprint_logopic,filname.split('/')[-1],)
          fbcursor.execute(sql, val)
          fbilldb.commit()
      else:
        if filname == "":
          sql = "update company set name=%s, address=%s, email=%s,salestaxno=%s,printimageornot=%s"
          val = (company_name,company_address,company_email,salestaxregno,cprint_logopic)
          fbcursor.execute(sql, val)
          fbilldb.commit()
        else:
          shutil.copyfile(filname, os.getcwd()+'/images/'+filname.split('/')[-1])
          sql = "update company set name=%s, address=%s, email=%s,salestaxno=%s,printimageornot=%s,image=%s"
          val = (company_name,company_address,company_email,salestaxregno,cprint_logopic,filname.split('/')[-1])
          fbcursor.execute(sql, val)
          fbilldb.commit()
      centry.delete(0, END)
      centry.insert(0, company_name)
      caddent.delete('1.0', END)
      caddent.insert('1.0', company_address)
      cemailentry.delete(0, END)
      cemailentry.insert(0, company_email)
      ste.delete(0, END)
      ste.insert(0, salestaxregno)
      if cprint_logopic == 1:
        primage.select()
      else:
        primage.deselect()
      try:
        image = Image.open("images/"+filname.split('/')[-1])
        resize_image = image.resize((280, 160))
        image = ImageTk.PhotoImage(resize_image)
        btlogo = Button(secondtab,width=280,height=160,image=image)
        btlogo.place(x=580,y=280)
        btlogo.photo = image
      except:
        pass
      wiz.destroy()


      
      

    
    wiz = Toplevel()
    wiz.geometry("500x449+400+167")
    wiz.title("Wellcome to Quick Start Wizard")
    sql = "select * from company"
    fbcursor.execute(sql)
    secctab = fbcursor.fetchone()
    comp_infor = Label(wiz,text="Enter Your Company Information",font='arial 13 bold',fg="blue")
    comp_infor.place(x=15,y=15)
    company_da_laframe = LabelFrame(wiz,text="Company data",height=180, width=460)
    company_da_laframe.place(x=15,y=40)
    company_name = Label(wiz,text="Company name")
    company_name.place(x=30,y=60)
    company_namee = Entry(wiz,width=50)
    company_namee.place(x=160,y=60)
    if  not secctab:
      pass
    else:
      company_namee.insert(0, secctab[1])
  
    company_address = Label(wiz,text="Company address")
    company_address.place(x=30,y=90)
    company_addresse = scrolledtext.ScrolledText(wiz,)
    company_addresse.place(x=160,y=90,width=250,height=60)
    if  not secctab:
      pass
    else:
      company_addresse.insert('1.0', secctab[2])

    company_email = Label(wiz,text="Email address")
    company_email.place(x=30,y=160)
    company_emaile = Entry(wiz,width=50)
    company_emaile.place(x=160,y=160)
    if  not secctab:
      pass
    else:
      company_emaile.insert(0, secctab[3])

    salestaxregno = Label(wiz,text="Sales Tax.Reg.No")
    salestaxregno.place(x=30,y=190)
    salestaxregnoe = Entry(wiz,width=50)
    salestaxregnoe.place(x=160,y=190)
    if  not secctab:
      pass
    else:
      salestaxregnoe.insert(0, secctab[4])
    
    
    company_da_laframe = LabelFrame(wiz,text="Company logo",height=190, width=460)
    company_da_laframe.place(x=15,y=220)
    try:
      image_wiz = Image.open("images/"+secctab[13])
      resize_image = image_wiz.resize((280, 140))
      image_wiza = ImageTk.PhotoImage(resize_image)
      btclogo = Button(wiz,width=280,height=140,image=image_wiza)
      btclogo.place(x=30,y=240)
      btclogo.photo = image_wiza
    except:
      pass
    cplogopic = BooleanVar()
    cprint_logopic = Checkbutton(wiz,text='Print logo picture',bg='white',onvalue =1,
                        offvalue = 0,variable=cplogopic)
    cprint_logopic.place(x=320,y=250)
    if  not secctab:
      pass
    else:
      if secctab[14] == 1:
        cprint_logopic.select()
      else:
        cprint_logopic.deselect()
      
    load_img = Button(wiz,text='Load logo image',command=upload_cfilelogo)
    load_img.place(x=320,y=360)
    save_com_wiz = Button(wiz,text='Save',width=10,command=csave)
    save_com_wiz.place(x=370,y=415)

  quick_start_wiz = Button(settframe,compound="top", text="Quick\nStart Wizard ",relief=RAISED,    command=wiz_page, image=photo, font=("arial", 8),bg="#f5f3f2", fg="black", height=55, bd=1, width=55)
  quick_start_wiz.pack(side="left", pady=3, ipadx=4)
  pn = Canvas(settframe, width=1, height=65, bg="#b3b3b3", bd=0)
  pn.pack(side="left", padx=(0, 5))
  
  
  
  invoi1label = Label(settingsframe, text="Settings", font=("arial", 18), bg="#f8f8f2")
  invoi1label.pack(side="left", padx=(20,0))
  
  global tab06
  m = ttk.Style()
  m.theme_use('default')
  m.configure('one.TNotebook.Tab', background="white", width=20, padding=10)
  tabControl = ttk.Notebook(tab10,style='one.TNotebook.Tab')
  tab01 = ttk.Frame(tabControl)
  tab02 = ttk.Frame(tabControl)
  tab03=  ttk.Frame(tabControl)
  tab04 = ttk.Frame(tabControl)
  tab05 = ttk.Frame(tabControl)
  tab06=  ttk.Frame(tabControl)
  tab07 = ttk.Frame(tabControl)
  tab08 = ttk.Frame(tabControl)
  tab09 =  ttk.Frame(tabControl)
  tab010=  ttk.Frame(tabControl)
  tabControl.add(tab01,image=invoices,compound = LEFT, text ='Miscellaneous',)
  tabControl.add(tab02,image=orders,compound = LEFT, text ='Company settings')
  tabControl.add(tab03,image=estimates,compound = LEFT, text ='Invoiced settings')
  tabControl.add(tab04,image=recurring,compound = LEFT, text ='Order settings')
  tabControl.add(tab05,image=purchase,compound = LEFT, text ='Estimate settings') 
  tabControl.add(tab06,image=expenses,compound = LEFT, text ='Administrator panel')
  tabControl.add(tab07,image=customer,compound = LEFT, text ='Advanced settings')
  tabControl.add(tab08,image=product,compound = LEFT, text ='Email templates')
  tabControl.add(tab09,image=reports,compound = LEFT, text ='Payments')
  tabControl.add(tab010,image=setting,compound = LEFT, text ='Purchase Order')
  tabControl.pack(expand = 1, fill ="both")
  
  ################### tab01 ###################################
  sql = "select * from company"
  fbcursor.execute(sql)
  sectab = fbcursor.fetchone()
  
  firsttab1=Frame(tab01, relief=GROOVE, bg="#f8f8f2")
  firsttab1.pack(side="top", fill=BOTH)
  
  firsttab=Frame(firsttab1, bg="#f5f3f2", height=700)
  firsttab.pack(side="top", fill=BOTH)
  
  messagelbframe=LabelFrame(firsttab,text="Menu and Window Color Style", height=60, width=180)
  messagelbframe.place(x=5, y=15)
  
  win_menu = StringVar()
  winstyle = ttk.Combobox(firsttab,textvariable=win_menu)
  winstyle.place(x=22 ,y=40)
  winstyle['values'] = ('whidbey','windows XP','windows 7','windows 8','windows 10')
  winstyle.current(0)
  fbill = Label(firsttab,text="F-Billing Revolution 2022",font="arial 12 bold").place(x=220,y=20)
  
  dbhost=LabelFrame(firsttab,text="Database Server Hostname", height=60, width=415)
  dbhost.place(x=5, y=85)
  
  db = Label(firsttab, text="DESKTOP-2K")
  db.place(x=15,y=110)
  
  exc=LabelFrame(firsttab,text="Extra cost name", height=180, width=415)
  exc.place(x=5, y=155)
  
  
  
  def insert_valueexc():
    i = varexc.get()
    if i == "":
      pass
    else:
      entryexc.delete(0, END)
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      if not com:
        messagebox.showinfo("Alert", "Create Company Settings.")
      else:
        companyid = com[0]
        sql = 'insert into extra_cost_name(companyid,extra_cost_name) values(%s,%s)'
        val = (companyid,i)
        fbcursor.execute(sql,val)
        fbilldb.commit()
        for record in exctree.get_children():
          exctree.delete(record)
        sql = 'select * from extra_cost_name'
        fbcursor.execute(sql)
        setexctree = fbcursor.fetchall()
        countp = 0
        for i in setexctree:
          immm = str(i[2])
          imn = str.replace(immm," ","_")
          exctree.insert(parent='', index='end', iid=countp, text='hello', values=(imn))
          countp += 1
  # new_value = String
        
        
  
  def edit_valueexc(event):
    selected_item = exctree.selection()[0]
    temp = list(exctree.item(selected_item , 'values'))
    entryexc.delete(0, END)
    entryexc.insert(0, temp)
  
  def save_valueexc():
    i = entryexc.get()
    if i == "":
      pass
    else:
      selected0 = exctree.focus()
      valuz1= exctree.item(selected0)["values"]
      idgettingextracnid=valuz1[0]
      print(i,idgettingextracnid)
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      companyid = com[0]
      if not com:
        pass
      else:
        sql = 'update extra_cost_name set extra_cost_name=%s where extra_cost_name=%s'
        val = (i,idgettingextracnid)
        fbcursor.execute(sql,val)
        fbilldb.commit()
        entryexc.delete(0, END)
        for record in exctree.get_children():
            exctree.delete(record)
        fbcursor.execute("select *  from extra_cost_name")
        pandsdata = fbcursor.fetchall()
        countp = 0
        for i in pandsdata:
          immm = str(i[2])
          imn = str.replace(immm," ","_")
          exctree.insert('', index='end', iid=countp, text='', values=(imn))
          countp += 1
    
    
  
  def del_valueexc():
    itemid = exctree.item(exctree.focus())["values"][0]
    sql = "delete from extra_cost_name where extra_cost_name = %s"
    val = (itemid, )
    fbcursor.execute(sql, val)
    fbilldb.commit()
    exctree.delete(exctree.selection()[0])
      
      
  
    
    
    
  
  
  
  scrollbarx = Scrollbar(firsttab, orient=HORIZONTAL)
  scrollbary = Scrollbar(firsttab, orient=VERTICAL)
  exctree = ttk.Treeview(firsttab, columns=("1"),height=40,selectmode='browse', yscrollcommand=scrollbary.set,   xscrollcommand=scrollbarx.set)
  # exctree["show"]='headings'
  scrollbary.config(command=exctree.yview)
  scrollbary.place(x=394,y=200,height=125)
  scrollbarx.config(command=exctree.xview)
  scrollbarx.place(x=15,y=310, width=380)
  exctree.heading('1', text="Extra cost name",)
  # exctree.column('#0', stretch=NO, minwidth=0, width=0)
  exctree.column("#0",width=0,anchor='c', stretch=False)
  exctree.column('1',width=378,anchor='c')
  exctree.place(x=15,y=200,height=115,width=380)
  exctree.bind('<Double-Button-1>' , edit_valueexc)
  sql = 'select * from extra_cost_name'
  fbcursor.execute(sql)
  setexctree = fbcursor.fetchall()
  countp = 0
  for i in setexctree:
      print(i[2])
      immm = str(i[2])
      imn = str.replace(immm," ","_")
      exctree.insert(parent='', index='end', iid=countp, text='', values=(imn))
      countp += 1
  # new_value = StringVar()
  
  # def edit_window_box(val):
      
  #     edit_window = Toplevel(root)
  #     edit_window.title("Edit the value or cancel")
  #     edit_window.geometry("1000x250")
  #     label_edit = Label(edit_window , text='Enter value to edit or press cancel', 
  #     font = ("Times New Roman", 10)).grid(column=0,row=1,padx=0, pady = 2)
  #     #create edit box
  #     edit_box = Entry(edit_window)
  #     edit_box.insert(0,val)
  #     edit_box.grid(column=1,row=1,padx=0,pady=2)
  #     #auto select edit window 
  #     edit_window.focus()
      
  #     def value_assignment(event):
  #         printing = edit_box.get()
  #         new_value.set(printing)
  #         #only destroy will not update the value (perhaps event keeps running in background)
  #         #quit allows event to stop n update value in tree but does not close the window in single click 
  #         #rather on dbl click shuts down entire app 
  #         edit_window.quit()
  #         edit_window.destroy()
      
  #     edit_window.bind('<Return>', value_assignment )
  
  #     B1 = Button(edit_window, text="Okay")
  #     B1.bind('<Button-1>',value_assignment)
  #     B1.grid(column=0,row=10,padx=0, pady = 20)
      
  #     B2 = Button(edit_window, text="Cancel", command = edit_window.destroy).grid(column=1,row=10,padx=10,   pady = 20)
  #     edit_window.mainloop()
      
  # #will explain
  # #variable to hold col value (col clicked)
  # shape1 = IntVar()
  # #tracks both col , row on mouse click
  # def tree_click_handler(event):
  #     cur_item = exctree.item(exctree.focus())
  #     col = exctree.identify_column(event.x)[1:]
  #     rowid = exctree.identify_row(event.y)[1:]
  #     #updates list
  #     shape1.set(col)
  #     try:
  #         x,y,w,h = exctree.bbox('I'+rowid,'#'+col)
  #     except:pass
  #     #tree.tag_configure("highlight", background="yellow")
  #     return(col)
      
  # #code linked to event    
  # exctree.bind('<ButtonRelease-1>', tree_click_handler)
  
  # def edit(event):
  #     try:
  #         selected_item = exctree.selection()[0]
  #         temp = list(exctree.item(selected_item , 'values'))
  #         tree_click_handler
  #         col_selected = int(shape1.get())-1
  #         edit_window_box(temp[col_selected])
  #         #do not run if edit window is open
  #         #use edit_window.mainloop() so value assign after window closes
  #         temp[col_selected] = new_value.get()
  #         exctree.item(selected_item, values= temp)
  #     except: pass
      
      
  # #binding allows to edit on screen double click
  # exctree.bind('<Double-Button-1>' , edit)
  varexc = StringVar()
  entryexc = Entry(firsttab,width=25,textvariable=varexc)
  entryexc.place(x=15,y=173)
  
  btexcadd = Button(firsttab,text="Add new line",command=insert_valueexc)
  btexcadd.place(x=175,y=171)
  
  btexcedit = Button(firsttab,text="Edit line   ",command=save_valueexc)
  btexcedit.place(x=260,y=171)
  btexcadd = Button(firsttab,text=" Delete line  ",command=del_valueexc)
  btexcadd.place(x=330,y=171)
  
  exc=LabelFrame(firsttab,text="Predefined text records for header and footer", height=180, width=415)
  exc.place(x=5, y=350)
  
  def insert_valuepre():
    i = prestr.get()
    if i == "":
      pass
    else:
      entrypre.delete(0, END)
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      if not com:
        messagebox.showinfo("Alert", "Create Company Settings.")
      else:
        companyid = com[0]
        sql = 'insert into header_and_footer(companyid,headerandfooter) values(%s,%s)'
        val = (companyid,i)
        fbcursor.execute(sql,val)
        fbilldb.commit()
        for record in pretree.get_children():
          pretree.delete(record)
        sql = 'select * from header_and_footer'
        fbcursor.execute(sql)
        setexctree = fbcursor.fetchall()
        countp = 0
        for i in setexctree:
          pret = str(i[2])
          pre = str.replace(pret," ","_")
          pretree.insert(parent='', index='end', iid=countp, text='hello', values=(pre))
          countp += 1
  # new_value = String
        
        
  
  def edit_valuepre(event):
    selected_item = pretree.selection()[0]
    temp = list(pretree.item(selected_item , 'values'))
    entrypre.delete(0, END)
    entrypre.insert(0, temp)
  
  def save_valuepre():
    i = prestr.get()
    if i == "":
      pass
    else:
      selected0 = pretree.focus()
      valuz1= pretree.item(selected0)["values"]
      idgettingextracnid=valuz1[0]
      print(i,idgettingextracnid)
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      companyid = com[0]
      if not com:
        pass
      else:
        sql = 'update header_and_footer set headerandfooter=%s where headerandfooter=%s'
        val = (i,idgettingextracnid)
        fbcursor.execute(sql,val)
        fbilldb.commit()
        entryexc.delete(0, END)
        for record in pretree.get_children():
            pretree.delete(record)
        fbcursor.execute("select *  from header_and_footer")
        pandsdata = fbcursor.fetchall()
        countp = 0
        for i in pandsdata:
          pret = str(i[2])
          pre = str.replace(pret," ","_")
          pretree.insert('', index='end', iid=countp, text='', values=(pre))
          countp += 1
    
    
  
  def del_valuepre():
    itemid = pretree.item(pretree.focus())["values"][0]
    print(itemid)
    sql = "delete from header_and_footer where headerandfooter = %s"
    val = (itemid,)
    fbcursor.execute(sql, val)
    fbilldb.commit()
    for record in pretree.get_children():
      pretree.delete(record)
    fbcursor.execute("select *  from header_and_footer")
    pandsdata = fbcursor.fetchall()
    countp = 0
    for i in pandsdata:
      pret = str(i[2])
      pre = str.replace(pret," ","_")
      pretree.insert('', index='end', iid=countp, text='', values=(pre))
      countp += 1
    
      
  
  scrollbarx = Scrollbar(firsttab, orient=HORIZONTAL)
  scrollbary = Scrollbar(firsttab, orient=VERTICAL)
  pretree = ttk.Treeview(firsttab, columns=("1"),height=400,     selectmode="extended",   yscrollcommand=scrollbary.set, xscrollcommand=scrollbarx.set)
  # exctree["show"]='headings'
  scrollbary.config(command=pretree.yview)
  scrollbary.place(x=395,y=400,height=115)
  scrollbarx.config(command=pretree.xview)
  scrollbarx.place(x=15,y=510, width=380)
  pretree.heading('1', text="header and footer",)
  pretree.column('#0', stretch=NO, minwidth=0, width=0)
  pretree.column('1', stretch=NO, width=378)
  pretree.place(x=15,y=400,height=115,width=380)
  pretree.bind('<Double-Button-1>' , edit_valuepre)
  sql = 'select * from header_and_footer'
  fbcursor.execute(sql)
  setexctree = fbcursor.fetchall()
  countp = 0
  for i in setexctree:
    pret = str(i[2])
    pre = str.replace(pret," ","_")
    pretree.insert(parent='', index='end', iid=countp, text='hello', values=(pre))
    countp += 1
  prestr = StringVar()
  entrypre = Entry(firsttab,width=25,textvariable=prestr)
  entrypre.place(x=15,y=370)
  btexcadd = Button(firsttab,text="Add new line",command=insert_valuepre)
  btexcadd.place(x=175,y=370)
  btpredit = Button(firsttab,text="Edit line   ",command=save_valuepre)
  btpredit.place(x=260,y=370)
  btexcadd = Button(firsttab,text=" Delete line   ",command=del_valuepre)
  btexcadd.place(x=330,y=370)
  
  ver = Label(firsttab,text="FREE version.Upgrade PRO version for all features and Ad free invoice")
  ver.place(x=480,y=15)
  
  
  chapass=LabelFrame(firsttab,text="Change Password", height=150, width=500)
  chapass.place(x=480, y=40)
  
  enterold = StringVar()
  lenold = Label(firsttab,text="Enter your old password")
  lenold.place(x=495,y=60)
  enold = Entry(firsttab,textvariable=enterold)
  enold.place(x=640,y=60)
  
  enternew = StringVar()
  ennew = Label(firsttab,text="New password")
  ennew.place(x=495,y=90)
  newpass = Entry(firsttab,textvariable=enternew)
  newpass.place(x=640,y=90)
  
  
  cnewpass = StringVar()
  cnp = Label(firsttab,text="Confirm new password")
  cnp.place(x=495,y=120)
  cnewp = Entry(firsttab,textvariable=cnewpass)
  cnewp.place(x=640,y=120)

  def change_pass():
    old_pass = enterold.get()
    new_pass = enternew.get()
    cnew_pass = cnewpass.get()
    usna = username1.get()
    print(usna)
    sql='SELECT * FROM users WHERE username=%s'
    val=(usna,)
    fbcursor.execute(sql,val)
    chpass = fbcursor.fetchone()
    print(chpass)
    if old_pass == "" or new_pass == "" or cnew_pass == "":
        messagebox.showerror('Password Error','Plz enter password')
    elif old_pass == chpass[4]:
      if new_pass == cnew_pass:
        sqll='UPDATE users SET password=%s,confirm_password=%s WHERE userID=%s'
        vall=(new_pass,cnew_pass,chpass[0])
        fbcursor.execute(sqll,vall,)
        fbilldb.commit()
        messagebox.showinfo('Updated','Password updated successfully')
      else:
        messagebox.showerror('Password Error','password is not match')
    else:
      messagebox.showerror('Password Error','Old Password is Incorrect')
  chabtn = Button(firsttab,text="Change password",command=change_pass)
  chabtn.place(x=840,y=150)
  
  termf=LabelFrame(firsttab,text="Terms of payment", height=150, width=500)
  termf.place(x=480, y=190)


  def insert_valueterm():
    first = entrytopstr.get()
    second = entrydsstr.get()
    if first == "" or second == "":
      pass
    else:
      entrytop.delete(0, END)
      entryds.delete(0, END)
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      if not com:
        messagebox.showinfo("Alert", "Create Company Settings.")
      else:
        companyid = com[0]
        sql = 'insert into terms_of_payment(companyid,terms_of_payment,Date_shift) values(%s,%s,%s)'
        val = (companyid,first,second)
        fbcursor.execute(sql,val)
        fbilldb.commit()
        for record in termtree.get_children():
          termtree.delete(record)
        sql = 'select * from terms_of_payment'
        fbcursor.execute(sql)
        setexctree = fbcursor.fetchall()
        countp = 0
        for i in setexctree:
          
          termtree.insert(parent='', index='end', iid=countp, text='hello', values=(i[2],i[3]))
          countp += 1
  # new_value = String
        
        
  
  def edit_valueterm(event):
    itemid = termtree.item(termtree.focus())["values"][0]
    sql = "select * from terms_of_payment where terms_of_payment = %s"
    val = (itemid,)
    fbcursor.execute(sql,val)
    editterm = fbcursor.fetchone()
    entrytop.delete(0, END)
    entryds.delete(0, END)
    entrytop.insert(0, editterm[2])
    entryds.insert(0, editterm[3])
  
  def save_valueterm():
    first = entrytopstr.get()
    second = entrydsstr.get()
    if first == "" or second == "":
      pass
    else:
      itemid = termtree.item(termtree.focus())["values"][0]
      sql1 = "select * from company"
      fbcursor.execute(sql1)
      com = fbcursor.fetchone()
      if not com:
        pass
      else:
        sql = "select * from terms_of_payment where terms_of_payment=%s"
        val = (itemid,)
        fbcursor.execute(sql,val)
        payt = fbcursor.fetchone()
        sql2 = 'update terms_of_payment set terms_of_payment=%s,Date_shift=%s where terms_of_paymentID=%s'
        val2 = (first,second,payt[0])
        fbcursor.execute(sql2,val2)
        fbilldb.commit()
        entrytop.delete(0, END)
        entryds.delete(0, END)
        for record in termtree.get_children():
          termtree.delete(record)
        fbcursor.execute("select *  from terms_of_payment")
        pandsdata = fbcursor.fetchall()
        countp = 0
        for i in pandsdata:
          
          termtree.insert(parent='', index='end', iid=countp, text='hello', values=(i[2],i[3]))
          countp += 1
    
    
  
  def del_valueterm():
    itemid = termtree.item(termtree.focus())["values"][0]
    print(itemid)
    sql = "delete from terms_of_payment where terms_of_payment = %s"
    val = (itemid,)
    fbcursor.execute(sql, val)
    fbilldb.commit()
    for record in termtree.get_children():
        termtree.delete(record)
    fbcursor.execute("select *  from terms_of_payment")
    pandsdata = fbcursor.fetchall()
    countp = 0
    for i in pandsdata:
      termtree.insert(parent='', index='end', iid=countp, text='hello', values=(i[2],i[3]))
      countp += 1
  
  
  
  scrollbarx = Scrollbar(firsttab, orient=HORIZONTAL)
  scrollbary = Scrollbar(firsttab, orient=VERTICAL)
  termtree = ttk.Treeview(firsttab, columns=("1","2"),height=400,selectmode="extended",   yscrollcommand=scrollbary.set, xscrollcommand=scrollbarx.set)
  # exctree["show"]='headings'
  scrollbary.config(command=termtree.yview)
  scrollbary.place(x=870,y=228,height=100)
  scrollbarx.config(command=termtree.xview)
  scrollbarx.place(x=495,y=313, width=380)
  termtree.heading('1', text="Terms of payment",)
  termtree.heading('2', text="Date shift (days)",)
  termtree.column('#0', stretch=NO, minwidth=0, width=0)
  termtree.column('1', stretch=NO, minwidth=0, width=250)
  termtree.column('2', stretch=NO, minwidth=0, width=128)
  termtree.place(x=495,y=235,height=80,width=380)
  termtree.bind('<Double-Button-1>' , edit_valueterm)

  sql = 'select * from terms_of_payment'
  fbcursor.execute(sql)
  termt = fbcursor.fetchall()
  countp = 0
  for i in termt:
      termtree.insert(parent='', index='end', iid=countp, text='hello', values=(i[2],i[3]))
      countp += 1
  entrytopstr = StringVar()
  entrytop = Entry(firsttab,width=25,textvariable=entrytopstr)
  entrytop.place(x=495,y=208)
  entrydsstr = StringVar()
  entryds = Entry(firsttab,textvariable=entrydsstr)
  entryds.place(x=670,y=208)
  bttermadd = Button(firsttab,text="Add new line",command=insert_valueterm)
  bttermadd.place(x=800,y=205)
  bttermedit = Button(firsttab,text="     Edit line  ",command=save_valueterm)
  bttermedit.place(x=890,y=205)
  bttermdel = Button(firsttab,text="  Delete line  ",command=del_valueterm)
  bttermdel.place(x=890,y=240)
  
  radem=LabelFrame(firsttab,text="Invoice/Oder/Estimate/P.order Email Attachment file type", height=60,   width=500)
  radem.place(x=480, y=340)
  radema = StringVar()
  radpdf = Radiobutton(firsttab,variable=radema,value="PDF",text='PDF')
  radpdf.place(x= 485, y= 360 )
  radhtml = Radiobutton(firsttab,variable=radema,value="HTML",text='HTML')
  radhtml.place(x= 660, y= 360 )
  if  not sectab:
    pass
  else:
    if sectab[22] == 'PDF':
      radpdf.select()
    elif sectab[22] == 'HTML':
      radhtml.select()
    else:
      pass
  
  checkb1 = IntVar()
  check1 = Checkbutton(firsttab,variable = checkb1, 
                        text="PDF attachment with Embedded Fonts (PDF file size will be larger,but readable on   all devices) ", 
                        onvalue =1 ,
                        offvalue = 0,
                        )
  
  check1.place(x=480,y=400)
  if  not sectab:
    pass
  else:
    if sectab[23] == 1:
      check1.select()
    else:
      check1.deselect()
  
  checkb2 = IntVar()
  check2 = Checkbutton(firsttab,variable = checkb2, 
                        text="invoice numbering with leading zero and current year", 
                        onvalue =1 ,
                        offvalue = 0,
                       )
  
  check2.place(x=480,y=420)
  if  not sectab:
    pass
  else:
    if sectab[24] == 1:
      check2.select()
    else:
      check2.deselect()
  
  checkb3 = IntVar()
  check3 = Checkbutton(firsttab,variable = checkb3, 
                        text="Order numbering with leading zero and current year", 
                        onvalue =1 ,
                        offvalue = 0,
                        )
  
  check3.place(x=480,y=440)
  if  not sectab:
    pass
  else:
    if sectab[25] == 1:
      check3.select()
    else:
      check3.deselect()
  
  checkb4 = IntVar()
  check4 = Checkbutton(firsttab,variable = checkb4, 
                        text="Estimate numbering with leading zero and current year", 
                        onvalue =1 ,
                        offvalue = 0,
                       )
  
  check4.place(x=480,y=460)
  if  not sectab:
    pass
  else:
    if sectab[26] == 1:
      check4.select()
    else:
      check4.deselect()
  
  checkb5 = IntVar()
  check5 = Checkbutton(firsttab,variable = checkb5, 
                        text="Purchsae order numbering with leading zero and current year", 
                        onvalue =1 ,
                        offvalue = 0,
                        )
  check5.place(x=480,y=480)
  if  not sectab:
    pass
  else:
    if sectab[27] == 1:
      check5.select()
    else:
      check5.deselect()
  
  checkb6 = IntVar()
  check6 = Checkbutton(firsttab,variable = checkb6, 
                        text="Confirmation before closing F-billing Revolution", 
                        onvalue =1 ,
                        offvalue = 0,
                      )
  
  check6.place(x=480,y=500)
  if  not sectab:
    pass
  else:
    if sectab[28] == 1:
      check6.select()
    else:
      check6.deselect()
  
  ################### tab02 ###################################
  sql = "select * from company"
  fbcursor.execute(sql)
  sectab = fbcursor.fetchone()
  print(sectab)
  
  
  secondtab1=Frame(tab02, relief=GROOVE, bg="#f8f8f2")
  secondtab1.pack(side="top", fill=BOTH)
  
  secondtab=Frame(secondtab1, bg="#f5f3f2", height=700)
  secondtab.pack(side="top", fill=BOTH)
  
  comdata=LabelFrame(secondtab,text="Company data", height=200, width=500)
  comdata.place(x=5, y=15)
  cname = Label(secondtab,text="Company name")
  cname.place(x=20, y =35)
  comname = StringVar()
  centry = Entry(secondtab,textvariable=comname)
  if  not sectab:
    pass
  else:
    centry.insert(0, sectab[1])
  centry.place(x=160,y=35,width=280)
  
  
  cadd = Label(secondtab,text="Company Address")
  cadd.place(x=20, y =65)
  caddent = scrolledtext.ScrolledText(secondtab)
  if  not sectab:
    pass
  else:
    caddent.insert('1.0', sectab[2])
  caddent.place(x=160,y=65,height=80,width=280)
  
  cemail = Label(secondtab,text="E-mail Address")
  cemail.place(x=20, y =160)
  comemail = StringVar()
  cemailentry = Entry(secondtab,textvariable=comemail)
  if  not sectab:
    pass
  else:
    cemailentry.insert(0, sectab[3])
  cemailentry.place(x=160,y=160,width=280)
  
  stl = Label(secondtab,text="sales Tax.Reg.No.")
  stl.place(x=20, y =185)
  comsalestax = StringVar()
  ste = Entry(secondtab,textvariable=comsalestax)
  if  not sectab:
    pass
  else:
    ste.insert(0, sectab[4])
  ste.place(x=160,y=185,width=280)
  
  
  curre=LabelFrame(secondtab,text="Currency", height=125, width=500)
  curre.place(x=5, y=220)
  currl = Label(secondtab,text="Currency")
  currl.place(x=20,y= 240)
  comcur = StringVar()
  currbox = ttk.Combobox(secondtab,width=10,textvariable=comcur)
  currbox['values'] =('ALL','AFN','ARS','AWG','AUD','AZN','BSD','BBD','BYN','BZD','BMD','BOB','BAM','BWP',  'BGN','BRL','BND','KHR','CAD','KYD','CLP','CNY','COP','CRC','HRK','CUP','CZK','DKK','DOP','XCD','EGP','SVC',  'EUR','FKP','FJD','GHS','GIP','GTQ','GGP','GYD','HNL','HKD','HUF','ISK','INR','IDR','IRR','IMP','ILS','JMD',  'JPY','JEP','KZT','KPW','KRW','KGS','LAK','LBP','LRD','MKD','MYR','MUR','MXN','MNT','MNT','MZN','NAD','NPR',  'ANG','NZD','NIO','NGN','NOK','OMR','PKR','PAB','PYG','PEN','PHP','PLN','QAR','RON','RUB','SHP','SAR','RSD',  'SCR','SGD','SBD','SOS','KRW','ZAR','LKR','SEK','CHF','SRD','SYP','TWD','THB','TTD','TRY','TVD','UAH','AED',  'GBP','USD','UYU','UZS','VEF','VND','YER','ZWD',)
  if  not sectab:
    pass
  elif sectab[5]:
    currbox.insert(0, sectab[5])
  currbox.place(x=80,y=240)
  
  def signpl(event):
    amsgpl = comcursignpla.get()
    currsign = comcursign.get()
    if amsgpl == "before amount":
      exbox.delete(0, END)
      exbox.insert(0, currsign+'8347.26')
    elif amsgpl == "after amount":
      exbox.delete(0, END)
      exbox.insert(0, '8347.26'+currsign)
    elif amsgpl == "before amount with space":
      exbox.delete(0, END)
      exbox.insert(0, currsign+'  8347.26')
    elif amsgpl == "after amount with space":
      exbox.delete(0, END)
      exbox.insert(0, '8347.26  '+currsign)
  
  
  currsignl = Label(secondtab,text="Currency sign")
  currsignl.place(x=180,y=240)
  comcursign = StringVar()
  currsignbox = ttk.Combobox(secondtab,width=10,textvariable=comcursign)
  currsignbox.bind("<<ComboboxSelected>>", signpl)
  currsignbox["values"] = ('Lek','','$','','$','','$','$','Br','BZ$','$','$b','KM','P','','R$','$','',  '$','$','$','','$','','kn','','K','kr','RD$','$','','$','','','$','','','Q','','$','L','$','Ft',  'kr','','Rp','','','','J$','','','','','','','','$','','RM','','$','',' .','MT','$','',  '','$','C$','','kr','','','B/.','Gs','S/.','','z','','lei','','','','.','','S','','R','',  'kr','CHF','','NT$','','TT$','','$','','.','$U','','Bs','','','Z$')
  if  not sectab:
    pass
  elif sectab[6]:
    currsignbox.insert(0, sectab[6])
  currsignbox.place(x=265,y=240)
  
  cspl = Label(secondtab,text="Currency sign placement")
  cspl.place(x=20,y=270)
  
  def amountsignspace(event):
    amsgpl = comcursignpla.get()
    currsign = comcursign.get()
    if amsgpl == "before amount":
      exbox.delete(0, END)
      exbox.insert(0, currsign+'8347.26')
    elif amsgpl == "after amount":
      exbox.delete(0, END)
      exbox.insert(0, '8347.26'+currsign)
    elif amsgpl == "before amount with space":
      exbox.delete(0, END)
      exbox.insert(0, currsign+'  8347.26')
    elif amsgpl == "after amount with space":
      exbox.delete(0, END)
      exbox.insert(0, '8347.26  '+currsign)
    
      
      
  comcursignpla = StringVar()
  cspe = ttk.Combobox(secondtab,width=24,textvariable=comcursignpla,)
  cspe.bind("<<ComboboxSelected>>", amountsignspace)
  cspe["values"] = ("before amount","after amount",'before amount with space',"after amount with space")
  if  not sectab:
    pass
  elif sectab[7]:
    cspe.insert(0, sectab[7])
  cspe.place(x=180,y=270)
  
  def decpl(event):
    dec = comdecsep.get()
    ex = comex.get()
    if dec == ",":
      var = str.replace(ex,".",",")
      exbox.delete(0, END)
      exbox.insert(0, var)
    elif dec == ".":
      var1 = str.replace(ex,",",".")
      exbox.delete(0, END)
      exbox.insert(0, var1)
  dsl = Label(secondtab,text="Decimal separator")
  dsl.place(x=20,y=300)
  comdecsep = StringVar()
  currbox = ttk.Combobox(secondtab,width=5,textvariable=comdecsep)
  currbox.bind("<<ComboboxSelected>>",decpl)
  currbox['values'] = ('.',',')
  if  not sectab:
    pass
  elif sectab[8]:
    currbox.insert(0, sectab[8])
  currbox.place(x=130,y=300)
  
  exl = Label(secondtab,text="Example")
  exl.place(x=185,y=300)
  comex = StringVar()
  exbox = Entry(secondtab,width=15,textvariable=comex)
  if  not sectab:
    exbox.insert(0, 84367.26)
  elif sectab[9]:
    exbox.insert(0, sectab[9])
  exbox.place(x=245,y=300)
  
  btred = Button(secondtab,text="Restore Default")
  btred.place(x=400,y=270)
  btsc = Button(secondtab,text="SET CURRENCY")
  btsc.place(x=400,y=300)
  
  datef=LabelFrame(secondtab,text="Date format", height=60, width=500)
  datef.place(x=5, y=355)
  
  def daffun(event):
    dafget = daf.get()
    if dafget == "mm-dd-yyyy":
      exd._set_text(exd._date.strftime('%m-%d-%Y'))
    elif dafget == "dd-mm-yyyy":
      exd._set_text(exd._date.strftime('%d-%m-%Y'))
    elif dafget == "yyy.mm.dd":
      exd._set_text(exd._date.strftime('%Y.%m.%d'))
    elif dafget == "mm/dd/yyyy":
      exd._set_text(exd._date.strftime('%m/%d/%Y'))
    elif dafget == "dd/mm/yyy":
      exd._set_text(exd._date.strftime('%d/%m/%Y'))
    elif dafget == "dd.mm.yyyy":
      exd._set_text(exd._date.strftime('%d.%m.%Y'))
    elif dafget == "yyyy/mm/dd":
      exd._set_text(exd._date.strftime('%Y/%m/%d'))
    
  
  comdaf = StringVar()
  daf = ttk.Combobox(secondtab,textvariable=comdaf)
  daf["values"] = ("Default",'mm-dd-yyyy','dd-mm-yyyy','yyyy.mm.dd','mm/dd/yyyy','dd/mm/yyyy','dd.mm.yyyy','yyyy/mm/dd')
  daf.bind("<<ComboboxSelected>>",daffun)
  if not sectab:
    pass
  elif sectab[10]:
    daf.insert(0, sectab[10])
  daf.place(x=60,y=380)
  
  
  exd = DateEntry(secondtab,)
  exd.place(x=280,y=380)
  if  not sectab:
    pass
  elif sectab[11]:
    exd.delete(0, END)
    exd.insert(0, sectab[11])
  
  tnr=LabelFrame(secondtab,text="Tax name and rate", height=200, width=500)
  tnr.place(x=560, y=15)
  
  stt=LabelFrame(secondtab,text="Select tax type", height=120, width=180)
  stt.place(x=580, y=30)
  def rtax1():
    ch = radtax.get()
    if ch == 1:
      tax1namel.place_forget()
      tax1namee.place_forget()
      tax1ratel.place_forget()
      tax1ratee.place_forget()
      tax1ratee.place_forget()
      ptax1.place_forget()
  
      tax2namel.place_forget()
      tax2namee.place_forget()
      tax2ratel.place_forget()
      tax2ratee.place_forget()
      ptax2.place_forget()
    elif ch == 2:
      tax1namel.place(x=800, y=40)
      tax1namee.place(x=880,y=40)
      tax1ratel.place(x=800, y=70)
      tax1ratee.place(x=880,y=70)
      ptax1.place(x=580,y=160)
      tax2namel.place_forget()
      tax2namee.place_forget()
      tax2ratel.place_forget()
      tax2ratee.place_forget()
      ptax2.place_forget()
    elif ch == 3:
      tax1namel.place(x=800, y=40)
      tax1namee.place(x=880,y=40)
      tax1ratel.place(x=800, y=70)
      tax1ratee.place(x=880,y=70)
      ptax1.place(x=580,y=160)
      tax2namel.place(x=800, y=110)
      tax2namee.place(x=880,y=110)
      tax2ratel.place(x=800, y=140)
      tax2ratee.place(x=880,y=140)
      ptax2.place(x=580,y=185)
    
  radtax = IntVar()
  rdnotax = Radiobutton(secondtab,text="Do not use TAX",value="1",variable=radtax,command=rtax1)
  rdnotax.place(x=590,y=50)
  
  
  rdtax1 = Radiobutton(secondtab,text="1 level of Tax",value="2",variable=radtax,command=rtax1)
  rdtax1.place(x=590,y=80)
  ptax01 = IntVar()
  tax1namel = Label(secondtab,text="Tax1 name")
  
  
  tax1namee = Entry(secondtab)
  if  not sectab:
    pass
  elif sectab[15]:
    tax1namee.insert(0, sectab[15])
  tax1namee.place(x=60,y=380)
  
  
  tax1ratel = Label(secondtab,text="Tax1 rate")
  
  
  tax1ratee = Entry(secondtab)
  if  not sectab:
    pass
  elif sectab[16]:
    tax1ratee.insert(0, sectab[16])
  
  comptax1 = BooleanVar()
  ptax1 = Checkbutton(secondtab,text="Print TAX1" ,onvalue =1 ,offvalue = 0,variable=comptax1)
  if  not sectab:
    pass
  elif sectab[17] == 1:
    ptax1.select()
  else:
    ptax1.deselect()
  
  rdtax2 = Radiobutton(secondtab,text="2 level of Tax",value="3",variable=radtax,command=rtax1)
  rdtax2.place(x=590,y=110)
  
  
  tax2namel = Label(secondtab,text="Tax2 name")
  
  
  tax2namee = Entry(secondtab)
  if  not sectab:
    pass
  elif sectab[18]:
    tax2namee.insert(0, sectab[18])
  
  tax2ratel = Label(secondtab,text="Tax2 rate")
  
  tax2ratee = Entry(secondtab)
  if  not sectab:
    pass
  elif sectab[19]:
    tax2ratee.insert(0, sectab[19])
  
  comptax2 = BooleanVar()
  ptax2 = Checkbutton(secondtab,text="Print TAX2" ,onvalue =1 ,offvalue = 0,variable=comptax2)
  if  not sectab:
    pass
  else:
    if sectab[20] == 1:
      ptax2.select()
    else:
      ptax2.deselect()
  
  if  not sectab:
    pass
  else:
    if sectab[12] == "1":
      rdnotax.select()
      tax1namel.place_forget()
      tax1namee.place_forget()
      tax1ratel.place_forget()
      tax1ratee.place_forget()
      tax1ratee.place_forget()
      ptax1.place_forget()
  
      tax2namel.place_forget()
      tax2namee.place_forget()
      tax2ratel.place_forget()
      tax2ratee.place_forget()
      ptax2.place_forget()
    elif sectab[12] == "2":
      tax1namel.place(x=800, y=40)
      tax1namee.place(x=880,y=40)
      tax1ratel.place(x=800, y=70)
      tax1ratee.place(x=880,y=70)
      ptax1.place(x=580,y=160)
      tax2namel.place_forget()
      tax2namee.place_forget()
      tax2ratel.place_forget()
      tax2ratee.place_forget()
      ptax2.place_forget()
      rdtax1.select()
    elif sectab[12] == "3":
      rdtax2.select()
      tax1namel.place(x=800, y=40)
      tax1namee.place(x=880,y=40)
      tax1ratel.place(x=800, y=70)
      tax1ratee.place(x=880,y=70)
      ptax1.place(x=580,y=160)
      tax2namel.place(x=800, y=110)
      tax2namee.place(x=880,y=110)
      tax2ratel.place(x=800, y=140)
      tax2ratee.place(x=880,y=140)
      ptax2.place(x=580,y=185)
    else:
      pass
  
  
  comlo=LabelFrame(secondtab,text="Comapny Logo", height=260, width=320)
  comlo.place(x=560, y=240)
  
  def upload_filelogo():
    global imglogo,filename
    f_types =[('Png files','*.png'),('Jpg Files', '*.jpg')]
    filename = filedialog.askopenfilename(filetypes=f_types)
    shutil.copyfile(filename, os.getcwd()+'/images/'+filename.split('/')[-1])
    image = Image.open(filename)
    resize_image = image.resize((280, 160))
    imglogo = ImageTk.PhotoImage(resize_image)
    # b2 = Button(secondtab,image=img)
    # b2.place(x=130, y=80)
  
    btlogo = Button(secondtab,width=280,height=160,image=imglogo)
    btlogo.place(x=580,y=280)
  
  try:
    image = Image.open("images/"+sectab[13])
    resize_image = image.resize((280, 160))
    image = ImageTk.PhotoImage(resize_image)
    btlogo = Button(secondtab,width=280,height=160,image=image)
    btlogo.place(x=580,y=280)
    btlogo.photo = image
  except:
    pass
  
    
  btloadim = Button(secondtab,text="Load logo image",command=upload_filelogo)
  btloadim.place(x=580,y=460)
  
  compimg = BooleanVar()
  primage = Checkbutton(secondtab,text="Print logo image",variable = compimg,onvalue =1 ,offvalue = 0)
  primage.place(x=740,y=460)
  
  ################### tab06 ###################################
  
  def user():
    display = displaystart.get()
    user_name = usernae.get()
    password = userpase.get()
    conformpassword = usercpase.get()
   
    create_inv = creinvbol.get()
    delete_inv = delinvbol.get()
    void_inv = voinvbol.get()
    mark_inv_as_paid = markinvbol.get()
    
    create_ord = creordbol.get()
    delete_ord = delordbol.get()
    turn_inv_ord = turninvbol.get()
    smsnofi = smsinvbol.get()
    
    create_est = creestimatebol.get()
    delete_est = delestimatebol.get()
    turn_est = turnestiinvbol.get()
  
    create_exp = creexpensebol.get()
    delete_exp = delexpensebol.get()
    rebill_exp = rebillexpebol.get()
    
    create_cus = crecusbol.get()
    delete_cus = delcusbol.get()
    imp_cus = impcusbol.get()
  
    create_pros = creprosbol.get()
    delete_pros = delprosbol.get()
    import_pros = impprosbol.get()
  
    runrep = runrepbol.get()
    gen_rec = genrecinvbol.get()
  
    create_pur = crepurbol.get()
    delete_pur = delpurbol.get()
  
    modify_inv = modifyinvbol.get()
    modify_ord = modifyordbol.get()
    modify_est = modifyestibol.get()
  
    if user_name=="" or password=="":
      messagebox.showerror('',"Please complete the form")
    else:
      sql='SELECT * FROM users WHERE username=%s'# selecting entire table from db,taking username , nd check   the existance
      val=(user_name,)
      fbcursor.execute(sql,val)
      if fbcursor.fetchone()is not None:
        sql='SELECT * FROM users WHERE username=%s'
        val=(user_name,)
        fbcursor.execute(sql,val)
        whuser = fbcursor.fetchone()
        print(whuser[0])
        if password == conformpassword:
        # messagebox.showerror('Warming','User name already exist!!')
          sqll= 'UPDATE users SET displayloginscreen=%s,username=%s,password=%s,confirm_password=%s,create_invoice=%s,delete_invoice=%s,void_invoice=%s,mark_invoice_as_paid=%s,create_order=%s,delete_order=%s,turn_order_into_invoice=%s,send_sms_nofitication=%s,create_estimate=%s,delete_estimate=%s,turn_oestimate_into_invoice=%s,create_expense=%s,delete_expense=%s,rebill_exprense=%s,create_customer=%s,delete_customer=%s,import_customer=%s,	create_product_service=%s,delete_product_service=%s,import_product_service=%s,run_reports=%s,generate_recurring_invoice=%s,create_purchase_order=%s,delete_purchase_order=%s,modify_invoice_settings=%s,modify_order_settings=%s,modify_estimate_settings=%s WHERE userID=%s'
          vall=(display,user_name,password,conformpassword,create_inv,delete_inv,void_inv,mark_inv_as_paid,  create_ord,delete_ord,turn_inv_ord,smsnofi,create_est,delete_est,turn_est,create_exp,delete_exp,  rebill_exp,create_cus,delete_cus,imp_cus,create_pros,delete_pros,import_pros,runrep,gen_rec,create_pur,  delete_pur,modify_inv,modify_ord,modify_est,whuser[0])
          fbcursor.execute(sqll,vall)
          fbilldb.commit()
        else:
          messagebox.showerror('Warming','Password not match!!')
      else:
        if password == conformpassword:
          sql="INSERT INTO users(displayloginscreen,username,password,confirm_password,create_invoice,  delete_invoice,void_invoice,mark_invoice_as_paid,create_order,delete_order,turn_order_into_invoice,  send_sms_nofitication,create_estimate,delete_estimate,turn_oestimate_into_invoice,	create_expense,	  delete_expense,rebill_exprense,create_customer,delete_customer,import_customer,	create_product_service,  delete_product_service,	import_product_service,run_reports,generate_recurring_invoice,  create_purchase_order,delete_purchase_order,modify_invoice_settings,modify_order_settings,  modify_estimate_settings) VALUES(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,  %s,%s,%s,%s,%s,%s,%s,%s)" #adding values into db
          val=(display,user_name,password,conformpassword,create_inv,delete_inv,void_inv,mark_inv_as_paid,  create_ord,delete_ord,turn_inv_ord,smsnofi,create_est,delete_est,turn_est,create_exp,delete_exp,  rebill_exp,create_cus,delete_cus,imp_cus,create_pros,delete_pros,import_pros,runrep,gen_rec,create_pur,  delete_pur,modify_inv,modify_ord,modify_est)
          fbcursor.execute(sql,val)
          fbilldb.commit()
          for record in uactree.get_children():
            uactree.delete(record)
          sql = "select * from users"
          fbcursor.execute(sql)
          sixuactree = fbcursor.fetchall()
          coutset = 0
          for i in sixuactree:
           uactree.insert(parent='', index='end', iid=coutset, text='hello', values=(i[3]))
           coutset += 1
        else:
          messagebox.showerror('Warming','Password not match!!')
        

   
    
  
  
  
  
    
  
    
  sixtab1=Frame(tab06, relief=GROOVE, bg="#f8f8f2")
  sixtab1.pack(side="top", fill=BOTH)
  
  sixtab=Frame(sixtab1, bg="#f5f3f2", height=700)
  sixtab.pack(side="top", fill=BOTH)
  
  displaystart = BooleanVar()
  displaylocsc = Checkbutton(sixtab,text="Display Login screen startup",onvalue =1 ,offvalue = 0,  variable=displaystart)
  displaylocsc.place(x=20,y=30)
  
  userac=LabelFrame(sixtab,text="User Acounts", height=400, width=260)
  userac.place(x=20, y=55)
  
  
  selper = Label(sixtab,text="Select username to modify permissions")
  selper.place(x=30,y=75)
  
  def focususer(event):
    itemid = uactree.item(uactree.focus())["values"][0]
    sql = "select * from users where username = %s"
    val = (itemid,)
    fbcursor.execute(sql,val)
    sixtabdataback = fbcursor.fetchone()
    print(sixtabdataback)
    usernae.delete(0,END)
    usernae.insert(0,itemid)
    if itemid == "adminstator":
        usernae.delete(0,END)
        usernae.insert(0,itemid)
        usernae["state"] = DISABLED
        creinv["state"] = DISABLED
        delinv["state"] = DISABLED
        voinv["state"] = DISABLED
        markinv["state"] = DISABLED
        creord["state"] = DISABLED
        delord["state"] = DISABLED
        turninv["state"] = DISABLED
        smsinv["state"] = DISABLED
        creestimate["state"] = DISABLED
        delestimate["state"] = DISABLED
        turnestiinv["state"] = DISABLED
        creexpense["state"] = DISABLED
        delexpense["state"] = DISABLED
        rebillexpe["state"] = DISABLED
        crecus["state"] = DISABLED
        delcus["state"] = DISABLED
        impcus["state"] = DISABLED
        crepros["state"] = DISABLED
        delpros["state"] = DISABLED
        imppros["state"] = DISABLED
        runrep["state"] = DISABLED
        genrecinv["state"] = DISABLED
        crepur["state"] = DISABLED
        delpur["state"] = DISABLED
        modifyinv["state"] = DISABLED
        modifyord["state"] = DISABLED
        modifyesti["state"] = DISABLED
    else:
        userpase.delete(0, END)
        usercpase.delete(0, END)
        usernae.delete(0,END)
        usernae.insert(0,itemid)
        usernae["state"] = NORMAL
        creinv["state"] = NORMAL
        delinv["state"] = NORMAL
        voinv["state"] = NORMAL
        markinv["state"] = NORMAL
        creord["state"] = NORMAL
        delord["state"] = NORMAL
        turninv["state"] = NORMAL
        smsinv["state"] = NORMAL
        creestimate["state"] = NORMAL
        delestimate["state"] = NORMAL
        turnestiinv["state"] = NORMAL
        creexpense["state"] = NORMAL
        delexpense["state"] = NORMAL
        rebillexpe["state"] = NORMAL
        crecus["state"] = NORMAL
        delcus["state"] = NORMAL
        impcus["state"] = NORMAL
        crepros["state"] = NORMAL
        delpros["state"] = NORMAL
        imppros["state"] = NORMAL
        runrep["state"] = NORMAL
        genrecinv["state"] = NORMAL
        crepur["state"] = NORMAL
        delpur["state"] = NORMAL
        modifyinv["state"] = NORMAL
        modifyord["state"] = NORMAL
        modifyesti["state"] = NORMAL
    if not sixtabdataback:
      userpase.delete(0, END)
      usercpase.delete(0, END)
      creinv.deselect()
      delinv.deselect()
      voinv.deselect()
      markinv.deselect()
      creord.deselect()
      delord.deselect()
      turninv.deselect()
      smsinv.deselect()
      creestimate.deselect()
      delestimate.deselect()
      turnestiinv.deselect()
      creexpense.deselect()
      delexpense.deselect()
      rebillexpe.deselect()
      crecus.deselect()
      delcus.deselect()
      impcus.deselect()
      crepros.deselect()
      delpros.deselect()
      imppros.deselect()
      runrep.deselect()
      genrecinv.deselect()
      crepur.deselect()
      delpur.deselect()
      modifyinv.deselect()
      modifyord.deselect()
      modifyesti.deselect()
      if itemid == "adminstator":
        usernae.delete(0,END)
        usernae.insert(0,itemid)
        usernae["state"] = DISABLED
        creinv["state"] = DISABLED
        delinv["state"] = DISABLED
        voinv["state"] = DISABLED
        markinv["state"] = DISABLED
        creord["state"] = DISABLED
        delord["state"] = DISABLED
        turninv["state"] = DISABLED
        smsinv["state"] = DISABLED
        creestimate["state"] = DISABLED
        delestimate["state"] = DISABLED
        turnestiinv["state"] = DISABLED
        creexpense["state"] = DISABLED
        delexpense["state"] = DISABLED
        rebillexpe["state"] = DISABLED
        crecus["state"] = DISABLED
        delcus["state"] = DISABLED
        impcus["state"] = DISABLED
        crepros["state"] = DISABLED
        delpros["state"] = DISABLED
        imppros["state"] = DISABLED
        runrep["state"] = DISABLED
        genrecinv["state"] = DISABLED
        crepur["state"] = DISABLED
        delpur["state"] = DISABLED
        modifyinv["state"] = DISABLED
        modifyord["state"] = DISABLED
        modifyesti["state"] = DISABLED
      else:
        userpase.delete(0, END)
        usercpase.delete(0, END)
        usernae.delete(0,END)
        usernae.insert(0,itemid)
        usernae["state"] = NORMAL
        creinv["state"] = NORMAL
        delinv["state"] = NORMAL
        voinv["state"] = NORMAL
        markinv["state"] = NORMAL
        creord["state"] = NORMAL
        delord["state"] = NORMAL
        turninv["state"] = NORMAL
        smsinv["state"] = NORMAL
        creestimate["state"] = NORMAL
        delestimate["state"] = NORMAL
        turnestiinv["state"] = NORMAL
        creexpense["state"] = NORMAL
        delexpense["state"] = NORMAL
        rebillexpe["state"] = NORMAL
        crecus["state"] = NORMAL
        delcus["state"] = NORMAL
        impcus["state"] = NORMAL
        crepros["state"] = NORMAL
        delpros["state"] = NORMAL
        imppros["state"] = NORMAL
        runrep["state"] = NORMAL
        genrecinv["state"] = NORMAL
        crepur["state"] = NORMAL
        delpur["state"] = NORMAL
        modifyinv["state"] = NORMAL
        modifyord["state"] = NORMAL
        modifyesti["state"] = NORMAL
    else:
      userpase.delete(0, END)
      usercpase.delete(0, END)
      userpase.insert(0, sixtabdataback[4])
      usercpase.insert(0, sixtabdataback[5])
      if sixtabdataback[6] == 1:
        creinv.select()
      else:
        creinv.deselect()
      if sixtabdataback[7] == 1:
        delinv.select()
      else:
        delinv.deselect()
      if sixtabdataback[8] == 1:
        voinv.select()
      else:
        voinv.deselect()
      if sixtabdataback[9] == 1:
        markinv.select()
      else:
        markinv.deselect()
      if sixtabdataback[10] == 1:
        creord.select()
      else:
        creord.deselect()
      if sixtabdataback[11] == 1:
        delord.select()
      else:
        delord.deselect()
      if sixtabdataback[12] == 1:
        turninv.select()
      else:
        turninv.deselect()
      if sixtabdataback[13] == 1:
        smsinv.select()
      else:
        smsinv.deselect()
      if sixtabdataback[14] == 1:
        creestimate.select()
      else:
        creestimate.deselect()
      if sixtabdataback[15] == 1:
        delestimate.select()
      else:
        delestimate.deselect()
      if sixtabdataback[16] == 1:
        turnestiinv.select()
      else:
        turnestiinv.deselect()
      if sixtabdataback[17] == 1:
        creexpense.select()
      else:
        creexpense.deselect()
      if sixtabdataback[18] == 1:
        delexpense.select()
      else:
        delexpense.deselect()
      if sixtabdataback[19] == 1:
        rebillexpe.select()
      else:
        rebillexpe.deselect()
      if sixtabdataback[20] == 1:
        crecus.select()
      else:
        crecus.deselect()
      if sixtabdataback[21] == 1:
        delcus.select()
      else:
        delcus.deselect()
      if sixtabdataback[22] == 1:
        impcus.select()
      else:
        impcus.deselect()
      if sixtabdataback[23] == 1:
        crepros.select()
      else:
        crepros.deselect()
      if sixtabdataback[24] == 1:
        delpros.select()
      else:
        delpros.deselect()
      if sixtabdataback[25] == 1:
        imppros.select()
      else:
        imppros.deselect()
      if sixtabdataback[26] == 1:
        runrep.select()
      else:
        runrep.deselect()
      if sixtabdataback[27] == 1:
        genrecinv.select()
      else:
        genrecinv.deselect()
      if sixtabdataback[28] == 1:
        crepur.select()
      else:
        crepur.deselect()
      if sixtabdataback[29] == 1:
        delpur.select()
      else:
        delpur.deselect()
      if sixtabdataback[30] == 1:
        modifyinv.select()
      else:
        modifyinv.deselect()
      if sixtabdataback[31] == 1:
        modifyord.select()
      else:
        modifyord.deselect()
      if sixtabdataback[32] == 1:
        modifyesti.select()
      else:
        modifyesti.deselect()
         
  
  scrollbarx = Scrollbar(sixtab, orient=HORIZONTAL)
  scrollbary = Scrollbar(sixtab, orient=VERTICAL)
  uactree = ttk.Treeview(sixtab, columns=("1"),height=400,selectmode="extended", yscrollcommand=scrollbary.  set, xscrollcommand=scrollbarx.set)
  scrollbary.config(command=uactree.yview)
  scrollbary.place(x=245,y=100,height=300)
  uactree.heading('1', text="Username",)
  uactree.column('#0', stretch=NO, minwidth=0, width=0)
  uactree.column('1', stretch=NO, minwidth=0, width=218)
  uactree.place(x=30,y=100,height=300,width=220)
  uactree.bind('<Double-Button-1>' , focususer)
  sql = "select * from users"
  fbcursor.execute(sql)
  sixuactree = fbcursor.fetchall()
  coutset = 0
  if not sixuactree:
    uactree.insert('', index='end', text='hello', values=("adminstator"))
  else:
    for i in sixuactree:
      uactree.insert(parent='', index='end', iid=coutset, text='hello', values=(i[3]))
      coutset += 1
  
  def adduser():
    uactree.insert('', index='end', text='hello', values=("Rename User"))
  
  btadd = Button(sixtab,text="Add new User",command=adduser)
  btadd.place(x=30,y=415)
  
  def users():
    itemid = uactree.item(uactree.focus())["values"][0]
    if itemid == "adminstator":
      messagebox.showerror('F-Billing Revolution', 'Cannot delete adminstator user.')
    else:
      delusermess = messagebox.askyesno("Delete user", "Are you sure to delete this user?")
      if delusermess == True:
        sql = "delete from users where username = %s"
        val = (itemid, )
        fbcursor.execute(sql, val)
        fbilldb.commit()
        for record in uactree.get_children():
          uactree.delete(record)
        sql = "select * from users"
        fbcursor.execute(sql)
        sixuactree = fbcursor.fetchall()
        coutset = 0
        for i in sixuactree:
          uactree.insert(parent='', index='end', iid=coutset, text='hello', values=(i[3]))
          coutset += 1
      else:
        pass
        
  
  btdus = Button(sixtab,text="Delete User",command=users)
  btdus.place(x=180,y=415)
  
  userpro=LabelFrame(sixtab,text="User Profile", height=400, width=750)
  userpro.place(x=300, y=55)
  
  
  userna = Label(sixtab,text="Username")
  userna.place(x=340,y=90)
  usernae = Entry(sixtab,)
  usernae.place(x=460,y=90)
  
  userpas = Label(sixtab,text="Password")
  userpas.place(x=340,y=120)
  userpase = Entry(sixtab,)
  userpase.place(x=460,y=120)
  
  usercpas = Label(sixtab,text="Confirm Password")
  usercpas.place(x=340,y=150)
  usercpase = Entry(sixtab,)
  usercpase.place(x=460,y=150)
  
  saveuserprofile = Button(sixtab,text="save user profile",command=user)
  saveuserprofile.place(x=650,y=120)
  
  creinvbol = BooleanVar()
  creinv = Checkbutton(sixtab,text="Create invoice",onvalue= 1 ,offvalue= 0,variable=creinvbol)
  creinv.place(x=340,y=200)
  delinvbol = BooleanVar()
  delinv = Checkbutton(sixtab,text="Delete invoice",onvalue= 1 ,offvalue= 0,variable=delinvbol)
  delinv.place(x=340,y=225)
  voinvbol = BooleanVar()
  voinv = Checkbutton(sixtab,text="Void invoice",onvalue= 1 ,offvalue= 0,variable=voinvbol)
  voinv.place(x=340,y=250)
  markinvbol = BooleanVar()
  markinv = Checkbutton(sixtab,text="Mark invoice as Paid",onvalue= 1 ,offvalue= 0,variable=markinvbol)
  markinv.place(x=340,y=275)
  
  creordbol = BooleanVar()
  creord = Checkbutton(sixtab,text="Create Order",onvalue= 1 ,offvalue= 0,variable=creordbol)
  creord.place(x=500,y=200)
  delordbol = BooleanVar()
  delord = Checkbutton(sixtab,text="Delete Order",onvalue= 1 ,offvalue= 0,variable=delordbol)
  delord.place(x=500,y=225)
  turninvbol = BooleanVar()
  turninv = Checkbutton(sixtab,text="Turn order into invoice",onvalue= 1 ,offvalue= 0,variable=turninvbol)
  turninv.place(x=500,y=250)
  smsinvbol = BooleanVar()
  smsinv = Checkbutton(sixtab,text="Send sms nofitication",onvalue= 1 ,offvalue= 0,variable=smsinvbol)
  smsinv.place(x=500,y=275)
  
  creestimatebol = BooleanVar()
  creestimate = Checkbutton(sixtab,text="Create estimate",onvalue= 1 ,offvalue= 0,variable=creestimatebol)
  creestimate.place(x=680,y=200)
  delestimatebol = BooleanVar()
  delestimate = Checkbutton(sixtab,text="Delete estimate",onvalue= 1 ,offvalue= 0,variable=delestimatebol)
  delestimate.place(x=680,y=225)
  turnestiinvbol = BooleanVar()
  turnestiinv = Checkbutton(sixtab,text="Turn estimates into invoice",onvalue= 1 ,offvalue= 0,  variable=turnestiinvbol)
  turnestiinv.place(x=680,y=250)
  
  creexpensebol = BooleanVar()
  creexpense = Checkbutton(sixtab,text="Create expenses",onvalue= 1 ,offvalue= 0,variable=creexpensebol)
  creexpense.place(x=880,y=200)
  delexpensebol = BooleanVar()
  delexpense = Checkbutton(sixtab,text="Delete expenses",onvalue= 1 ,offvalue= 0,variable=delexpensebol)
  delexpense.place(x=880,y=225)
  rebillexpebol = BooleanVar()
  rebillexpe = Checkbutton(sixtab,text="Rebill expenses",onvalue= 1 ,offvalue= 0,variable=rebillexpebol)
  rebillexpe.place(x=880,y=250)
  
  crecusbol = BooleanVar()
  crecus = Checkbutton(sixtab,text="Create customer",onvalue= 1 ,offvalue= 0,variable=crecusbol)
  crecus.place(x=340,y=320)
  delcusbol = BooleanVar()
  delcus = Checkbutton(sixtab,text="Delete customer",onvalue= 1 ,offvalue= 0,variable=delcusbol)
  delcus.place(x=340,y=340)
  impcusbol = BooleanVar()
  impcus = Checkbutton(sixtab,text="Import customer",onvalue= 1 ,offvalue= 0,variable=impcusbol)
  impcus.place(x=340,y=360)
  
  creprosbol = BooleanVar()
  crepros = Checkbutton(sixtab,text="Create product\services",onvalue= 1 ,offvalue= 0,variable=creprosbol)
  crepros.place(x=500,y=320)
  delprosbol = BooleanVar()
  delpros = Checkbutton(sixtab,text="Delete product\services",onvalue= 1 ,offvalue= 0,variable=delprosbol)
  delpros.place(x=500,y=340)
  impprosbol = BooleanVar()
  imppros = Checkbutton(sixtab,text="Import product\services",onvalue= 1 ,offvalue= 0,variable=impprosbol)
  imppros.place(x=500,y=360)
  
  runrepbol = BooleanVar()
  runrep = Checkbutton(sixtab,text="Run reports",onvalue= 1 ,offvalue= 0,variable=runrepbol)
  runrep.place(x=680,y=320)
  genrecinvbol = BooleanVar()
  genrecinv = Checkbutton(sixtab,text="Generate recurring invoices",onvalue= 1 ,offvalue= 0,  variable=genrecinvbol)
  genrecinv.place(x=680,y=340)
  
  crepurbol = BooleanVar()
  crepur = Checkbutton(sixtab,text="Create Purchase order",onvalue =1 ,offvalue = 0,variable=crepurbol)
  crepur.place(x=880,y=320)
  delpurbol = BooleanVar()
  delpur = Checkbutton(sixtab,text="Delete Purchase order",onvalue =1 ,offvalue = 0,variable=delpurbol)
  delpur.place(x=880,y=340)
  
  undersetlab = Label(sixtab,text="Under Settings menu tab")
  undersetlab.place(x=340,y=400)
  
  modifyinvbol = BooleanVar()
  modifyinv = Checkbutton(sixtab,text="Modify invoice settings",onvalue =1 ,offvalue = 0,variable=modifyinvbol)
  modifyinv.place(x=340,y=425)
  
  modifyordbol = BooleanVar()
  modifyord = Checkbutton(sixtab,text="Modify order settings",onvalue =1 ,offvalue = 0,variable=modifyordbol)
  modifyord.place(x=500,y=425)
  
  modifyestibol = BooleanVar()
  modifyesti = Checkbutton(sixtab,text="Modify estimate settings",onvalue =1 ,offvalue = 0,  variable=modifyestibol)
  modifyesti.place(x=680,y=425)

################### tab05 ###################################
  fifthtab1=Frame(tab05, relief=GROOVE, bg="#f8f8f2")
  fifthtab1.pack(side="top", fill=BOTH)

  fifthtab=Frame(fifthtab1, bg="#f5f3f2", height=700)
  fifthtab.pack(side="top", fill=BOTH)

  sql = "select * from company"
  fbcursor.execute(sql)
  estdata = fbcursor.fetchone()
  print(estdata)



  ver = Label(fifthtab,text="Estimate# prefix")
  ver.place(x=5,y=40)

  est_str = StringVar() 
  est_entry = Entry(fifthtab, textvariable=est_str)
  est_entry.place(x=100,y=40)
  if not estdata:
    est_str.set('EST')
  else:
    est_entry.insert(0, estdata[29])

  ver = Label(fifthtab,text="Starting estimate number")
  ver.place(x=25,y=80)

  def callback(input):
      
    if input.isdigit():
        print(input)
        return True
                          
    elif input is " ":
        print(input)
        return True
  
    else:
        print(input)
        return False

  spin1 = Spinbox(fifthtab,from_=0,to=1000000,width=15)
  reg = fifthtab.register(callback)
  
  spin1.config(validate ="key", 
         validatecommand =(reg, '%S'))
  if not estdata:
    pass
  else:
    spin1.delete(0, END)
    spin1.insert(0,estdata[38])
  spin1.place(x=50,y=100)

  ver = Label(fifthtab,text="Header box background color")
  ver.place(x=5,y=140)

  win_menu1 = StringVar()
  winstyle1 = ttk.Combobox(fifthtab,textvariable=win_menu1)
  #est_win1 = win_menu1.get()
  winstyle1['values'] = ('Default','Black','Maroon','Green','Olive','Navy','Purple','Teal','Gray','Silver','Red','Lime','Yellow','Blue','Fuchsia','Aqua','White','ScrollBar','Background','ActiveCaption','InactiveCaption','Menu','Window','WindowFrame','MenuText','WindowText','CaptionText','ActiveBorder','InactiveBorder','AppWorkSpace','Highlight','HighlightText','BtnFace','InactiveCaptionText','BtnHighlight','3DDkShadow','3DLight','InfoText','InfoBk','Custom')
  if not estdata:
    winstyle1.current(0)
  else:
    winstyle1.insert(0, estdata[30])
  winstyle1.place(x=6 ,y=160)
  #winstyle1.current(0)

  ver = Label(fifthtab,text="Customize Estimate text labels")
  ver.place(x=5,y=190)
  
  est_str1 = StringVar() 
  est_lbx1 = Entry(fifthtab, width=30,textvariable=est_str1)
  # est_str1.set('Estimate')
  if not estdata:
    est_str1.set('Estimate')
  else:
    est_lbx1.insert(0, estdata[31])
  est_lbx1.place(x=5,y=220)
  
  est_str2 = StringVar() 
  est_lbx2 = Entry(fifthtab, width=30,textvariable=est_str2)
  if not estdata:
    est_str2.set('Estimate#')
  else:
    est_lbx2.insert(0,estdata[33])
  est_lbx2.place(x=5,y=240)
  
  
  est_str3 = StringVar() 
  est_lbx3 = Entry(fifthtab,width=30,textvariable=est_str3)
  if not estdata:
    est_str3.set('Estimate date')
  else:
    est_lbx3.insert(0, estdata[34])
  est_lbx3.place(x=5,y=260) 

  est_str4 = StringVar() 
  est_lbx4 = Entry(fifthtab,width=30,textvariable=est_str4)
  if not estdata:
    est_str4.set('Due date')
  else:
    est_lbx4.insert(0, estdata[35])
  est_lbx4.place(x=5,y=280)

  est_str5 = StringVar() 
  est_lbx5 = Entry(fifthtab,width=30,textvariable=est_str5)
  if not estdata:
    est_str5.set('Estimate to')
  else:
    est_lbx5.insert(0, estdata[36])
  est_lbx5.place(x=5,y=300)

  est_str6 = StringVar() 
  est_lbx6 = Entry(fifthtab, width=30,textvariable=est_str6)
  if not estdata:
    est_str6.set('Estimate total')
  else:
    est_lbx6.insert(0, estdata[37])
  est_lbx6.place(x=5,y=320)


  ver = Label(fifthtab,text="Default Estimate template(example,click on preview for mouse scrolling)")
  ver.place(x=248,y=55 )

  ver = Label(fifthtab,text="Default Estimate template")
  ver.place(x=619,y=40)



  messagelbframe=LabelFrame(fifthtab,text="Predefined terms and conditions text for estimates", height=70, width=980)
  messagelbframe.place(x=248, y=396)

  
  # est_str7 = StringVar() 
  # entry1=Entry(fifthtab, width=155,textvariable=est_str7)
  # if not estdata:
  #   pass
  # else:
  #   entry1.insert(0, estdata[39])
  # entry1.place(x=260, y=415, height=36)
  
  est_str7 = scrolledtext.ScrolledText(fifthtab)
  if  not estdata:
    pass
  else:
    est_str7.insert('1.0', estdata[39])
  est_str7.place(x=260,y=415,height=38,width=950)


  def restore_defaulttt1():
        est_lbx1.delete(0, 'end')
        est_lbx1.insert(0, 'Estimate')
        est_lbx2.delete(0, 'end')
        est_lbx2.insert(0,'Estimate#')
        est_lbx3.delete(0, 'end')
        est_lbx3.insert(0, 'Estimate date')
        est_lbx4.delete(0, 'end')
        est_lbx4.insert(0, 'Due date')
        est_lbx5.delete(0, 'end')
        est_lbx5.insert(0, 'Estimate to')
        est_lbx6.delete(0, 'end')
        est_lbx6.insert(0, 'Estimate total')

  bttermadd_01 = Button(fifthtab,text="Restore defaults", command=restore_defaulttt1)
  bttermadd_01.place(x=32,y=430)


#------------Professional 1 (logo on left side)-------------
  def maindropmenu(event):
      menuvar=win_menu2.get()
      print(menuvar,"hello")
      sql = "select * from company"
      fbcursor.execute(sql)
      estdata1 = fbcursor.fetchone()

      if menuvar == 'Professional 1 (logo on left side)':
        frame = Frame(fifthtab, width=953, height=300)
        frame.pack(expand=True, fill=BOTH)
        frame.place(x=247,y=90)
        canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
              
        vertibar=Scrollbar(frame, orient=VERTICAL)
        vertibar.pack(side=RIGHT,fill=Y)
        vertibar.config(command=canvas.yview)
          
        canvas.config(width=953,height=300)
        canvas.config(yscrollcommand=vertibar.set)
        canvas.pack(expand=True,side=LEFT,fill=BOTH)
        canvas.create_rectangle(100, 8, 850, 687 , outline='yellow',fill='white')
        canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
        try:
          est_image = Image.open("images/"+estdata1[13])
          est_resize_image = est_image.resize((200,100))
          est_image = ImageTk.PhotoImage(est_resize_image)

          est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
          window_image = canvas.create_window(175, 45, anchor="nw", window=est_btlogo)
          est_btlogo.photo = est_image
        except:
          pass  
        canvas.create_text(202, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(215, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(200, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(191, 220, text="Terms", fill="black", font=('Helvetica 11'))
        canvas.create_text(205, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(340, 220, text="NET 15", fill="black", font=('Helvetica 11'))
          
        canvas.create_text(720, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
        # canvas.create_text(700, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'), width=125)
        T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
        T_address.tag_configure('tag_name',justify='right')
        T_address.insert('1.0', estdata1[2])
        T_address.tag_add('tag_name','1.0', 'end')
        T_address_window = canvas.create_window(520, 80, anchor="nw", window=T_address)
        canvas.create_text(695, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
        canvas.create_text(700, 205, text=" "+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
        canvas.create_text(706, 225, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))
          
        canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
        canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))
      
        s = ttk.Style()
        s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

        tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')

        tree.column("# 1", anchor=E, stretch=NO, width=100)
        tree.heading("# 1", text="ID/SKU")
        tree.column("# 2", anchor=E, stretch=NO, width=350)
        tree.heading("# 2", text="Product/Service - Description")
        tree.column("# 3", anchor=E, stretch=NO, width=80)
        tree.heading("# 3", text="Quantity")
        tree.column("# 4", anchor=E, stretch=NO, width=90)
        tree.heading("# 4", text="Unit Price")
        tree.column("# 5", anchor=E, stretch=NO, width=80)
        tree.heading("# 5", text="Price")
          
        window = canvas.create_window(120, 340, anchor="nw", window=tree)

        canvas.create_line(120, 390, 820, 390 )
        canvas.create_line(120, 340, 120, 365 )
        canvas.create_line(120, 365, 120, 390 )
        canvas.create_line(820, 340, 820, 540 )
        canvas.create_line(740, 340, 740, 540 )
        canvas.create_line(570, 340, 570, 540 )
        canvas.create_line(570, 415, 820, 415 )
        canvas.create_line(570, 440, 820, 440 )
        canvas.create_line(570, 465, 820, 465 )
        canvas.create_line(570, 490, 820, 490 )
        canvas.create_line(570, 515, 820, 515 )
        canvas.create_line(650, 340, 650, 390 )
        canvas.create_line(220, 340, 220, 390 )
        canvas.create_line(570, 540, 820, 540 )

        canvas.create_text(165, 372, text="PROD-0001", fill="black", font=('Helvetica 10'))
        canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
        canvas.create_text(610, 372, text="1", fill="black", font=('Helvetica 10'))
    
        if comcursignpla.get() == "before amount":
          canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "after amount":
          canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(704, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))

        else:
          pass
        # canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))
        
        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
        else:
          pass

        # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))
        
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

        canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))
          
        canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 608, 795, 608)
        # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10')) 
        T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
        T.insert(END, estdata1[39])
        T_window = canvas.create_window(155, 612, anchor="nw", window=T)

        canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
          

#----------------Professional 2 (logo on right side)------------------
      elif menuvar == 'Professional 2 (logo on right side)':
        frame = Frame(fifthtab, width=953, height=300)
        frame.pack(expand=True, fill=BOTH)
        frame.place(x=247,y=90)
      
        canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
          
        vertibar=Scrollbar(frame, orient=VERTICAL)
        vertibar.pack(side=RIGHT,fill=Y)
        vertibar.config(command=canvas.yview)
        canvas.config(width=953,height=300)
          
        canvas.config(yscrollcommand=vertibar.set)
        canvas.pack(expand=True,side=LEFT,fill=BOTH)
        canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
        canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
        try:
          est_image = Image.open("images/"+estdata1[13])
          est_resize_image = est_image.resize((200,100))
          est_image = ImageTk.PhotoImage(est_resize_image)

          est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
          window_image = canvas.create_window(500, 45, anchor="nw", window=est_btlogo)
          est_btlogo.photo = est_image
        except:
          pass  
        canvas.create_text(250, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
        # canvas.create_text(215, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
        T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
        T_address.tag_configure('tag_name',justify='right')
        T_address.insert('1.0', estdata1[2])
        T_address.tag_add('tag_name','1.0', 'end')
        T_address_window = canvas.create_window(100, 80, anchor="nw", window=T_address)
        #T_address_window = canvas.create_window(175, 80, anchor="nw", window=T_address)

        canvas.create_text(215, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
        canvas.create_text(225, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
        canvas.create_text(232, 225, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))
          
        canvas.create_text(502, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(515, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(500, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(491, 220, text="Terms", fill="black", font=('Helvetica 11'))
        canvas.create_text(505, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
        canvas.create_text(690, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(690, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(690, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(680, 220, text="NET 15", fill="black", font=('Helvetica 11'))      
          
        canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
        canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

        s = ttk.Style()
        s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

        tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')
          
        tree.column("# 1", anchor=E, stretch=NO, width=100)
        tree.heading("# 1", text="ID/SKU")
        tree.column("# 2", anchor=E, stretch=NO, width=350)
        tree.heading("# 2", text="Product/Service - Description")
        tree.column("# 3", anchor=E, stretch=NO, width=80)
        tree.heading("# 3", text="Quantity")
        tree.column("# 4", anchor=E, stretch=NO, width=90)
        tree.heading("# 4", text="Unit Price")
        tree.column("# 5", anchor=E, stretch=NO, width=80)
        tree.heading("# 5", text="Price")
          
        window = canvas.create_window(120, 340, anchor="nw", window=tree)

        canvas.create_line(120, 390, 820, 390 )
        canvas.create_line(120, 340, 120, 365 )
        canvas.create_line(120, 365, 120, 390 )
        canvas.create_line(820, 340, 820, 540 )
        canvas.create_line(740, 340, 740, 540 )
        canvas.create_line(570, 340, 570, 540 )
        canvas.create_line(570, 415, 820, 415 )
        canvas.create_line(570, 440, 820, 440 )
        canvas.create_line(570, 465, 820, 465 )
        canvas.create_line(570, 490, 820, 490 )
        canvas.create_line(570, 515, 820, 515 )
        canvas.create_line(650, 340, 650, 390 )
        canvas.create_line(220, 340, 220, 390 )
        canvas.create_line(570, 540, 820, 540 )

        canvas.create_text(165, 372, text="PROD-0001", fill="black", font=('Helvetica 10'))
        canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
        canvas.create_text(610, 372, text="1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(704, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
        else:
          pass

        # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))
        
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

        canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

        canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 608, 795, 608)
        # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
        T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
        T.insert(END, estdata1[39])
        T_window = canvas.create_window(155, 612, anchor="nw", window=T)
        canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
#----------------Simplified 1 (logo on left side)------------------ 
      elif menuvar == 'Simplified 1 (logo on left side)':
        print('hello')
        frame = Frame(fifthtab, width=953, height=300)
        frame.pack(expand=True, fill=BOTH)
        frame.place(x=247,y=90)
        canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))

        vertibar=Scrollbar(frame, orient=VERTICAL)
        vertibar.pack(side=RIGHT,fill=Y)
        vertibar.config(command=canvas.yview)
        canvas.config(width=953,height=300)

        canvas.config(yscrollcommand=vertibar.set)
        canvas.pack(expand=True,side=LEFT,fill=BOTH)
        canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
        canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
        try:
          est_image = Image.open("images/"+estdata1[13])
          est_resize_image = est_image.resize((200,100))
          est_image = ImageTk.PhotoImage(est_resize_image)

          est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
          window_image = canvas.create_window(175, 45, anchor="nw", window=est_btlogo)
          est_btlogo.photo = est_image
        except:
          pass  
        canvas.create_text(202, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(215, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(200, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(191, 220, text="Terms", fill="black", font=('Helvetica 11'))
        canvas.create_text(205, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(350, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(340, 220, text="NET 15", fill="black", font=('Helvetica 11'))      

        canvas.create_text(720, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
        #canvas.create_text(710, 200, text=caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
        T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
        T_address.tag_configure('tag_name',justify='right')
        T_address.insert('1.0', estdata1[2])
        T_address.tag_add('tag_name','1.0', 'end')
        T_address_window = canvas.create_window(520, 80, anchor="nw", window=T_address)

        canvas.create_text(708, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
        canvas.create_text(710, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
          
        canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
        canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

        s = ttk.Style()
        s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

        tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_1.Treeview')
          
        tree.column("# 1", anchor=E, stretch=NO, width=530)
        tree.heading("# 1", text="Product/Service - Description")
        tree.column("# 2", anchor=E, stretch=NO, width=90)
        tree.heading("# 2", text="Quantity")
        tree.column("# 3", anchor=E, stretch=NO, width=80)
        tree.heading("# 3", text="Price")
          
        window = canvas.create_window(120, 340, anchor="nw", window=tree)

        canvas.create_line(120, 390, 820, 390 )
        canvas.create_line(120, 340, 120, 365 )
        canvas.create_line(120, 365, 120, 390 )
        canvas.create_line(820, 340, 820, 540 )
        canvas.create_line(740, 340, 740, 540 )
        canvas.create_line(570, 390, 570, 540 )
        canvas.create_line(570, 415, 820, 415 )
        canvas.create_line(570, 440, 820, 440 )
        canvas.create_line(570, 465, 820, 465 )
        canvas.create_line(570, 490, 820, 490 )
        canvas.create_line(570, 515, 820, 515 )
        canvas.create_line(650, 340, 650, 390 )
        canvas.create_line(570, 540, 820, 540 )

      
        canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
        canvas.create_text(710, 372, text="1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

        canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

        canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 608, 795, 608)
        # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
        T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
        T.insert(END, estdata1[39])
        T_window = canvas.create_window(155, 612, anchor="nw", window=T)
        canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))

#----------------Simplified 2 (logo on right side)------------------ 
      elif menuvar == 'Simplified 2 (logo on right side)':
        frame = Frame(fifthtab, width=953, height=300)
        frame.pack(expand=True, fill=BOTH)
        frame.place(x=247,y=90)

        canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))

        vertibar=Scrollbar(frame, orient=VERTICAL)
        vertibar.pack(side=RIGHT,fill=Y)
        vertibar.config(command=canvas.yview)
        canvas.config(width=953,height=300)

        canvas.config(yscrollcommand=vertibar.set)
        canvas.pack(expand=True,side=LEFT,fill=BOTH)
        canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
        canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
        try:
          est_image = Image.open("images/"+estdata1[13])
          est_resize_image = est_image.resize((200,100))
          est_image = ImageTk.PhotoImage(est_resize_image)

          est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
          window_image = canvas.create_window(500, 45, anchor="nw", window=est_btlogo)
          est_btlogo.photo = est_image
        except:
          pass  
        canvas.create_text(250, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
        # canvas.create_text(224, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
        T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
        T_address.tag_configure('tag_name',justify='right')
        T_address.insert('1.0', estdata1[2])
        T_address.tag_add('tag_name','1.0', 'end')
        T_address_window = canvas.create_window(100, 80, anchor="nw", window=T_address)

        canvas.create_text(224, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
        canvas.create_text(225, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))

        canvas.create_text(502, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(515, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(500, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(491, 220, text="Terms", fill="black", font=('Helvetica 11'))
        canvas.create_text(505, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
        canvas.create_text(680, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(680, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(680, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(670, 220, text="NET 15", fill="black", font=('Helvetica 11'))      

        canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
        canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
        canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

        s = ttk.Style()
        s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

        tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_1.Treeview')
          
        tree.column("# 1", anchor=E, stretch=NO, width=530)
        tree.heading("# 1", text="Product/Service - Description")
        tree.column("# 2", anchor=E, stretch=NO, width=90)
        tree.heading("# 2", text="Quantity")
        tree.column("# 3", anchor=E, stretch=NO, width=80)
        tree.heading("# 3", text="Price")
          
        window = canvas.create_window(120, 340, anchor="nw", window=tree)

        canvas.create_line(120, 390, 820, 390 )
        canvas.create_line(120, 340, 120, 365 )
        canvas.create_line(120, 365, 120, 390 )
        canvas.create_line(820, 340, 820, 540 )
        canvas.create_line(740, 340, 740, 540 )
        canvas.create_line(570, 390, 570, 540 )
        canvas.create_line(570, 415, 820, 415 )
        canvas.create_line(570, 440, 820, 440 )
        canvas.create_line(570, 465, 820, 465 )
        canvas.create_line(570, 490, 820, 490 )
        canvas.create_line(570, 515, 820, 515 )
        canvas.create_line(650, 340, 650, 390 )
        canvas.create_line(570, 540, 820, 540 )

          
        canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
        canvas.create_text(710, 372, text="1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass

        # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

        canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

        canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 608, 795, 608)
        # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
        T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
        T.insert(END, estdata1[39])
        T_window = canvas.create_window(155, 612, anchor="nw", window=T)
        canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))

#----------------Business Classic------------------ 
      elif menuvar == 'Business Classic':
        frame = Frame(fifthtab, width=953, height=300)
        frame.pack(expand=True, fill=BOTH)
        frame.place(x=247,y=90)
          
        canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
          
        vertibar=Scrollbar(frame, orient=VERTICAL)
        vertibar.pack(side=RIGHT,fill=Y)
        vertibar.config(command=canvas.yview)
        canvas.config(width=953,height=300)
          
        canvas.config(yscrollcommand=vertibar.set)
        canvas.pack(expand=True,side=LEFT,fill=BOTH)
        canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
        canvas.create_text(500, 50, text="Title text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 70, 800, 70, fill='orange')
        
        try:
          est_image = Image.open("images/"+estdata1[13])
          est_resize_image = est_image.resize((200,100))
          est_image = ImageTk.PhotoImage(est_resize_image)

          est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
          window_image = canvas.create_window(140, 120, anchor="nw", window=est_btlogo)
          est_btlogo.photo = est_image
        except:
          pass  

        canvas.create_text(500, 90, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
        # canvas.create_text(485, 220, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
        T_address = Text(canvas, height=5, width=35, font=('Helvetica 10'),borderwidth=0)
        T_address.tag_configure('tag_name',justify='right')
        T_address.insert('1.0', estdata1[2])
        T_address.tag_add('tag_name','1.0', 'end')
        T_address_window = canvas.create_window(350, 100, anchor="nw", window=T_address)
        
        canvas.create_text(480, 210, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))

        canvas.create_text(655, 100, text="John Doe", fill="black", font=('Helvetica 10 '))
        canvas.create_text(696, 120, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
        canvas.create_text(706, 135, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
        canvas.create_text(665, 150, text="United States", fill="black", font=('Helvetica 10'))

        canvas.create_text(659, 180, text=""+est_str1.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(675, 210, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
        canvas.create_text(659, 240, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))

        canvas.create_text(776, 180, text="EST1/2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(776, 210, text="05 May 2022", fill="black", font=('Helvetica 11'))
        canvas.create_text(776, 240, text="20-05-2022", fill="black", font=('Helvetica 11'))

        s = ttk.Style()
        s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

        tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')
          
        tree.column("# 1", anchor=E, stretch=NO, width=200)
        tree.heading("# 1", text="Product/Service")
        tree.column("# 2", anchor=E, stretch=NO, width=250)
        tree.heading("# 2", text="Description")
        tree.column("# 3", anchor=E, stretch=NO, width=90)
        tree.heading("# 3", text="Unit Price")
        tree.column("# 4", anchor=E, stretch=NO, width=80)
        tree.heading("# 4", text="Quantity")
        tree.column("# 5", anchor=E, stretch=NO, width=80)
        tree.heading("# 5", text="Price")
      
        window = canvas.create_window(120, 255, anchor="nw", window=tree)

        canvas.create_line(120, 295, 820, 295 )
        canvas.create_line(120, 255, 120, 295 )
        canvas.create_line(320, 255, 320, 295 )
        canvas.create_line(570, 255, 570, 295 )
        canvas.create_line(660, 255, 660, 295 )
        canvas.create_line(740, 255, 740, 295 )
        canvas.create_line(820, 255, 820, 445 )
        canvas.create_line(570, 320, 820, 320 )
        canvas.create_line(570, 345, 820, 345 )
        canvas.create_line(570, 370, 820, 370 )
        canvas.create_line(570, 395, 820, 395 )
        canvas.create_line(570, 420, 820, 420 )
        canvas.create_line(570, 445, 820, 445 )
      
        canvas.create_text(160, 285, text="PROD-0001", fill="black", font=('Helvetica 10'))
        canvas.create_text(450, 285, text="Example product - Description text...", fill="black", font=('Helvetica 10'))

        if comcursignpla.get() == "before amount":
          canvas.create_text(624, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(624, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(624, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(624, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(624, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        canvas.create_text(700, 285, text="1", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 310, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 310, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 310, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 310, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 310, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(789, 335, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(789, 335, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(789, 335, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(789, 335, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(789, 335, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(789, 360, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(789, 360, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(789, 360, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(789, 360, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(789, 360, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 385, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 385, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 385, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 385, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 385, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 410, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 410, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 410, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 410, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 410, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        if comcursignpla.get() == "before amount":
          canvas.create_text(784, 435, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount":
          canvas.create_text(784, 435, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "before amount with space":
          canvas.create_text(784, 435, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
        elif comcursignpla.get() == "after amount with space":
          canvas.create_text(784, 435, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
        else:
          pass
        # canvas.create_text(784, 435, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

        canvas.create_text(595, 310, text="Subtotal", fill="black", font=('Helvetica 10'))
        canvas.create_text(585, 335, text="TAX1", fill="black", font=('Helvetica 10'))
        canvas.create_text(635, 360, text="Shipping and handling", fill="black", font=('Helvetica 10'))
        canvas.create_text(615, 385, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))
        canvas.create_text(600, 410, text="Total Paid", fill="black", font=('Helvetica 10'))
        canvas.create_text(595, 435, text="Balance", fill="black", font=('Helvetica 10'))

        canvas.create_line(150, 470, 800, 470, fill='orange')
        canvas.create_text(275, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 510, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 520, text="...", fill="black", font=('Helvetica 10'))
        canvas.create_text(182, 530, text="...", fill="black", font=('Helvetica 10'))
          
        canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
        canvas.create_line(150, 608, 795, 608, fill='orange')
        # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
        T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
        T.insert(END, estdata1[39])
        T_window = canvas.create_window(155, 612, anchor="nw", window=T)
        canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
        canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
      else:
        pass

  win_menu2 = StringVar()
  winstyle2 = ttk.Combobox(fifthtab,textvariable=win_menu2)
  winstyle2.bind("<<ComboboxSelected>>", maindropmenu)
  winstyle2["values"] = ("Professional 1 (logo on left side)","Professional 2 (logo on right side)","Simplified 1 (logo on left side)","Simplified 2 (logo on right side)","Business Classic")
  if not estdata:
    winstyle2.current(0)
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)
    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
          
    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
      
    canvas.config(width=953,height=300)
    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 8, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 50, text="Title text goes here...", fill="black", font=('Helvetica 10'))
  
    #canvas.create_image(120,0, anchor=NW, image=est_logo)  
    canvas.create_text(285, 110, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))
      
    canvas.create_text(202, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(215, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(200, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(191, 220, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(205, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 220, text="NET 15", fill="black", font=('Helvetica 11'))
      
    canvas.create_text(720, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(700, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'), width=125)
    # T_address = Text(canvas, height=5, width=20 , font=('Helvetica 10'))
    # T_address.insert(END, estdata[2])
    # T_address_window = canvas.create_window(645, 80, anchor="nw", window=T_address)
    canvas.create_text(700, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
    canvas.create_text(700, 205, text=" "+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
    canvas.create_text(706, 225, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))
      
    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')

    tree.column("# 1", anchor=E, stretch=NO, width=100)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=350)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=80)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=90)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=80)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 340, anchor="nw", window=tree)

    canvas.create_line(120, 390, 820, 390 )
    canvas.create_line(120, 340, 120, 365 )
    canvas.create_line(120, 365, 120, 390 )
    canvas.create_line(820, 340, 820, 540 )
    canvas.create_line(740, 340, 740, 540 )
    canvas.create_line(570, 340, 570, 540 )
    canvas.create_line(570, 415, 820, 415 )
    canvas.create_line(570, 440, 820, 440 )
    canvas.create_line(570, 465, 820, 465 )
    canvas.create_line(570, 490, 820, 490 )
    canvas.create_line(570, 515, 820, 515 )
    canvas.create_line(650, 340, 650, 390 )
    canvas.create_line(220, 340, 220, 390 )
    canvas.create_line(570, 540, 820, 540 )

    canvas.create_text(165, 372, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(610, 372, text="1", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(704, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    else:
      pass
    # canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    else:
      pass

    # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608)
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10')) 
    # T = Text(canvas, height=3, width=105, font=('Helvetica 10'))
    # T.insert(END, estdata[39])
    # T_window = canvas.create_window(105, 612, anchor="nw", window=T)


    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10')) 
  elif estdata[32] == 'Professional 1 (logo on left side)':
    winstyle2.insert(0, estdata[32])
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)
    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
          
    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
      
    canvas.config(width=953,height=300)
    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 8, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      est_image = Image.open("images/"+estdata[13])
      est_resize_image = est_image.resize((200,100))
      est_image = ImageTk.PhotoImage(est_resize_image)

      est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
      window_image = canvas.create_window(175, 45, anchor="nw", window=est_btlogo)
      est_btlogo.photo = est_image
    except:
      pass  
    canvas.create_text(202, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(215, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(200, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(191, 220, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(205, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 220, text="NET 15", fill="black", font=('Helvetica 11'))
      
    canvas.create_text(720, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(700, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'), width=125)
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', estdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(520, 80, anchor="nw", window=T_address)
    canvas.create_text(695, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
    canvas.create_text(700, 205, text=" "+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
    canvas.create_text(706, 225, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))
      
    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')

    tree.column("# 1", anchor=E, stretch=NO, width=100)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=350)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=80)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=90)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=80)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 340, anchor="nw", window=tree)

    canvas.create_line(120, 390, 820, 390 )
    canvas.create_line(120, 340, 120, 365 )
    canvas.create_line(120, 365, 120, 390 )
    canvas.create_line(820, 340, 820, 540 )
    canvas.create_line(740, 340, 740, 540 )
    canvas.create_line(570, 340, 570, 540 )
    canvas.create_line(570, 415, 820, 415 )
    canvas.create_line(570, 440, 820, 440 )
    canvas.create_line(570, 465, 820, 465 )
    canvas.create_line(570, 490, 820, 490 )
    canvas.create_line(570, 515, 820, 515 )
    canvas.create_line(650, 340, 650, 390 )
    canvas.create_line(220, 340, 220, 390 )
    canvas.create_line(570, 540, 820, 540 )

    canvas.create_text(165, 372, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(610, 372, text="1", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(704, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    else:
      pass
    # canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))

    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    else:
      pass

    # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608)
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10')) 
    T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
    T.insert(END, estdata[39])
    T_window = canvas.create_window(155, 612, anchor="nw", window=T)

    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif estdata[32] == 'Professional 2 (logo on right side)':
    winstyle2.insert(0, estdata[32])
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)
      
    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
      
    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=953,height=300)
      
    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      est_image = Image.open("images/"+estdata[13])
      est_resize_image = est_image.resize((200,100))
      est_image = ImageTk.PhotoImage(est_resize_image)

      est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
      window_image = canvas.create_window(500, 45, anchor="nw", window=est_btlogo)
      est_btlogo.photo = est_image
    except:
      pass  
    canvas.create_text(250, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(225, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', estdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(100, 80, anchor="nw", window=T_address)
    canvas.create_text(225, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
    canvas.create_text(225, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
    canvas.create_text(232, 225, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(502, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(515, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(500, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(491, 220, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(505, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(690, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(690, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(690, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(680, 220, text="NET 15", fill="black", font=('Helvetica 11'))      
      
    canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=100)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=350)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=80)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=90)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=80)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 340, anchor="nw", window=tree)

    canvas.create_line(120, 390, 820, 390 )
    canvas.create_line(120, 340, 120, 365 )
    canvas.create_line(120, 365, 120, 390 )
    canvas.create_line(820, 340, 820, 540 )
    canvas.create_line(740, 340, 740, 540 )
    canvas.create_line(570, 340, 570, 540 )
    canvas.create_line(570, 415, 820, 415 )
    canvas.create_line(570, 440, 820, 440 )
    canvas.create_line(570, 465, 820, 465 )
    canvas.create_line(570, 490, 820, 490 )
    canvas.create_line(570, 515, 820, 515 )
    canvas.create_line(650, 340, 650, 390 )
    canvas.create_line(220, 340, 220, 390 )
    canvas.create_line(570, 540, 820, 540 )

    canvas.create_text(165, 372, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(610, 372, text="1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(704, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(704, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(704, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10 bold'))
    else:
      pass

    # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))
    
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608)
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
    T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
    T.insert(END, estdata[39])
    T_window = canvas.create_window(155, 612, anchor="nw", window=T)
    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif estdata[32] == 'Simplified 1 (logo on left side)':
    winstyle2.insert(0, estdata[32])
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)
    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=953,height=300)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      est_image = Image.open("images/"+estdata[13])
      est_resize_image = est_image.resize((200,100))
      est_image = ImageTk.PhotoImage(est_resize_image)

      est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
      window_image = canvas.create_window(175, 45, anchor="nw", window=est_btlogo)
      est_btlogo.photo = est_image
    except:
      pass  
    canvas.create_text(202, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(215, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(200, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(191, 220, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(205, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 220, text="NET 15", fill="black", font=('Helvetica 11'))      

    canvas.create_text(720, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(710, 200, text=caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', estdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(520, 80, anchor="nw", window=T_address)

    canvas.create_text(708, 170, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
    canvas.create_text(710, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))
      
    canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_1.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=530)
    tree.heading("# 1", text="Product/Service - Description")
    tree.column("# 2", anchor=E, stretch=NO, width=90)
    tree.heading("# 2", text="Quantity")
    tree.column("# 3", anchor=E, stretch=NO, width=80)
    tree.heading("# 3", text="Price")
      
    window = canvas.create_window(120, 340, anchor="nw", window=tree)

    canvas.create_line(120, 390, 820, 390 )
    canvas.create_line(120, 340, 120, 365 )
    canvas.create_line(120, 365, 120, 390 )
    canvas.create_line(820, 340, 820, 540 )
    canvas.create_line(740, 340, 740, 540 )
    canvas.create_line(570, 390, 570, 540 )
    canvas.create_line(570, 415, 820, 415 )
    canvas.create_line(570, 440, 820, 440 )
    canvas.create_line(570, 465, 820, 465 )
    canvas.create_line(570, 490, 820, 490 )
    canvas.create_line(570, 515, 820, 515 )
    canvas.create_line(650, 340, 650, 390 )
    canvas.create_line(570, 540, 820, 540 )

      
    canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(710, 372, text="1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608)
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
    T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
    T.insert(END, estdata[39])
    T_window = canvas.create_window(155, 612, anchor="nw", window=T)
    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif estdata[32] == 'Simplified 2 (logo on right side)':
    winstyle2.insert(0, estdata[32])
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)

    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=953,height=300)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      est_image = Image.open("images/"+estdata[13])
      est_resize_image = est_image.resize((200,100))
      est_image = ImageTk.PhotoImage(est_resize_image)

      est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
      window_image = canvas.create_window(500, 45, anchor="nw", window=est_btlogo)
      est_btlogo.photo = est_image
    except:
      pass  
    canvas.create_text(250, 60, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(224, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', estdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(100, 80, anchor="nw", window=T_address)
    canvas.create_text(224, 180, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))
    canvas.create_text(225, 205, text=""+est_str1.get(), fill="black", font=('Helvetica 14 bold'))

    canvas.create_text(502, 160, text=""+est_str2.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(515, 180, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(500, 200, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(491, 220, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(505, 240, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(680, 160, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(680, 180, text="05-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(680, 200, text="20-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(670, 220, text="NET 15", fill="black", font=('Helvetica 11'))      

    canvas.create_text(210, 260, text=""+est_str5.get(), fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(203, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(246, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(255, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(215, 325, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 260, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 280, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 295, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 310, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 325, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_1.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=530)
    tree.heading("# 1", text="Product/Service - Description")
    tree.column("# 2", anchor=E, stretch=NO, width=90)
    tree.heading("# 2", text="Quantity")
    tree.column("# 3", anchor=E, stretch=NO, width=80)
    tree.heading("# 3", text="Price")
      
    window = canvas.create_window(120, 340, anchor="nw", window=tree)

    canvas.create_line(120, 390, 820, 390 )
    canvas.create_line(120, 340, 120, 365 )
    canvas.create_line(120, 365, 120, 390 )
    canvas.create_line(820, 340, 820, 540 )
    canvas.create_line(740, 340, 740, 540 )
    canvas.create_line(570, 390, 570, 540 )
    canvas.create_line(570, 415, 820, 415 )
    canvas.create_line(570, 440, 820, 440 )
    canvas.create_line(570, 465, 820, 465 )
    canvas.create_line(570, 490, 820, 490 )
    canvas.create_line(570, 515, 820, 515 )
    canvas.create_line(650, 340, 650, 390 )
    canvas.create_line(570, 540, 820, 540 )

      
    canvas.create_text(370, 372, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(710, 372, text="1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 372, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 372, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 372, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 404, text="Subtotal", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 404, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 404, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 404, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 428, text="TAX1", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 428, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(786, 428, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 428, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(650, 454, text="Shipping and handling", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(786, 454, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(786, 454, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(786, 454, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 479, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 479, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 479, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(650, 479, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 502, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 502, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 502, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 502, text="Total Paid", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 526, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 526, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass

    # canvas.create_text(784, 526, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(650, 526, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(275, 550, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 560, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 570, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 580, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608)
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
    T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
    T.insert(END, estdata[39])
    T_window = canvas.create_window(155, 612, anchor="nw", window=T)
    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif estdata[32] == 'Business Classic':
    winstyle2.insert(0, estdata[32])
    frame = Frame(fifthtab, width=953, height=300)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=247,y=90)
      
    canvas=Canvas(frame, bg='grey', width=953, height=300, scrollregion=(0,0,700,700))
      
    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=953,height=300)
      
    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(100, 10, 850, 687 , outline='yellow',fill='white')
    canvas.create_text(500, 50, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 70, 800, 70, fill='orange')
    
    try:
      est_image = Image.open("images/"+estdata[13])
      est_resize_image = est_image.resize((200,100))
      est_image = ImageTk.PhotoImage(est_resize_image)

      est_btlogo = Label(canvas,width=200,height=100,image = est_image) 
      window_image = canvas.create_window(140, 120, anchor="nw", window=est_btlogo)
      est_btlogo.photo = est_image
    except:
      pass  

    canvas.create_text(500, 90, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(480, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=35, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', estdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(350, 100, anchor="nw", window=T_address)
        
        
    canvas.create_text(480, 210, text=" "+comsalestax.get(), fill="black", font=('Helvetica 10'))

    canvas.create_text(655, 100, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(696, 120, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(706, 135, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(665, 150, text="United States", fill="black", font=('Helvetica 10'))

    canvas.create_text(659, 180, text=""+est_str1.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(675, 210, text=""+est_str3.get(), fill="black", font=('Helvetica 11'))
    canvas.create_text(659, 240, text=""+est_str4.get(), fill="black", font=('Helvetica 11'))

    canvas.create_text(776, 180, text="EST1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(776, 210, text="05 May 2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(776, 240, text="20-05-2022", fill="black", font=('Helvetica 11'))

    s = ttk.Style()
    s.configure('mystyle_1.Treeview.Heading', background=''+win_menu1.get(),State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_1.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=200)
    tree.heading("# 1", text="Product/Service")
    tree.column("# 2", anchor=E, stretch=NO, width=250)
    tree.heading("# 2", text="Description")
    tree.column("# 3", anchor=E, stretch=NO, width=90)
    tree.heading("# 3", text="Unit Price")
    tree.column("# 4", anchor=E, stretch=NO, width=80)
    tree.heading("# 4", text="Quantity")
    tree.column("# 5", anchor=E, stretch=NO, width=80)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 255, anchor="nw", window=tree)

    canvas.create_line(120, 295, 820, 295 )
    canvas.create_line(120, 255, 120, 295 )
    canvas.create_line(320, 255, 320, 295 )
    canvas.create_line(570, 255, 570, 295 )
    canvas.create_line(660, 255, 660, 295 )
    canvas.create_line(740, 255, 740, 295 )
    canvas.create_line(820, 255, 820, 445 )
    canvas.create_line(570, 320, 820, 320 )
    canvas.create_line(570, 345, 820, 345 )
    canvas.create_line(570, 370, 820, 370 )
    canvas.create_line(570, 395, 820, 395 )
    canvas.create_line(570, 420, 820, 420 )
    canvas.create_line(570, 445, 820, 445 )
      
    canvas.create_text(160, 285, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(450, 285, text="Example product - Description text...", fill="black", font=('Helvetica 10'))

    if comcursignpla.get() == "before amount":
      canvas.create_text(624, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(624, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(624, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(624, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(624, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(700, 285, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 310, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 310, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 310, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 310, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 310, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(789, 335, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(789, 335, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(789, 335, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(789, 335, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(789, 335, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(789, 360, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(789, 360, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(789, 360, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(789, 360, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(789, 360, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 385, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 385, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 385, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 385, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 385, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 410, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 410, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 410, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 410, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 410, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(784, 435, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(784, 435, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(784, 435, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(784, 435, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(784, 435, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(595, 310, text="Subtotal", fill="black", font=('Helvetica 10'))
    canvas.create_text(585, 335, text="TAX1", fill="black", font=('Helvetica 10'))
    canvas.create_text(635, 360, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    canvas.create_text(615, 385, text=""+est_str6.get(), fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(600, 410, text="Total Paid", fill="black", font=('Helvetica 10'))
    canvas.create_text(595, 435, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_line(150, 470, 800, 470, fill='orange')
    canvas.create_text(275, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(182, 530, text="...", fill="black", font=('Helvetica 10'))
      
    canvas.create_text(500, 600, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(150, 608, 795, 608, fill='orange')
    # canvas.create_text(280, 640, text= ""+est_str7.get(), fill="black", font=('Helvetica 10'))
    T = Text(canvas, height=3, width=90, font=('Helvetica 10'),borderwidth=0)
    T.insert(END, estdata[39])
    T_window = canvas.create_window(155, 612, anchor="nw", window=T)
    canvas.create_text(280, 670, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(720, 670, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  else:
    pass
  winstyle2.place(x=770 ,y=40, width=220)
  #winstyle2.current(0)



################### tab07 ###################################
  seventhtab1=Frame(tab07, relief=GROOVE, bg="#f8f8f2")
  seventhtab1.pack(side="top", fill=BOTH)

  sql = "select * from company"
  fbcursor.execute(sql)
  advdata = fbcursor.fetchone()
  #print(estdata)


  seventhtab=Frame(seventhtab1, bg="#f5f3f2", height=700)
  seventhtab.pack(side="top", fill=BOTH)

  adv_messagelbframe=LabelFrame(seventhtab,text="Template advanced settings", height=250, width=1150)
  adv_messagelbframe.place(x=2, y=10)

  adv_fbill = Label(seventhtab,text="Template",font="arial 10 bold").place(x=20,y=30)

  adv_ver = Label(seventhtab,text="Professional 1 (logo on left side)")
  adv_ver.place(x=20,y=60)

  adv_ver = Label(seventhtab,text="Professional 2 (logo on right side)")
  adv_ver.place(x=20,y=90)

  adv_ver = Label(seventhtab,text="Simplified 1 (logo on left side)")
  adv_ver.place(x=20,y=120)

  adv_ver = Label(seventhtab,text="Simplified 2 (logo on right side)")
  adv_ver.place(x=20,y=150)

  adv_ver = Label(seventhtab,text="Business Classic")
  adv_ver.place(x=20,y=180)

  adv_fbill = Label(seventhtab,text="Page size",font="arial 10 bold").place(x=255,y=30)

  adv_win_menu3 = StringVar()
  adv_winstyle3 = ttk.Combobox(seventhtab,textvariable=adv_win_menu3)
  adv_winstyle3['values'] = ('Letter','A4')
  adv_win_menu3.set('Letter')
  #adv_winstyle3.current(0)
  adv_winstyle3.place(x=225 ,y=60)
    
  
  adv_win_menu4 = StringVar()
  adv_winstyle4 = ttk.Combobox(seventhtab,textvariable=adv_win_menu4)
  adv_winstyle4.place(x=225,y=90)
  adv_winstyle4['values'] = ("Letter","A4")
  adv_winstyle4.set("Letter")
  adv_winstyle4.current(0)

  adv_win_menu5 = StringVar()
  adv_winstyle5 = ttk.Combobox(seventhtab,textvariable=adv_win_menu5)
  adv_winstyle5.place(x=225,y=120)
  adv_winstyle5['values'] = ("Letter","A4")
  adv_winstyle5.set("Letter")
  adv_winstyle5.current(0)

  adv_win_menu6 = StringVar()
  adv_winstyle6 = ttk.Combobox(seventhtab,textvariable=adv_win_menu6)
  adv_winstyle6.place(x=225,y=150)
  adv_winstyle6['values'] = ("Letter","A4")
  adv_winstyle6.set("Letter")
  adv_winstyle6.current(0)

  adv_win_menu7 = StringVar()
  adv_winstyle7 = ttk.Combobox(seventhtab,textvariable=adv_win_menu7)
  adv_winstyle7.place(x=225,y=180)
  adv_winstyle7['values'] = ("Letter","A4")
  adv_winstyle7.set("Letter")
  adv_winstyle7.current(0)

  adv_fbill = Label(seventhtab,text="Right Margin(mm)",font="arial 10 bold").place(x=450,y=30)

  adv_spin00 = Spinbox(seventhtab,from_=5,to=20,width=10)
  adv_spin00.place(x=465,y=60)

  adv_spin01 = Spinbox(seventhtab,from_=5,to=20,width=10)
  adv_spin01.place(x=465,y=90)

  adv_spin02 = Spinbox(seventhtab,from_=5,to=20,width=10)
  adv_spin02.place(x=465,y=120)

  adv_spin03 = Spinbox(seventhtab,from_=5,to=20,width=10)
  adv_spin03.place(x=465,y=150)

  adv_spin04 = Spinbox(seventhtab,from_=5,to=20,width=10)
  adv_spin04.place(x=465,y=180)


  adv_fbill = Label(seventhtab,text="'Invoice to'block position shift(mm)",font="arial 10 bold").place(x=650,y=30)

  adv_lbl1 = Label(seventhtab, text="Left : ").place(x=651,y=60)
  adv_lbl1 = Label(seventhtab, text="Left : ").place(x=651,y=90)
  adv_lbl1 = Label(seventhtab, text="Left : ").place(x=651,y=120)
  adv_lbl1 = Label(seventhtab, text="Left : ").place(x=651,y=150)

  adv_spin10 = Spinbox(seventhtab,from_=-10,to=100,width=10)
  adv_spin10.place(x=685,y=60)

  adv_spin11 = Spinbox(seventhtab,from_=-10,to=100,width=10)
  adv_spin11.place(x=685,y=90)

  adv_spin12 = Spinbox(seventhtab,from_=-10,to=100,width=10)
  adv_spin12.place(x=685,y=120)

  adv_spin13 = Spinbox(seventhtab,from_=-10,to=100,width=10)
  adv_spin13.place(x=685,y=150)

  adv_lbl1 = Label(seventhtab, text="Top : ").place(x=785,y=60)
  adv_lbl1 = Label(seventhtab, text="Top : ").place(x=785,y=90)
  adv_lbl1 = Label(seventhtab, text="Top : ").place(x=785,y=120)
  adv_lbl1 = Label(seventhtab, text="Top : ").place(x=785,y=150)

  adv_spin20 = Spinbox(seventhtab,from_=0,to=100,width=10)
  adv_spin20.place(x=820,y=60)

  adv_spin21 = Spinbox(seventhtab,from_=0,to=100,width=10)
  adv_spin21.place(x=820,y=90)

  adv_spin22 = Spinbox(seventhtab,from_=0,to=100,width=10)
  adv_spin22.place(x=820,y=120)

  adv_spin23 = Spinbox(seventhtab,from_=0,to=100,width=10)
  adv_spin23.place(x=820,y=150)

  adv_bttermadd = Button(seventhtab,image=photo8,compound = LEFT,text="Refresh preview",width=115)
  adv_bttermadd.place(x=1000,y=50)

  adv_bttermadd = Button(seventhtab,image=saves,compound = LEFT,text="Save Settings",width=115)
  adv_bttermadd.place(x=1000,y=140)

  def adv_restore():
    adv_spin10.delete(0,'end')
    adv_spin10.insert(0,"0")
    adv_spin11.delete(0,'end')
    adv_spin11.insert(0,"0")
    adv_spin12.delete(0,'end')
    adv_spin12.insert(0,"0")
    adv_spin13.delete(0,'end')
    adv_spin13.insert(0,"0")
    adv_spin20.delete(0,'end')
    adv_spin20.insert(0,"0")
    adv_spin21.delete(0,'end')
    adv_spin21.insert(0,"0")
    adv_spin22.delete(0,'end')
    adv_spin22.insert(0,"0")
    adv_spin23.delete(0,'end')
    adv_spin23.insert(0,"0")
    adv_spin00.delete(0,'end')
    adv_spin00.insert(0,"10")
    adv_spin01.delete(0,'end')
    adv_spin01.insert(0,"10")
    adv_spin02.delete(0,'end')
    adv_spin02.insert(0,"10")
    adv_spin03.delete(0,'end')
    adv_spin03.insert(0,"10")
    adv_spin04.delete(0,'end')
    adv_spin04.insert(0,"10")
    adv_winstyle3.delete(0,'end')
    adv_winstyle3.insert(0,"Letter")
    adv_winstyle4.delete(0,'end')
    adv_winstyle4.insert(0,"Letter")
    adv_winstyle5.delete(0,'end')
    adv_winstyle5.insert(0,"Letter")
    adv_winstyle6.delete(0,'end')
    adv_winstyle6.insert(0,"Letter")
    adv_winstyle7.delete(0,'end')
    adv_winstyle7.insert(0,"Letter")

  adv_bttermadd = Button(seventhtab,text="Restore defaults",width=16, command=adv_restore)
  adv_bttermadd.place(x=1000,y=180)

  adv_ver = Label(seventhtab,text="By positioning 'Invoice to'block,the customer name/address can be displayed in right place in the windowed envelope. If you networking, you need to setup this on all computer.\nExample:(Left:20 and Top:10 means that shift 'Invoice to'block to right 20mm and shift down 10mm) Original position Left:0 Top:0")
  adv_ver.place(x=50,y=210)

  adv_ver = Label(seventhtab,text="Selected template preview (example, click on preview for mouse scrolling)")
  adv_ver.place(x=230,y=270)

#------------Professional 1 (logo on left side)------------- 
  def adv_maindropmenu(event):
      menuvar=adv_win_menu8.get()
      print(menuvar)
      sql = "select * from company"
      fbcursor.execute(sql)
      advdata1 = fbcursor.fetchone()

      if menuvar == 'Professional 1 (logo on left side)':
          frame = Frame(seventhtab, width=1200, height=155)
          frame.pack(expand=True, fill=BOTH)
          frame.place(x=2,y=309)
          canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

          vertibar=Scrollbar(frame, orient=VERTICAL)
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1200,height=155)

          canvas.config(yscrollcommand=vertibar.set)
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')

          canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))

          try:
            adv_image = Image.open("images/"+advdata1[13])
            adv_resize_image = adv_image.resize((200,75))
            adv_image = ImageTk.PhotoImage(adv_resize_image)

            adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
            adv_window_image = canvas.create_window(150, 30, anchor="nw", window=adv_btlogo)
            adv_btlogo.photo = adv_image
          except:
            pass  

          canvas.create_text(130, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
          canvas.create_text(141, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
          canvas.create_text(130, 160, text="Due date", fill="black", font=('Helvetica 11'))
          canvas.create_text(120, 180, text="Terms", fill="black", font=('Helvetica 11'))
          canvas.create_text(134, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
          canvas.create_text(347, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(350, 140, text="03-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(350, 160, text="18-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(340, 180, text="NET 15", fill="black", font=('Helvetica 11'))

          canvas.create_text(1050, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
          # canvas.create_text(1080, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
          T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
          T_address.tag_configure('tag_name',justify='right')
          T_address.insert('1.0', advdata[2])
          T_address.tag_add('tag_name','1.0', 'end')
          T_address_window = canvas.create_window(850, 80, anchor="nw", window=T_address)
          canvas.create_text(1050, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
          # canvas.create_text(1085, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1085, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1080, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1080, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
          canvas.create_text(1050, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))
          canvas.create_text(1050, 210, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))

          canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
          canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

          s = ttk.Style()
          s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')
              
          tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
            
          tree.column("# 1", anchor=E, stretch=NO, width=150)
          tree.heading("# 1", text="ID/SKU")
          tree.column("# 2", anchor=E, stretch=NO, width=400)
          tree.heading("# 2", text="Product/Service - Description")
          tree.column("# 3", anchor=E, stretch=NO, width=150)
          tree.heading("# 3", text="Quantity")
          tree.column("# 4", anchor=E, stretch=NO, width=150)
          tree.heading("# 4", text="Unit Price")
          tree.column("# 5", anchor=E, stretch=NO, width=150)
          tree.heading("# 5", text="Price")
            
          window = canvas.create_window(120, 290, anchor="nw", window=tree)

          canvas.create_line(120, 330, 1120, 330 )
          canvas.create_line(120, 290, 120, 330 )
          canvas.create_line(270, 290, 270, 330 )
          canvas.create_line(670, 290, 670, 330 )
          canvas.create_line(820, 290, 820, 330 )
          canvas.create_line(970, 290, 970, 330 )
          canvas.create_line(1120, 290, 1120, 330 )
          canvas.create_line(670, 330, 670, 480)
          canvas.create_line(970, 330, 970, 480)
          canvas.create_line(1120, 330, 1120, 480)
          canvas.create_line(670, 355, 1120, 355)
          canvas.create_line(670, 380, 1120, 380)
          canvas.create_line(670, 405, 1120, 405)
          canvas.create_line(670, 430, 1120, 430)
          canvas.create_line(670, 455, 1120, 455)
          canvas.create_line(670, 480, 1120, 480)

          canvas.create_text(165, 320, text="PROD-0001", fill="black", font=('Helvetica 10'))
          canvas.create_text(400, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
          canvas.create_text(740, 320, text="1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(884, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(884, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(884, 320, text="$200.00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 320, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 345, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1085, 370, text="$18.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1085, 395, text="$20.00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 420, text="$238.00", fill="black", font=('Helvetica 10 bold'))
          canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 445, text="$100.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 465, text="$138.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))


          canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

          canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
          canvas.create_line(110, 600, 1120, 600)
          canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
          canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))

#------------Professional 2 (logo on right side)------------- 

      elif menuvar == 'Professional 2 (logo on right side)':
          frame = Frame(seventhtab, width=1200, height=155)
          frame.pack(expand=True, fill=BOTH)
          frame.place(x=2,y=309)
          canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

          vertibar=Scrollbar(frame, orient=VERTICAL)
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1200,height=155)

          canvas.config(yscrollcommand=vertibar.set)
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
          canvas.create_text(600, 45, text="Title text goes here...", fill="black", font=('Helvetica 10'))

          try:
            adv_image = Image.open("images/"+advdata1[13])
            adv_resize_image = adv_image.resize((200,75))
            adv_image = ImageTk.PhotoImage(adv_resize_image)

            adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
            adv_window_image = canvas.create_window(850, 25, anchor="nw", window=adv_btlogo)
            adv_btlogo.photo = adv_image
          except:
            pass  

          # canvas.create_text(1000, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

          canvas.create_text(829, 110, text="Invoice#", fill="black", font=('Helvetica 11'))
          canvas.create_text(841, 130, text="Invoice date", fill="black", font=('Helvetica 11'))
          canvas.create_text(830, 150, text="Due date", fill="black", font=('Helvetica 11'))
          canvas.create_text(820, 170, text="Terms", fill="black", font=('Helvetica 11'))
          canvas.create_text(834, 190, text="Order ref.#", fill="black", font=('Helvetica 11'))
          canvas.create_text(1047, 110, text="INV1/2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1050, 130, text="06-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1050, 150, text="21-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1040, 170, text="NET 15", fill="black", font=('Helvetica 11'))

          canvas.create_text(170, 65, text=""+comname.get(), fill="black", font=('Helvetica 12 '))
          # canvas.create_text(130, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
          T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
          T_address.tag_configure('tag_name',justify='right')
          T_address.insert('1.0', advdata[2])
          T_address.tag_add('tag_name','1.0', 'end')
          T_address_window = canvas.create_window(10, 80, anchor="nw", window=T_address)
          #T_address_window = canvas.create_window(95, 80, anchor="nw", window=T_address)
          canvas.create_text(130, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
          # canvas.create_text(130, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
          # canvas.create_text(130, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
          # canvas.create_text(136, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
          # canvas.create_text(136, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
          canvas.create_text(124, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

          canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
          canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

          tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
      
          tree.column("# 1", anchor=E, stretch=NO, width=150)
          tree.heading("# 1", text="ID/SKU")
          tree.column("# 2", anchor=E, stretch=NO, width=400)
          tree.heading("# 2", text="Product/Service - Description")
          tree.column("# 3", anchor=E, stretch=NO, width=150)
          tree.heading("# 3", text="Quantity")
          tree.column("# 4", anchor=E, stretch=NO, width=150)
          tree.heading("# 4", text="Unit Price")
          tree.column("# 5", anchor=E, stretch=NO, width=150)
          tree.heading("# 5", text="Price")
      
          window = canvas.create_window(120, 290, anchor="nw", window=tree)

          canvas.create_line(120, 330, 1120, 330 )
          canvas.create_line(120, 290, 120, 330 )
          canvas.create_line(270, 290, 270, 330 )
          canvas.create_line(670, 290, 670, 330 )
          canvas.create_line(820, 290, 820, 330 )
          canvas.create_line(970, 290, 970, 330 )
          canvas.create_line(1120, 290, 1120, 330 )
          canvas.create_line(670, 330, 670, 480)
          canvas.create_line(970, 330, 970, 480)
          canvas.create_line(1120, 330, 1120, 480)
          canvas.create_line(670, 355, 1120, 355)
          canvas.create_line(670, 380, 1120, 380)
          canvas.create_line(670, 405, 1120, 405)
          canvas.create_line(670, 430, 1120, 430)
          canvas.create_line(670, 455, 1120, 455)
          canvas.create_line(670, 480, 1120, 480)

          canvas.create_text(165, 320, text="PROD-0001", fill="black", font=('Helvetica 10'))
          canvas.create_text(400, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
          canvas.create_text(740, 320, text="1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(884, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(884, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 320, text="$200.00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 320, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 345, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 370, text="$18.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 395, text="$20.00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 420, text="$238.00", fill="black", font=('Helvetica 10 bold'))
          canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 445, text="$100.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 465, text="$138.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

          canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

          canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
          canvas.create_line(110, 600, 1120, 600)
          canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
          canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))

#------------Simplified 1 (logo on left side)------------- 

      elif menuvar == 'Simplified 1 (logo on left side)':
          frame = Frame(seventhtab, width=1200, height=155)
          frame.pack(expand=True, fill=BOTH)
          frame.place(x=2,y=309)
          canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

          vertibar=Scrollbar(frame, orient=VERTICAL)
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1200,height=155)

          canvas.config(yscrollcommand=vertibar.set)
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
          canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
          try:
            adv_image = Image.open("images/"+advdata1[13])
            adv_resize_image = adv_image.resize((200,75))
            adv_image = ImageTk.PhotoImage(adv_resize_image)

            adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
            adv_window_image = canvas.create_window(150, 25, anchor="nw", window=adv_btlogo)
            adv_btlogo.photo = adv_image
          except:
            pass  
          #canvas.create_text(250, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

          canvas.create_text(130, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
          canvas.create_text(141, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
          canvas.create_text(130, 160, text="Due date", fill="black", font=('Helvetica 11'))
          canvas.create_text(120, 180, text="Terms", fill="black", font=('Helvetica 11'))
          canvas.create_text(134, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
          canvas.create_text(347, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(350, 140, text="06-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(350, 160, text="21-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(340, 180, text="NET 15", fill="black", font=('Helvetica 11'))

          canvas.create_text(1050, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
          # canvas.create_text(1080, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
          T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
          T_address.tag_configure('tag_name',justify='right')
          T_address.insert('1.0', advdata[2])
          T_address.tag_add('tag_name','1.0', 'end')
          T_address_window = canvas.create_window(850, 80, anchor="nw", window=T_address)
          canvas.create_text(1050, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
          # canvas.create_text(1085, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1085, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1080, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
          # canvas.create_text(1080, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
          canvas.create_text(1050, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

          canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
          canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

          s = ttk.Style()
          s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

          tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_2.Treeview')
      
          tree.column("# 1", anchor=E, stretch=NO, width=700)
          tree.heading("# 1", text="Product/Service - Description")
          tree.column("# 2", anchor=E, stretch=NO, width=150)
          tree.heading("# 2", text="Quantity")
          tree.column("# 3", anchor=E, stretch=NO, width=150)
          tree.heading("# 3", text="Price")
            
          window = canvas.create_window(120, 290, anchor="nw", window=tree)

          canvas.create_line(120, 330, 1120, 330 )
          canvas.create_line(120, 290, 120, 330 )
          canvas.create_line(820, 290, 820, 330 )
          canvas.create_line(970, 290, 970, 330 )
          canvas.create_line(1120, 290, 1120, 330 )
          canvas.create_line(670, 330, 670, 480)
          canvas.create_line(970, 330, 970, 480)
          canvas.create_line(1120, 330, 1120, 480)
          canvas.create_line(670, 355, 1120, 355)
          canvas.create_line(670, 380, 1120, 380)
          canvas.create_line(670, 405, 1120, 405)
          canvas.create_line(670, 430, 1120, 430)
          canvas.create_line(670, 455, 1120, 455)
          canvas.create_line(670, 480, 1120, 480)

          canvas.create_text(250, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
          canvas.create_text(900, 320, text="1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
          canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

          canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

          canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
          canvas.create_line(110, 600, 1120, 600)
          canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
          canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))


#------------Simplified 2 (logo on right side)-------------

      elif menuvar == 'Simplified 2 (logo on right side)':
          frame = Frame(seventhtab, width=1200, height=155)
          frame.pack(expand=True, fill=BOTH)
          frame.place(x=2,y=309)
          canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

          vertibar=Scrollbar(frame, orient=VERTICAL)
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1200,height=155)

          canvas.config(yscrollcommand=vertibar.set)
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
          canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
          try:
            adv_image = Image.open("images/"+advdata1[13])
            adv_resize_image = adv_image.resize((200,75))
            adv_image = ImageTk.PhotoImage(adv_resize_image)

            adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
            adv_window_image = canvas.create_window(850, 25, anchor="nw", window=adv_btlogo)
            adv_btlogo.photo = adv_image
          except:
            pass  

          # canvas.create_text(1000, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

          canvas.create_text(829, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
          canvas.create_text(841, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
          canvas.create_text(830, 160, text="Due date", fill="black", font=('Helvetica 11'))
          canvas.create_text(820, 180, text="Terms", fill="black", font=('Helvetica 11'))
          canvas.create_text(834, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
          canvas.create_text(1047, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1050, 140, text="06-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1050, 160, text="21-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(1040, 180, text="NET 15", fill="black", font=('Helvetica 11'))

          canvas.create_text(170, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
          # canvas.create_text(130, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
          T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
          T_address.tag_configure('tag_name',justify='right')
          T_address.insert('1.0', advdata[2])
          T_address.tag_add('tag_name','1.0', 'end')
          T_address_window = canvas.create_window(10, 80, anchor="nw", window=T_address)
          canvas.create_text(130, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
          # canvas.create_text(130, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
          # canvas.create_text(130, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
          # canvas.create_text(136, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
          # canvas.create_text(136, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
          canvas.create_text(124, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

          canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
          canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
          canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

          s = ttk.Style()
          s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

          tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_2.Treeview')
              
          tree.column("# 1", anchor=E, stretch=NO, width=700)
          tree.heading("# 1", text="Product/Service - Description")
          tree.column("# 2", anchor=E, stretch=NO, width=150)
          tree.heading("# 2", text="Quantity")
          tree.column("# 3", anchor=E, stretch=NO, width=150)
          tree.heading("# 3", text="Price")
        
          window = canvas.create_window(120, 290, anchor="nw", window=tree)

          canvas.create_line(120, 330, 1120, 330 )
          canvas.create_line(120, 290, 120, 330 )
          canvas.create_line(820, 290, 820, 330 )
          canvas.create_line(970, 290, 970, 330 )
          canvas.create_line(1120, 290, 1120, 330 )
          canvas.create_line(670, 330, 670, 480)
          canvas.create_line(970, 330, 970, 480)
          canvas.create_line(1120, 330, 1120, 480)
          canvas.create_line(670, 355, 1120, 355)
          canvas.create_line(670, 380, 1120, 380)
          canvas.create_line(670, 405, 1120, 405)
          canvas.create_line(670, 430, 1120, 430)
          canvas.create_line(670, 455, 1120, 455)
          canvas.create_line(670, 480, 1120, 480)

          canvas.create_text(250, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
          canvas.create_text(900, 320, text="1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

          canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1089, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
          canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1084, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

          canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

          canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
          canvas.create_line(110, 600, 1120, 600)
          canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
          canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))

  #------------Business Classic------------- 

      elif menuvar == 'Business Classic':
          frame = Frame(seventhtab, width=1200, height=155)
          frame.pack(expand=True, fill=BOTH)
          frame.place(x=2,y=309)
          canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

          vertibar=Scrollbar(frame, orient=VERTICAL)
          vertibar.pack(side=RIGHT,fill=Y)
          vertibar.config(command=canvas.yview)
          canvas.config(width=1200,height=155)

          canvas.config(yscrollcommand=vertibar.set)
          canvas.pack(expand=True,side=LEFT,fill=BOTH)
          canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
          canvas.create_text(600, 45, text="Title text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_line(100, 60, 1120, 60, fill="orange")
          #canvas.create_line(1000, 60, 600, 60, fill="grey")

          try:
            adv_image = Image.open("images/"+advdata1[13])
            adv_resize_image = adv_image.resize((200,100))
            adv_image = ImageTk.PhotoImage(adv_resize_image)

            adv_btlogo = Label(canvas,width=200,height=100,image = adv_image) 
            adv_window_image = canvas.create_window(140, 100, anchor="nw", window=adv_btlogo)
            adv_btlogo.photo = adv_image
          except:
            pass  


          # canvas.create_text(250, 155, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

          canvas.create_text(560, 85, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
          # canvas.create_text(535, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
          T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
          T_address.tag_configure('tag_name',justify='right')
          T_address.insert('1.0', advdata[2])
          T_address.tag_add('tag_name','1.0', 'end')
          T_address_window = canvas.create_window(350, 100, anchor="nw", window=T_address)
          # adv_btlabel = Label(canvas,width=20,height=10,text=""+caddent.get('1.0', 'end-1c')) 
          # adv_window_label = canvas.create_window(530, 110, anchor="nw", window=adv_btlabel)
          canvas.create_text(530, 190, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
          # canvas.create_text(530, 140, text="Address line 3", fill="black", font=('Helvetica 10'))
          # canvas.create_text(530, 155, text="Address line 4", fill="black", font=('Helvetica 10'))
          # canvas.create_text(536, 170, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
          # canvas.create_text(536, 190, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
          canvas.create_text(524, 210, text="Invoice", fill="black", font=('Helvetica 14 bold'))

          canvas.create_text(749, 95, text="John Doe", fill="black", font=('Helvetica 10 '))
          canvas.create_text(791, 110, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
          canvas.create_text(800, 125, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
          canvas.create_text(760, 140, text="United States", fill="black", font=('Helvetica 10'))

          canvas.create_text(745, 160, text="Invoice", fill="black", font=('Helvetica 11'))
          canvas.create_text(760, 180, text="Invoice date", fill="black", font=('Helvetica 11'))
          canvas.create_text(750, 200, text="Due date", fill="black", font=('Helvetica 11'))

          canvas.create_text(947, 160, text="INV1/2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(950, 180, text="06-05-2022", fill="black", font=('Helvetica 11'))
          canvas.create_text(950, 200, text="21-05-2022", fill="black", font=('Helvetica 11'))
          s = ttk.Style()
          s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

          tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
        
          tree.column("# 1", anchor=E, stretch=NO, width=150)
          tree.heading("# 1", text="Product/Service")
          tree.column("# 2", anchor=E, stretch=NO, width=400)
          tree.heading("# 2", text="Description")
          tree.column("# 3", anchor=E, stretch=NO, width=150)
          tree.heading("# 3", text="Unit Price")
          tree.column("# 4", anchor=E, stretch=NO, width=150)
          tree.heading("# 4", text="Quantity")
          tree.column("# 5", anchor=E, stretch=NO, width=150)
          tree.heading("# 5", text="Price")
              
          window = canvas.create_window(120, 230, anchor="nw", window=tree)

          canvas.create_line(120, 270, 1120, 270 )
          canvas.create_line(120, 230, 120, 270 )
          canvas.create_line(270, 230, 270, 270 )
          canvas.create_line(670, 230, 670, 270 )
          canvas.create_line(820, 230, 820, 270 )
          canvas.create_line(970, 230, 970, 270 )
          canvas.create_line(1120, 230, 1120, 270)
          canvas.create_line(1120, 270, 1120, 420)
          canvas.create_line(670, 295, 1120, 295)
          canvas.create_line(670, 320, 1120, 320)
          canvas.create_line(670, 345, 1120, 345)
          canvas.create_line(670, 370, 1120, 370)
          canvas.create_line(670, 395, 1120, 395)
          canvas.create_line(670, 420, 1120, 420)

          canvas.create_text(165, 260, text="PROD-0001", fill="black", font=('Helvetica 10'))
          canvas.create_text(400, 260, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(734, 260, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(734, 260, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(734, 260, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(734, 260, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(734, 260, text="$200.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(890, 260, text="1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 260, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 260, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 260, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 260, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          # canvas.create_text(1080, 260, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(697, 285, text="Subtotal", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 285, text="$200.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(692, 310, text="TAX1", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 310, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 310, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 310, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 310, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1085, 310, text="$18.00", fill="black", font=('Helvetica 10'))

          canvas.create_text(737, 335, text="Shipping and handling", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1085, 335, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1085, 335, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1085, 335, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1085, 335, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1085, 335, text="$20.00", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 360, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 360, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 360, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 360, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 360, text="$238.00", fill="black", font=('Helvetica 10 bold'))
          canvas.create_text(715, 360, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 385, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 385, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 385, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 385, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 385, text="100.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(705, 385, text="Total Paid", fill="black", font=('Helvetica 10'))
          if comcursignpla.get() == "before amount":
            canvas.create_text(1080, 410, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount":
            canvas.create_text(1080, 410, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "before amount with space":
            canvas.create_text(1080, 410, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
          elif comcursignpla.get() == "after amount with space":
            canvas.create_text(1080, 410, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
          else:
            pass
          #canvas.create_text(1080, 410, text="$138.00", fill="black", font=('Helvetica 10'))
          canvas.create_text(700, 410, text="Balance", fill="black", font=('Helvetica 10'))

          canvas.create_line(100, 480, 1120, 480, fill="orange")
          canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
          canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

          canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
          canvas.create_line(100, 600, 1120, 600, fill="orange")
          canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
          canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
          canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
      else:
          pass

  adv_win_menu8 = StringVar()
  adv_winstyle8 = ttk.Combobox(seventhtab,textvariable=adv_win_menu8)
  adv_winstyle8.bind("<<ComboboxSelected>>", adv_maindropmenu)
  adv_winstyle8["values"] = ("Professional 1 (logo on left side)","Professional 2 (logo on right side)","Simplified 1 (logo on left side)","Simplified 2 (logo on right side)","Business Classic")
  if not advdata:
    adv_winstyle8.current(0)
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')

    canvas.create_text(600, 45, text="Title text goes here...", fill="black", font=('Helvetica 10'))

    canvas.create_text(250, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

    canvas.create_text(130, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
    canvas.create_text(141, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(130, 160, text="Due date", fill="black", font=('Helvetica 11'))
    canvas.create_text(120, 180, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(134, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(347, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 140, text="03-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="18-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 180, text="NET 15", fill="black", font=('Helvetica 11'))

    canvas.create_text(1050, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(1080, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
    # T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    # T_address.tag_configure('tag_name',justify='right')
    # T_address.insert('1.0', advdata[2])
    # T_address.tag_add('tag_name','1.0', 'end')
    # T_address_window = canvas.create_window(850, 80, anchor="nw", window=T_address)
    canvas.create_text(1050, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(1050, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))
    canvas.create_text(1050, 210, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))

    canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')
        
    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=150)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=400)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=150)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=150)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 290, anchor="nw", window=tree)

    canvas.create_line(120, 330, 1120, 330 )
    canvas.create_line(120, 290, 120, 330 )
    canvas.create_line(270, 290, 270, 330 )
    canvas.create_line(670, 290, 670, 330 )
    canvas.create_line(820, 290, 820, 330 )
    canvas.create_line(970, 290, 970, 330 )
    canvas.create_line(1120, 290, 1120, 330 )
    canvas.create_line(670, 330, 670, 480)
    canvas.create_line(970, 330, 970, 480)
    canvas.create_line(1120, 330, 1120, 480)
    canvas.create_line(670, 355, 1120, 355)
    canvas.create_line(670, 380, 1120, 380)
    canvas.create_line(670, 405, 1120, 405)
    canvas.create_line(670, 430, 1120, 430)
    canvas.create_line(670, 455, 1120, 455)
    canvas.create_line(670, 480, 1120, 480)

    canvas.create_text(165, 320, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(400, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(740, 320, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(884, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(884, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(884, 320, text="$200.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 320, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 345, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 370, text="$18.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 395, text="$20.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 420, text="$238.00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 445, text="$100.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 465, text="$138.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))


    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(110, 600, 1120, 600)
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif advdata[32] == 'Professional 1 (logo on left side)':
    adv_winstyle8.insert(0, advdata[40])
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')

    canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))

    try:
      adv_image = Image.open("images/"+advdata[13])
      adv_resize_image = adv_image.resize((200,75))
      adv_image = ImageTk.PhotoImage(adv_resize_image)

      adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
      adv_window_image = canvas.create_window(150, 30, anchor="nw", window=adv_btlogo)
      adv_btlogo.photo = adv_image
    except:
      pass  

    canvas.create_text(130, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
    canvas.create_text(141, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(130, 160, text="Due date", fill="black", font=('Helvetica 11'))
    canvas.create_text(120, 180, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(134, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(347, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 140, text="03-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="18-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 180, text="NET 15", fill="black", font=('Helvetica 11'))

    canvas.create_text(1050, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(1080, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', advdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(850, 80, anchor="nw", window=T_address)
        
    canvas.create_text(1050, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(1050, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))
    canvas.create_text(1050, 210, text="TAX EXEMPTED", fill="black", font=('Helvetica 10'))

    canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')
        
    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=150)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=400)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=150)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=150)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 290, anchor="nw", window=tree)

    canvas.create_line(120, 330, 1120, 330 )
    canvas.create_line(120, 290, 120, 330 )
    canvas.create_line(270, 290, 270, 330 )
    canvas.create_line(670, 290, 670, 330 )
    canvas.create_line(820, 290, 820, 330 )
    canvas.create_line(970, 290, 970, 330 )
    canvas.create_line(1120, 290, 1120, 330 )
    canvas.create_line(670, 330, 670, 480)
    canvas.create_line(970, 330, 970, 480)
    canvas.create_line(1120, 330, 1120, 480)
    canvas.create_line(670, 355, 1120, 355)
    canvas.create_line(670, 380, 1120, 380)
    canvas.create_line(670, 405, 1120, 405)
    canvas.create_line(670, 430, 1120, 430)
    canvas.create_line(670, 455, 1120, 455)
    canvas.create_line(670, 480, 1120, 480)

    canvas.create_text(165, 320, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(400, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(740, 320, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(884, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(884, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(884, 320, text="$200.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 320, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 345, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 370, text="$18.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 395, text="$20.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 420, text="$238.00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 445, text="$100.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 465, text="$138.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))


    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(110, 600, 1120, 600)
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif advdata[32] == 'Professional 2 (logo on right side)':
    adv_winstyle8.insert(0, advdata[40])
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
    canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      adv_image = Image.open("images/"+advdata[13])
      adv_resize_image = adv_image.resize((200,75))
      adv_image = ImageTk.PhotoImage(adv_resize_image)

      adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
      adv_window_image = canvas.create_window(850, 25, anchor="nw", window=adv_btlogo)
      adv_btlogo.photo = adv_image
    except:
      pass  
    #canvas.create_text(1000, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

    canvas.create_text(829, 110, text="Invoice#", fill="black", font=('Helvetica 11'))
    canvas.create_text(841, 130, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(830, 150, text="Due date", fill="black", font=('Helvetica 11'))
    canvas.create_text(820, 170, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(834, 190, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(1047, 110, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1050, 130, text="06-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1050, 150, text="21-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1040, 170, text="NET 15", fill="black", font=('Helvetica 11'))

    canvas.create_text(170, 65, text=""+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(130, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', advdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(10, 80, anchor="nw", window=T_address)
    canvas.create_text(125, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(130, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(130, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(136, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(136, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(124, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

    canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))
    
    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=150)
    tree.heading("# 1", text="ID/SKU")
    tree.column("# 2", anchor=E, stretch=NO, width=400)
    tree.heading("# 2", text="Product/Service - Description")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Quantity")
    tree.column("# 4", anchor=E, stretch=NO, width=150)
    tree.heading("# 4", text="Unit Price")
    tree.column("# 5", anchor=E, stretch=NO, width=150)
    tree.heading("# 5", text="Price")
      
    window = canvas.create_window(120, 290, anchor="nw", window=tree)

    canvas.create_line(120, 330, 1120, 330 )
    canvas.create_line(120, 290, 120, 330 )
    canvas.create_line(270, 290, 270, 330 )
    canvas.create_line(670, 290, 670, 330 )
    canvas.create_line(820, 290, 820, 330 )
    canvas.create_line(970, 290, 970, 330 )
    canvas.create_line(1120, 290, 1120, 330 )
    canvas.create_line(670, 330, 670, 480)
    canvas.create_line(970, 330, 970, 480)
    canvas.create_line(1120, 330, 1120, 480)
    canvas.create_line(670, 355, 1120, 355)
    canvas.create_line(670, 380, 1120, 380)
    canvas.create_line(670, 405, 1120, 405)
    canvas.create_line(670, 430, 1120, 430)
    canvas.create_line(670, 455, 1120, 455)
    canvas.create_line(670, 480, 1120, 480)

    canvas.create_text(165, 320, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(400, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(740, 320, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(884, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(884, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(884, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 320, text="$200.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 320, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 345, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 370, text="$18.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 395, text="$20.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 420, text="$238.00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 445, text="$100.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 465, text="$138.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(110, 600, 1120, 600)
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))


  elif advdata[32] == 'Simplified 1 (logo on left side)':
    adv_winstyle8.insert(0, advdata[40])
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
    canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      adv_image = Image.open("images/"+advdata[13])
      adv_resize_image = adv_image.resize((200,75))
      adv_image = ImageTk.PhotoImage(adv_resize_image)

      adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
      adv_window_image = canvas.create_window(150, 25, anchor="nw", window=adv_btlogo)
      adv_btlogo.photo = adv_image
    except:
      pass  
    #canvas.create_text(250, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

    canvas.create_text(130, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
    canvas.create_text(141, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(130, 160, text="Due date", fill="black", font=('Helvetica 11'))
    canvas.create_text(120, 180, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(134, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(347, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 140, text="06-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(350, 160, text="21-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(340, 180, text="NET 15", fill="black", font=('Helvetica 11'))

    canvas.create_text(1050, 65, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(1080, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', advdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(850, 80, anchor="nw", window=T_address)
    canvas.create_text(1050, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1085, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(1080, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(1050, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

    canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_2.Treeview')
      
    tree.column("# 1", anchor=E, stretch=NO, width=700)
    tree.heading("# 1", text="Product/Service - Description")
    tree.column("# 2", anchor=E, stretch=NO, width=150)
    tree.heading("# 2", text="Quantity")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Price")
      
    window = canvas.create_window(120, 290, anchor="nw", window=tree)

    canvas.create_line(120, 330, 1120, 330 )
    canvas.create_line(120, 290, 120, 330 )
    canvas.create_line(820, 290, 820, 330 )
    canvas.create_line(970, 290, 970, 330 )
    canvas.create_line(1120, 290, 1120, 330 )
    canvas.create_line(670, 330, 670, 480)
    canvas.create_line(970, 330, 970, 480)
    canvas.create_line(1120, 330, 1120, 480)
    canvas.create_line(670, 355, 1120, 355)
    canvas.create_line(670, 380, 1120, 380)
    canvas.create_line(670, 405, 1120, 405)
    canvas.create_line(670, 430, 1120, 430)
    canvas.create_line(670, 455, 1120, 455)
    canvas.create_line(670, 480, 1120, 480)

    canvas.create_text(250, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(900, 320, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(110, 600, 1120, 600)
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif advdata[32] == 'Simplified 2 (logo on right side)':
    adv_winstyle8.insert(0, advdata[40])
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
    canvas.create_text(600, 25, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    try:
      adv_image = Image.open("images/"+advdata[13])
      adv_resize_image = adv_image.resize((200,75))
      adv_image = ImageTk.PhotoImage(adv_resize_image)

      adv_btlogo = Label(canvas,width=200,height=75,image = adv_image) 
      adv_window_image = canvas.create_window(850, 25, anchor="nw", window=adv_btlogo)
      adv_btlogo.photo = adv_image
    except:
      pass  

    # canvas.create_text(1000, 70, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

    canvas.create_text(829, 120, text="Invoice#", fill="black", font=('Helvetica 11'))
    canvas.create_text(841, 140, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(830, 160, text="Due date", fill="black", font=('Helvetica 11'))
    canvas.create_text(820, 180, text="Terms", fill="black", font=('Helvetica 11'))
    canvas.create_text(834, 200, text="Order ref.#", fill="black", font=('Helvetica 11'))
    canvas.create_text(1047, 120, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1050, 140, text="06-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1050, 160, text="21-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(1040, 180, text="NET 15", fill="black", font=('Helvetica 11'))

    canvas.create_text(170, 55, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(135, 200, text=""+caddent.get('1.0','end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', advdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(10, 80, anchor="nw", window=T_address)
    canvas.create_text(130, 170, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(130, 125, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(130, 140, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(136, 155, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(136, 170, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(124, 190, text="Invoice", fill="black", font=('Helvetica 14 bold'))

    canvas.create_text(140, 215, text="Bill to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(149, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(191, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(200, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(160, 275, text="United States", fill="black", font=('Helvetica 10'))
    canvas.create_text(550, 215, text="Ship to", fill="black", font=('Helvetica 10 underline'))
    canvas.create_text(556, 230, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(598, 245, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(608, 260, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(568, 275, text="United States", fill="black", font=('Helvetica 10'))

    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3"), show='headings',height= 0, style='mystyle_2.Treeview')
        
    tree.column("# 1", anchor=E, stretch=NO, width=700)
    tree.heading("# 1", text="Product/Service - Description")
    tree.column("# 2", anchor=E, stretch=NO, width=150)
    tree.heading("# 2", text="Quantity")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Price")
        
    window = canvas.create_window(120, 290, anchor="nw", window=tree)

    canvas.create_line(120, 330, 1120, 330 )
    canvas.create_line(120, 290, 120, 330 )
    canvas.create_line(820, 290, 820, 330 )
    canvas.create_line(970, 290, 970, 330 )
    canvas.create_line(1120, 290, 1120, 330 )
    canvas.create_line(670, 330, 670, 480)
    canvas.create_line(970, 330, 970, 480)
    canvas.create_line(1120, 330, 1120, 480)
    canvas.create_line(670, 355, 1120, 355)
    canvas.create_line(670, 380, 1120, 380)
    canvas.create_line(670, 405, 1120, 405)
    canvas.create_line(670, 430, 1120, 430)
    canvas.create_line(670, 455, 1120, 455)
    canvas.create_line(670, 480, 1120, 480)

    canvas.create_text(250, 320, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    canvas.create_text(900, 320, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 320, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 320, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 320, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 345, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 345, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 345, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 345, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 370, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 370, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 370, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 370, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))

    canvas.create_text(820, 395, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 395, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 395, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1089, 395, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 420, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 420, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 420, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(820, 420, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 445, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 445, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 445, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 445, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 465, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 465, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1084, 465, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    canvas.create_text(820, 465, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(110, 600, 1120, 600)
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  elif advdata[32] == 'Business Classic':
    adv_winstyle8.insert(0, advdata[40])
    frame = Frame(seventhtab, width=1200, height=155)
    frame.pack(expand=True, fill=BOTH)
    frame.place(x=2,y=309)
    canvas=Canvas(frame, bg='grey', width=1200, height=155, scrollregion=(0,0,700,700))

    vertibar=Scrollbar(frame, orient=VERTICAL)
    vertibar.pack(side=RIGHT,fill=Y)
    vertibar.config(command=canvas.yview)
    canvas.config(width=1200,height=155)

    canvas.config(yscrollcommand=vertibar.set)
    canvas.pack(expand=True,side=LEFT,fill=BOTH)
    canvas.create_rectangle(10, 10, 1190, 690 , outline='yellow',fill='white')
    canvas.create_text(600, 45, text="Title text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_line(100, 60, 1120, 60, fill="orange")
    #canvas.create_line(1000, 60, 600, 60, fill="grey")

    try:
      adv_image = Image.open("images/"+advdata[13])
      adv_resize_image = adv_image.resize((200,100))
      adv_image = ImageTk.PhotoImage(adv_resize_image)

      adv_btlogo = Label(canvas,width=200,height=100,image = adv_image) 
      adv_window_image = canvas.create_window(140, 100, anchor="nw", window=adv_btlogo)
      adv_btlogo.photo = adv_image
    except:
      pass  


    # canvas.create_text(250, 155, text="Your Company Logo", fill="black", font=('Helvetica 18 bold'))

    canvas.create_text(560, 85, text=" "+comname.get(), fill="black", font=('Helvetica 12 '))
    # canvas.create_text(535, 200, text=""+caddent.get('1.0', 'end-1c'), fill="black", font=('Helvetica 10'))
    T_address = Text(canvas, height=5, width=40, font=('Helvetica 10'),borderwidth=0)
    T_address.tag_configure('tag_name',justify='right')
    T_address.insert('1.0', advdata[2])
    T_address.tag_add('tag_name','1.0', 'end')
    T_address_window = canvas.create_window(350, 100, anchor="nw", window=T_address)
    # adv_btlabel = Label(canvas,width=20,height=10,text=""+caddent.get('1.0', 'end-1c')) 
    # adv_window_label = canvas.create_window(530, 110, anchor="nw", window=adv_btlabel)
    canvas.create_text(530, 190, text=""+comsalestax.get(), fill="black", font=('Helvetica 10'))
    # canvas.create_text(530, 140, text="Address line 3", fill="black", font=('Helvetica 10'))
    # canvas.create_text(530, 155, text="Address line 4", fill="black", font=('Helvetica 10'))
    # canvas.create_text(536, 170, text="Phone: 555-5555", fill="black", font=('Helvetica 10'))
    # canvas.create_text(536, 190, text="Sales tax reg No.", fill="black", font=('Helvetica 10'))
    canvas.create_text(524, 210, text="Invoice", fill="black", font=('Helvetica 14 bold'))

    canvas.create_text(749, 95, text="John Doe", fill="black", font=('Helvetica 10 '))
    canvas.create_text(791, 110, text="381 South Bedford Road", fill="black", font=('Helvetica 10'))
    canvas.create_text(800, 125, text="Bedford Corners, NY 10549", fill="black", font=('Helvetica 10'))
    canvas.create_text(760, 140, text="United States", fill="black", font=('Helvetica 10'))

    canvas.create_text(745, 160, text="Invoice", fill="black", font=('Helvetica 11'))
    canvas.create_text(760, 180, text="Invoice date", fill="black", font=('Helvetica 11'))
    canvas.create_text(750, 200, text="Due date", fill="black", font=('Helvetica 11'))

    canvas.create_text(947, 160, text="INV1/2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(950, 180, text="06-05-2022", fill="black", font=('Helvetica 11'))
    canvas.create_text(950, 200, text="21-05-2022", fill="black", font=('Helvetica 11'))
    s = ttk.Style()
    s.configure('mystyle_2.Treeview.Heading', background='orange',State='DISABLE')

    tree=ttk.Treeview(canvas, column=("c1", "c2","c3", "c4", "c5"), show='headings',height= 0, style='mystyle_2.Treeview')
        
    tree.column("# 1", anchor=E, stretch=NO, width=150)
    tree.heading("# 1", text="Product/Service")
    tree.column("# 2", anchor=E, stretch=NO, width=400)
    tree.heading("# 2", text="Description")
    tree.column("# 3", anchor=E, stretch=NO, width=150)
    tree.heading("# 3", text="Unit Price")
    tree.column("# 4", anchor=E, stretch=NO, width=150)
    tree.heading("# 4", text="Quantity")
    tree.column("# 5", anchor=E, stretch=NO, width=150)
    tree.heading("# 5", text="Price")
        
    window = canvas.create_window(120, 230, anchor="nw", window=tree)

    canvas.create_line(120, 270, 1120, 270 )
    canvas.create_line(120, 230, 120, 270 )
    canvas.create_line(270, 230, 270, 270 )
    canvas.create_line(670, 230, 670, 270 )
    canvas.create_line(820, 230, 820, 270 )
    canvas.create_line(970, 230, 970, 270 )
    canvas.create_line(1120, 230, 1120, 270)
    canvas.create_line(1120, 270, 1120, 420)
    canvas.create_line(670, 295, 1120, 295)
    canvas.create_line(670, 320, 1120, 320)
    canvas.create_line(670, 345, 1120, 345)
    canvas.create_line(670, 370, 1120, 370)
    canvas.create_line(670, 395, 1120, 395)
    canvas.create_line(670, 420, 1120, 420)

    canvas.create_text(165, 260, text="PROD-0001", fill="black", font=('Helvetica 10'))
    canvas.create_text(400, 260, text="Example product - Description text...", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(734, 260, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(734, 260, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(734, 260, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(734, 260, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(734, 260, text="$200.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(890, 260, text="1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 260, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 260, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 260, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 260, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    # canvas.create_text(1080, 260, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(697, 285, text="Subtotal", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 285, text=""+comcursign.get()+"200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 285, text="200"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 285, text=""+comcursign.get()+" 200"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 285, text="200"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 285, text="$200.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(692, 310, text="TAX1", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 310, text=""+comcursign.get()+"18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 310, text="18"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 310, text=""+comcursign.get()+" 18"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 310, text="18"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 310, text="$18.00", fill="black", font=('Helvetica 10'))

    canvas.create_text(737, 335, text="Shipping and handling", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1085, 335, text=""+comcursign.get()+"20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1085, 335, text="20"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1085, 335, text=""+comcursign.get()+" 20"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1085, 335, text="20"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1085, 335, text="$20.00", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 360, text=""+comcursign.get()+"238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 360, text="238"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 360, text=""+comcursign.get()+" 238"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 360, text="238"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 360, text="$238.00", fill="black", font=('Helvetica 10 bold'))
    canvas.create_text(715, 360, text="Invoice total", fill="black", font=('Helvetica 10 bold'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 385, text=""+comcursign.get()+"100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 385, text="100"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 385, text=""+comcursign.get()+" 100"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 385, text="100"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 385, text="100.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(705, 385, text="Total Paid", fill="black", font=('Helvetica 10'))
    if comcursignpla.get() == "before amount":
      canvas.create_text(1080, 410, text=""+comcursign.get()+"138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount":
      canvas.create_text(1080, 410, text="138"+""+comdecsep.get()+"00"+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "before amount with space":
      canvas.create_text(1080, 410, text=""+comcursign.get()+" 138"+""+comdecsep.get()+"00", fill="black", font=('Helvetica 10'))
    elif comcursignpla.get() == "after amount with space":
     canvas.create_text(1080, 410, text="138"+""+comdecsep.get()+"00 "+""+comcursign.get(), fill="black", font=('Helvetica 10'))
    else:
      pass
    #canvas.create_text(1080, 410, text="$138.00", fill="black", font=('Helvetica 10'))
    canvas.create_text(700, 410, text="Balance", fill="black", font=('Helvetica 10'))

    canvas.create_line(100, 480, 1120, 480, fill="orange")
    canvas.create_text(200, 500, text="Multiline comment text goes here..", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 510, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 520, text="...", fill="black", font=('Helvetica 10'))
    canvas.create_text(106, 530, text="...", fill="black", font=('Helvetica 10'))

    canvas.create_text(600, 580, text="Terms and Conditions", fill="black", font=('Helvetica 10'))
    canvas.create_line(100, 600, 1120, 600, fill="orange")
    canvas.create_text(620, 620, text="Invoices are payable on receipt unless other terms, negotiated and noted on the invoice. By accepting delivery of goods, Buyer agrees to pay the invoiced cost for those goods,\nand agrees to be bound to thses contract terms. No acceptance may vary these terms unless specifically agreed in writing by Seller ", fill="black", font=('Helvetica 10'))
    canvas.create_text(196, 650, text="Page footer text goes here...", fill="black", font=('Helvetica 10'))
    canvas.create_text(1090, 650, text="Page 1 of 1", fill="black", font=('Helvetica 10'))
  else:
    pass
  adv_winstyle8.place(x=2 ,y=270, width=220)
  #adv_winstyle8.current(0)


root.mainloop()

